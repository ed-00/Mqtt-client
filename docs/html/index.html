<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="generator" content="Asciidoctor 2.0.23">
<meta name="description" content="Comprehensive documentation for the MQTT Event Listener library">
<meta name="keywords" content="MQTT, event listener, job tracking, asyncio, Python, internal, documentation">
<meta name="author" content="Abed Hameed">
<title>MQTT Event Listener Documentation</title>
<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:300,300italic,400,400italic,600,600italic%7CNoto+Serif:400,400italic,700,700italic%7CDroid+Sans+Mono:400,700">
<style>
/*! Asciidoctor default stylesheet | MIT License | https://asciidoctor.org */
/* Uncomment the following line when using as a custom stylesheet */
/* @import "https://fonts.googleapis.com/css?family=Open+Sans:300,300italic,400,400italic,600,600italic%7CNoto+Serif:400,400italic,700,700italic%7CDroid+Sans+Mono:400,700"; */
html{font-family:sans-serif;-webkit-text-size-adjust:100%}
a{background:none}
a:focus{outline:thin dotted}
a:active,a:hover{outline:0}
h1{font-size:2em;margin:.67em 0}
b,strong{font-weight:bold}
abbr{font-size:.9em}
abbr[title]{cursor:help;border-bottom:1px dotted #dddddf;text-decoration:none}
dfn{font-style:italic}
hr{height:0}
mark{background:#ff0;color:#000}
code,kbd,pre,samp{font-family:monospace;font-size:1em}
pre{white-space:pre-wrap}
q{quotes:"\201C" "\201D" "\2018" "\2019"}
small{font-size:80%}
sub,sup{font-size:75%;line-height:0;position:relative;vertical-align:baseline}
sup{top:-.5em}
sub{bottom:-.25em}
img{border:0}
svg:not(:root){overflow:hidden}
figure{margin:0}
audio,video{display:inline-block}
audio:not([controls]){display:none;height:0}
fieldset{border:1px solid silver;margin:0 2px;padding:.35em .625em .75em}
legend{border:0;padding:0}
button,input,select,textarea{font-family:inherit;font-size:100%;margin:0}
button,input{line-height:normal}
button,select{text-transform:none}
button,html input[type=button],input[type=reset],input[type=submit]{-webkit-appearance:button;cursor:pointer}
button[disabled],html input[disabled]{cursor:default}
input[type=checkbox],input[type=radio]{padding:0}
button::-moz-focus-inner,input::-moz-focus-inner{border:0;padding:0}
textarea{overflow:auto;vertical-align:top}
table{border-collapse:collapse;border-spacing:0}
*,::before,::after{box-sizing:border-box}
html,body{font-size:100%}
body{background:#fff;color:rgba(0,0,0,.8);padding:0;margin:0;font-family:"Noto Serif","DejaVu Serif",serif;line-height:1;position:relative;cursor:auto;-moz-tab-size:4;-o-tab-size:4;tab-size:4;word-wrap:anywhere;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased}
a:hover{cursor:pointer}
img,object,embed{max-width:100%;height:auto}
object,embed{height:100%}
img{-ms-interpolation-mode:bicubic}
.left{float:left!important}
.right{float:right!important}
.text-left{text-align:left!important}
.text-right{text-align:right!important}
.text-center{text-align:center!important}
.text-justify{text-align:justify!important}
.hide{display:none}
img,object,svg{display:inline-block;vertical-align:middle}
textarea{height:auto;min-height:50px}
select{width:100%}
.subheader,.admonitionblock td.content>.title,.audioblock>.title,.exampleblock>.title,.imageblock>.title,.listingblock>.title,.literalblock>.title,.stemblock>.title,.openblock>.title,.paragraph>.title,.quoteblock>.title,table.tableblock>.title,.verseblock>.title,.videoblock>.title,.dlist>.title,.olist>.title,.ulist>.title,.qlist>.title,.hdlist>.title{line-height:1.45;color:#7a2518;font-weight:400;margin-top:0;margin-bottom:.25em}
div,dl,dt,dd,ul,ol,li,h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6,pre,form,p,blockquote,th,td{margin:0;padding:0}
a{color:#2156a5;text-decoration:underline;line-height:inherit}
a:hover,a:focus{color:#1d4b8f}
a img{border:0}
p{line-height:1.6;margin-bottom:1.25em;text-rendering:optimizeLegibility}
p aside{font-size:.875em;line-height:1.35;font-style:italic}
h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{font-family:"Open Sans","DejaVu Sans",sans-serif;font-weight:300;font-style:normal;color:#ba3925;text-rendering:optimizeLegibility;margin-top:1em;margin-bottom:.5em;line-height:1.0125em}
h1 small,h2 small,h3 small,#toctitle small,.sidebarblock>.content>.title small,h4 small,h5 small,h6 small{font-size:60%;color:#e99b8f;line-height:0}
h1{font-size:2.125em}
h2{font-size:1.6875em}
h3,#toctitle,.sidebarblock>.content>.title{font-size:1.375em}
h4,h5{font-size:1.125em}
h6{font-size:1em}
hr{border:solid #dddddf;border-width:1px 0 0;clear:both;margin:1.25em 0 1.1875em}
em,i{font-style:italic;line-height:inherit}
strong,b{font-weight:bold;line-height:inherit}
small{font-size:60%;line-height:inherit}
code{font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;font-weight:400;color:rgba(0,0,0,.9)}
ul,ol,dl{line-height:1.6;margin-bottom:1.25em;list-style-position:outside;font-family:inherit}
ul,ol{margin-left:1.5em}
ul li ul,ul li ol{margin-left:1.25em;margin-bottom:0}
ul.circle{list-style-type:circle}
ul.disc{list-style-type:disc}
ul.square{list-style-type:square}
ul.circle ul:not([class]),ul.disc ul:not([class]),ul.square ul:not([class]){list-style:inherit}
ol li ul,ol li ol{margin-left:1.25em;margin-bottom:0}
dl dt{margin-bottom:.3125em;font-weight:bold}
dl dd{margin-bottom:1.25em}
blockquote{margin:0 0 1.25em;padding:.5625em 1.25em 0 1.1875em;border-left:1px solid #ddd}
blockquote,blockquote p{line-height:1.6;color:rgba(0,0,0,.85)}
@media screen and (min-width:768px){h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{line-height:1.2}
h1{font-size:2.75em}
h2{font-size:2.3125em}
h3,#toctitle,.sidebarblock>.content>.title{font-size:1.6875em}
h4{font-size:1.4375em}}
table{background:#fff;margin-bottom:1.25em;border:1px solid #dedede;word-wrap:normal}
table thead,table tfoot{background:#f7f8f7}
table thead tr th,table thead tr td,table tfoot tr th,table tfoot tr td{padding:.5em .625em .625em;font-size:inherit;color:rgba(0,0,0,.8);text-align:left}
table tr th,table tr td{padding:.5625em .625em;font-size:inherit;color:rgba(0,0,0,.8)}
table tr.even,table tr.alt{background:#f8f8f7}
table thead tr th,table tfoot tr th,table tbody tr td,table tr td,table tfoot tr td{line-height:1.6}
h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{line-height:1.2;word-spacing:-.05em}
h1 strong,h2 strong,h3 strong,#toctitle strong,.sidebarblock>.content>.title strong,h4 strong,h5 strong,h6 strong{font-weight:400}
.center{margin-left:auto;margin-right:auto}
.stretch{width:100%}
.clearfix::before,.clearfix::after,.float-group::before,.float-group::after{content:" ";display:table}
.clearfix::after,.float-group::after{clear:both}
:not(pre).nobreak{word-wrap:normal}
:not(pre).nowrap{white-space:nowrap}
:not(pre).pre-wrap{white-space:pre-wrap}
:not(pre):not([class^=L])>code{font-size:.9375em;font-style:normal!important;letter-spacing:0;padding:.1em .5ex;word-spacing:-.15em;background:#f7f7f8;border-radius:4px;line-height:1.45;text-rendering:optimizeSpeed}
pre{color:rgba(0,0,0,.9);font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;line-height:1.45;text-rendering:optimizeSpeed}
pre code,pre pre{color:inherit;font-size:inherit;line-height:inherit}
pre>code{display:block}
pre.nowrap,pre.nowrap pre{white-space:pre;word-wrap:normal}
em em{font-style:normal}
strong strong{font-weight:400}
.keyseq{color:rgba(51,51,51,.8)}
kbd{font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;display:inline-block;color:rgba(0,0,0,.8);font-size:.65em;line-height:1.45;background:#f7f7f7;border:1px solid #ccc;border-radius:3px;box-shadow:0 1px 0 rgba(0,0,0,.2),inset 0 0 0 .1em #fff;margin:0 .15em;padding:.2em .5em;vertical-align:middle;position:relative;top:-.1em;white-space:nowrap}
.keyseq kbd:first-child{margin-left:0}
.keyseq kbd:last-child{margin-right:0}
.menuseq,.menuref{color:#000}
.menuseq b:not(.caret),.menuref{font-weight:inherit}
.menuseq{word-spacing:-.02em}
.menuseq b.caret{font-size:1.25em;line-height:.8}
.menuseq i.caret{font-weight:bold;text-align:center;width:.45em}
b.button::before,b.button::after{position:relative;top:-1px;font-weight:400}
b.button::before{content:"[";padding:0 3px 0 2px}
b.button::after{content:"]";padding:0 2px 0 3px}
p a>code:hover{color:rgba(0,0,0,.9)}
#header,#content,#footnotes,#footer{width:100%;margin:0 auto;max-width:62.5em;*zoom:1;position:relative;padding-left:.9375em;padding-right:.9375em}
#header::before,#header::after,#content::before,#content::after,#footnotes::before,#footnotes::after,#footer::before,#footer::after{content:" ";display:table}
#header::after,#content::after,#footnotes::after,#footer::after{clear:both}
#content{margin-top:1.25em}
#content::before{content:none}
#header>h1:first-child{color:rgba(0,0,0,.85);margin-top:2.25rem;margin-bottom:0}
#header>h1:first-child+#toc{margin-top:8px;border-top:1px solid #dddddf}
#header>h1:only-child{border-bottom:1px solid #dddddf;padding-bottom:8px}
#header .details{border-bottom:1px solid #dddddf;line-height:1.45;padding-top:.25em;padding-bottom:.25em;padding-left:.25em;color:rgba(0,0,0,.6);display:flex;flex-flow:row wrap}
#header .details span:first-child{margin-left:-.125em}
#header .details span.email a{color:rgba(0,0,0,.85)}
#header .details br{display:none}
#header .details br+span::before{content:"\00a0\2013\00a0"}
#header .details br+span.author::before{content:"\00a0\22c5\00a0";color:rgba(0,0,0,.85)}
#header .details br+span#revremark::before{content:"\00a0|\00a0"}
#header #revnumber{text-transform:capitalize}
#header #revnumber::after{content:"\00a0"}
#content>h1:first-child:not([class]){color:rgba(0,0,0,.85);border-bottom:1px solid #dddddf;padding-bottom:8px;margin-top:0;padding-top:1rem;margin-bottom:1.25rem}
#toc{border-bottom:1px solid #e7e7e9;padding-bottom:.5em}
#toc>ul{margin-left:.125em}
#toc ul.sectlevel0>li>a{font-style:italic}
#toc ul.sectlevel0 ul.sectlevel1{margin:.5em 0}
#toc ul{font-family:"Open Sans","DejaVu Sans",sans-serif;list-style-type:none}
#toc li{line-height:1.3334;margin-top:.3334em}
#toc a{text-decoration:none}
#toc a:active{text-decoration:underline}
#toctitle{color:#7a2518;font-size:1.2em}
@media screen and (min-width:768px){#toctitle{font-size:1.375em}
body.toc2{padding-left:15em;padding-right:0}
body.toc2 #header>h1:nth-last-child(2){border-bottom:1px solid #dddddf;padding-bottom:8px}
#toc.toc2{margin-top:0!important;background:#f8f8f7;position:fixed;width:15em;left:0;top:0;border-right:1px solid #e7e7e9;border-top-width:0!important;border-bottom-width:0!important;z-index:1000;padding:1.25em 1em;height:100%;overflow:auto}
#toc.toc2 #toctitle{margin-top:0;margin-bottom:.8rem;font-size:1.2em}
#toc.toc2>ul{font-size:.9em;margin-bottom:0}
#toc.toc2 ul ul{margin-left:0;padding-left:1em}
#toc.toc2 ul.sectlevel0 ul.sectlevel1{padding-left:0;margin-top:.5em;margin-bottom:.5em}
body.toc2.toc-right{padding-left:0;padding-right:15em}
body.toc2.toc-right #toc.toc2{border-right-width:0;border-left:1px solid #e7e7e9;left:auto;right:0}}
@media screen and (min-width:1280px){body.toc2{padding-left:20em;padding-right:0}
#toc.toc2{width:20em}
#toc.toc2 #toctitle{font-size:1.375em}
#toc.toc2>ul{font-size:.95em}
#toc.toc2 ul ul{padding-left:1.25em}
body.toc2.toc-right{padding-left:0;padding-right:20em}}
#content #toc{border:1px solid #e0e0dc;margin-bottom:1.25em;padding:1.25em;background:#f8f8f7;border-radius:4px}
#content #toc>:first-child{margin-top:0}
#content #toc>:last-child{margin-bottom:0}
#footer{max-width:none;background:rgba(0,0,0,.8);padding:1.25em}
#footer-text{color:hsla(0,0%,100%,.8);line-height:1.44}
#content{margin-bottom:.625em}
.sect1{padding-bottom:.625em}
@media screen and (min-width:768px){#content{margin-bottom:1.25em}
.sect1{padding-bottom:1.25em}}
.sect1:last-child{padding-bottom:0}
.sect1+.sect1{border-top:1px solid #e7e7e9}
#content h1>a.anchor,h2>a.anchor,h3>a.anchor,#toctitle>a.anchor,.sidebarblock>.content>.title>a.anchor,h4>a.anchor,h5>a.anchor,h6>a.anchor{position:absolute;z-index:1001;width:1.5ex;margin-left:-1.5ex;display:block;text-decoration:none!important;visibility:hidden;text-align:center;font-weight:400}
#content h1>a.anchor::before,h2>a.anchor::before,h3>a.anchor::before,#toctitle>a.anchor::before,.sidebarblock>.content>.title>a.anchor::before,h4>a.anchor::before,h5>a.anchor::before,h6>a.anchor::before{content:"\00A7";font-size:.85em;display:block;padding-top:.1em}
#content h1:hover>a.anchor,#content h1>a.anchor:hover,h2:hover>a.anchor,h2>a.anchor:hover,h3:hover>a.anchor,#toctitle:hover>a.anchor,.sidebarblock>.content>.title:hover>a.anchor,h3>a.anchor:hover,#toctitle>a.anchor:hover,.sidebarblock>.content>.title>a.anchor:hover,h4:hover>a.anchor,h4>a.anchor:hover,h5:hover>a.anchor,h5>a.anchor:hover,h6:hover>a.anchor,h6>a.anchor:hover{visibility:visible}
#content h1>a.link,h2>a.link,h3>a.link,#toctitle>a.link,.sidebarblock>.content>.title>a.link,h4>a.link,h5>a.link,h6>a.link{color:#ba3925;text-decoration:none}
#content h1>a.link:hover,h2>a.link:hover,h3>a.link:hover,#toctitle>a.link:hover,.sidebarblock>.content>.title>a.link:hover,h4>a.link:hover,h5>a.link:hover,h6>a.link:hover{color:#a53221}
details,.audioblock,.imageblock,.literalblock,.listingblock,.stemblock,.videoblock{margin-bottom:1.25em}
details{margin-left:1.25rem}
details>summary{cursor:pointer;display:block;position:relative;line-height:1.6;margin-bottom:.625rem;outline:none;-webkit-tap-highlight-color:transparent}
details>summary::-webkit-details-marker{display:none}
details>summary::before{content:"";border:solid transparent;border-left:solid;border-width:.3em 0 .3em .5em;position:absolute;top:.5em;left:-1.25rem;transform:translateX(15%)}
details[open]>summary::before{border:solid transparent;border-top:solid;border-width:.5em .3em 0;transform:translateY(15%)}
details>summary::after{content:"";width:1.25rem;height:1em;position:absolute;top:.3em;left:-1.25rem}
.admonitionblock td.content>.title,.audioblock>.title,.exampleblock>.title,.imageblock>.title,.listingblock>.title,.literalblock>.title,.stemblock>.title,.openblock>.title,.paragraph>.title,.quoteblock>.title,table.tableblock>.title,.verseblock>.title,.videoblock>.title,.dlist>.title,.olist>.title,.ulist>.title,.qlist>.title,.hdlist>.title{text-rendering:optimizeLegibility;text-align:left;font-family:"Noto Serif","DejaVu Serif",serif;font-size:1rem;font-style:italic}
table.tableblock.fit-content>caption.title{white-space:nowrap;width:0}
.paragraph.lead>p,#preamble>.sectionbody>[class=paragraph]:first-of-type p{font-size:1.21875em;line-height:1.6;color:rgba(0,0,0,.85)}
.admonitionblock>table{border-collapse:separate;border:0;background:none;width:100%}
.admonitionblock>table td.icon{text-align:center;width:80px}
.admonitionblock>table td.icon img{max-width:none}
.admonitionblock>table td.icon .title{font-weight:bold;font-family:"Open Sans","DejaVu Sans",sans-serif;text-transform:uppercase}
.admonitionblock>table td.content{padding-left:1.125em;padding-right:1.25em;border-left:1px solid #dddddf;color:rgba(0,0,0,.6);word-wrap:anywhere}
.admonitionblock>table td.content>:last-child>:last-child{margin-bottom:0}
.exampleblock>.content{border:1px solid #e6e6e6;margin-bottom:1.25em;padding:1.25em;background:#fff;border-radius:4px}
.sidebarblock{border:1px solid #dbdbd6;margin-bottom:1.25em;padding:1.25em;background:#f3f3f2;border-radius:4px}
.sidebarblock>.content>.title{color:#7a2518;margin-top:0;text-align:center}
.exampleblock>.content>:first-child,.sidebarblock>.content>:first-child{margin-top:0}
.exampleblock>.content>:last-child,.exampleblock>.content>:last-child>:last-child,.exampleblock>.content .olist>ol>li:last-child>:last-child,.exampleblock>.content .ulist>ul>li:last-child>:last-child,.exampleblock>.content .qlist>ol>li:last-child>:last-child,.sidebarblock>.content>:last-child,.sidebarblock>.content>:last-child>:last-child,.sidebarblock>.content .olist>ol>li:last-child>:last-child,.sidebarblock>.content .ulist>ul>li:last-child>:last-child,.sidebarblock>.content .qlist>ol>li:last-child>:last-child{margin-bottom:0}
.literalblock pre,.listingblock>.content>pre{border-radius:4px;overflow-x:auto;padding:1em;font-size:.8125em}
@media screen and (min-width:768px){.literalblock pre,.listingblock>.content>pre{font-size:.90625em}}
@media screen and (min-width:1280px){.literalblock pre,.listingblock>.content>pre{font-size:1em}}
.literalblock pre,.listingblock>.content>pre:not(.highlight),.listingblock>.content>pre[class=highlight],.listingblock>.content>pre[class^="highlight "]{background:#f7f7f8}
.literalblock.output pre{color:#f7f7f8;background:rgba(0,0,0,.9)}
.listingblock>.content{position:relative}
.listingblock code[data-lang]::before{display:none;content:attr(data-lang);position:absolute;font-size:.75em;top:.425rem;right:.5rem;line-height:1;text-transform:uppercase;color:inherit;opacity:.5}
.listingblock:hover code[data-lang]::before{display:block}
.listingblock.terminal pre .command::before{content:attr(data-prompt);padding-right:.5em;color:inherit;opacity:.5}
.listingblock.terminal pre .command:not([data-prompt])::before{content:"$"}
.listingblock pre.highlightjs{padding:0}
.listingblock pre.highlightjs>code{padding:1em;border-radius:4px}
.listingblock pre.prettyprint{border-width:0}
.prettyprint{background:#f7f7f8}
pre.prettyprint .linenums{line-height:1.45;margin-left:2em}
pre.prettyprint li{background:none;list-style-type:inherit;padding-left:0}
pre.prettyprint li code[data-lang]::before{opacity:1}
pre.prettyprint li:not(:first-child) code[data-lang]::before{display:none}
table.linenotable{border-collapse:separate;border:0;margin-bottom:0;background:none}
table.linenotable td[class]{color:inherit;vertical-align:top;padding:0;line-height:inherit;white-space:normal}
table.linenotable td.code{padding-left:.75em}
table.linenotable td.linenos,pre.pygments .linenos{border-right:1px solid;opacity:.35;padding-right:.5em;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none}
pre.pygments span.linenos{display:inline-block;margin-right:.75em}
.quoteblock{margin:0 1em 1.25em 1.5em;display:table}
.quoteblock:not(.excerpt)>.title{margin-left:-1.5em;margin-bottom:.75em}
.quoteblock blockquote,.quoteblock p{color:rgba(0,0,0,.85);font-size:1.15rem;line-height:1.75;word-spacing:.1em;letter-spacing:0;font-style:italic;text-align:justify}
.quoteblock blockquote{margin:0;padding:0;border:0}
.quoteblock blockquote::before{content:"\201c";float:left;font-size:2.75em;font-weight:bold;line-height:.6em;margin-left:-.6em;color:#7a2518;text-shadow:0 1px 2px rgba(0,0,0,.1)}
.quoteblock blockquote>.paragraph:last-child p{margin-bottom:0}
.quoteblock .attribution{margin-top:.75em;margin-right:.5ex;text-align:right}
.verseblock{margin:0 1em 1.25em}
.verseblock pre{font-family:"Open Sans","DejaVu Sans",sans-serif;font-size:1.15rem;color:rgba(0,0,0,.85);font-weight:300;text-rendering:optimizeLegibility}
.verseblock pre strong{font-weight:400}
.verseblock .attribution{margin-top:1.25rem;margin-left:.5ex}
.quoteblock .attribution,.verseblock .attribution{font-size:.9375em;line-height:1.45;font-style:italic}
.quoteblock .attribution br,.verseblock .attribution br{display:none}
.quoteblock .attribution cite,.verseblock .attribution cite{display:block;letter-spacing:-.025em;color:rgba(0,0,0,.6)}
.quoteblock.abstract blockquote::before,.quoteblock.excerpt blockquote::before,.quoteblock .quoteblock blockquote::before{display:none}
.quoteblock.abstract blockquote,.quoteblock.abstract p,.quoteblock.excerpt blockquote,.quoteblock.excerpt p,.quoteblock .quoteblock blockquote,.quoteblock .quoteblock p{line-height:1.6;word-spacing:0}
.quoteblock.abstract{margin:0 1em 1.25em;display:block}
.quoteblock.abstract>.title{margin:0 0 .375em;font-size:1.15em;text-align:center}
.quoteblock.excerpt>blockquote,.quoteblock .quoteblock{padding:0 0 .25em 1em;border-left:.25em solid #dddddf}
.quoteblock.excerpt,.quoteblock .quoteblock{margin-left:0}
.quoteblock.excerpt blockquote,.quoteblock.excerpt p,.quoteblock .quoteblock blockquote,.quoteblock .quoteblock p{color:inherit;font-size:1.0625rem}
.quoteblock.excerpt .attribution,.quoteblock .quoteblock .attribution{color:inherit;font-size:.85rem;text-align:left;margin-right:0}
p.tableblock:last-child{margin-bottom:0}
td.tableblock>.content{margin-bottom:1.25em;word-wrap:anywhere}
td.tableblock>.content>:last-child{margin-bottom:-1.25em}
table.tableblock,th.tableblock,td.tableblock{border:0 solid #dedede}
table.grid-all>*>tr>*{border-width:1px}
table.grid-cols>*>tr>*{border-width:0 1px}
table.grid-rows>*>tr>*{border-width:1px 0}
table.frame-all{border-width:1px}
table.frame-ends{border-width:1px 0}
table.frame-sides{border-width:0 1px}
table.frame-none>colgroup+*>:first-child>*,table.frame-sides>colgroup+*>:first-child>*{border-top-width:0}
table.frame-none>:last-child>:last-child>*,table.frame-sides>:last-child>:last-child>*{border-bottom-width:0}
table.frame-none>*>tr>:first-child,table.frame-ends>*>tr>:first-child{border-left-width:0}
table.frame-none>*>tr>:last-child,table.frame-ends>*>tr>:last-child{border-right-width:0}
table.stripes-all>*>tr,table.stripes-odd>*>tr:nth-of-type(odd),table.stripes-even>*>tr:nth-of-type(even),table.stripes-hover>*>tr:hover{background:#f8f8f7}
th.halign-left,td.halign-left{text-align:left}
th.halign-right,td.halign-right{text-align:right}
th.halign-center,td.halign-center{text-align:center}
th.valign-top,td.valign-top{vertical-align:top}
th.valign-bottom,td.valign-bottom{vertical-align:bottom}
th.valign-middle,td.valign-middle{vertical-align:middle}
table thead th,table tfoot th{font-weight:bold}
tbody tr th{background:#f7f8f7}
tbody tr th,tbody tr th p,tfoot tr th,tfoot tr th p{color:rgba(0,0,0,.8);font-weight:bold}
p.tableblock>code:only-child{background:none;padding:0}
p.tableblock{font-size:1em}
ol{margin-left:1.75em}
ul li ol{margin-left:1.5em}
dl dd{margin-left:1.125em}
dl dd:last-child,dl dd:last-child>:last-child{margin-bottom:0}
li p,ul dd,ol dd,.olist .olist,.ulist .ulist,.ulist .olist,.olist .ulist{margin-bottom:.625em}
ul.checklist,ul.none,ol.none,ul.no-bullet,ol.no-bullet,ol.unnumbered,ul.unstyled,ol.unstyled{list-style-type:none}
ul.no-bullet,ol.no-bullet,ol.unnumbered{margin-left:.625em}
ul.unstyled,ol.unstyled{margin-left:0}
li>p:empty:only-child::before{content:"";display:inline-block}
ul.checklist>li>p:first-child{margin-left:-1em}
ul.checklist>li>p:first-child>.fa-square-o:first-child,ul.checklist>li>p:first-child>.fa-check-square-o:first-child{width:1.25em;font-size:.8em;position:relative;bottom:.125em}
ul.checklist>li>p:first-child>input[type=checkbox]:first-child{margin-right:.25em}
ul.inline{display:flex;flex-flow:row wrap;list-style:none;margin:0 0 .625em -1.25em}
ul.inline>li{margin-left:1.25em}
.unstyled dl dt{font-weight:400;font-style:normal}
ol.arabic{list-style-type:decimal}
ol.decimal{list-style-type:decimal-leading-zero}
ol.loweralpha{list-style-type:lower-alpha}
ol.upperalpha{list-style-type:upper-alpha}
ol.lowerroman{list-style-type:lower-roman}
ol.upperroman{list-style-type:upper-roman}
ol.lowergreek{list-style-type:lower-greek}
.hdlist>table,.colist>table{border:0;background:none}
.hdlist>table>tbody>tr,.colist>table>tbody>tr{background:none}
td.hdlist1,td.hdlist2{vertical-align:top;padding:0 .625em}
td.hdlist1{font-weight:bold;padding-bottom:1.25em}
td.hdlist2{word-wrap:anywhere}
.literalblock+.colist,.listingblock+.colist{margin-top:-.5em}
.colist td:not([class]):first-child{padding:.4em .75em 0;line-height:1;vertical-align:top}
.colist td:not([class]):first-child img{max-width:none}
.colist td:not([class]):last-child{padding:.25em 0}
.thumb,.th{line-height:0;display:inline-block;border:4px solid #fff;box-shadow:0 0 0 1px #ddd}
.imageblock.left{margin:.25em .625em 1.25em 0}
.imageblock.right{margin:.25em 0 1.25em .625em}
.imageblock>.title{margin-bottom:0}
.imageblock.thumb,.imageblock.th{border-width:6px}
.imageblock.thumb>.title,.imageblock.th>.title{padding:0 .125em}
.image.left,.image.right{margin-top:.25em;margin-bottom:.25em;display:inline-block;line-height:0}
.image.left{margin-right:.625em}
.image.right{margin-left:.625em}
a.image{text-decoration:none;display:inline-block}
a.image object{pointer-events:none}
sup.footnote,sup.footnoteref{font-size:.875em;position:static;vertical-align:super}
sup.footnote a,sup.footnoteref a{text-decoration:none}
sup.footnote a:active,sup.footnoteref a:active,#footnotes .footnote a:first-of-type:active{text-decoration:underline}
#footnotes{padding-top:.75em;padding-bottom:.75em;margin-bottom:.625em}
#footnotes hr{width:20%;min-width:6.25em;margin:-.25em 0 .75em;border-width:1px 0 0}
#footnotes .footnote{padding:0 .375em 0 .225em;line-height:1.3334;font-size:.875em;margin-left:1.2em;margin-bottom:.2em}
#footnotes .footnote a:first-of-type{font-weight:bold;text-decoration:none;margin-left:-1.05em}
#footnotes .footnote:last-of-type{margin-bottom:0}
#content #footnotes{margin-top:-.625em;margin-bottom:0;padding:.75em 0}
div.unbreakable{page-break-inside:avoid}
.big{font-size:larger}
.small{font-size:smaller}
.underline{text-decoration:underline}
.overline{text-decoration:overline}
.line-through{text-decoration:line-through}
.aqua{color:#00bfbf}
.aqua-background{background:#00fafa}
.black{color:#000}
.black-background{background:#000}
.blue{color:#0000bf}
.blue-background{background:#0000fa}
.fuchsia{color:#bf00bf}
.fuchsia-background{background:#fa00fa}
.gray{color:#606060}
.gray-background{background:#7d7d7d}
.green{color:#006000}
.green-background{background:#007d00}
.lime{color:#00bf00}
.lime-background{background:#00fa00}
.maroon{color:#600000}
.maroon-background{background:#7d0000}
.navy{color:#000060}
.navy-background{background:#00007d}
.olive{color:#606000}
.olive-background{background:#7d7d00}
.purple{color:#600060}
.purple-background{background:#7d007d}
.red{color:#bf0000}
.red-background{background:#fa0000}
.silver{color:#909090}
.silver-background{background:#bcbcbc}
.teal{color:#006060}
.teal-background{background:#007d7d}
.white{color:#bfbfbf}
.white-background{background:#fafafa}
.yellow{color:#bfbf00}
.yellow-background{background:#fafa00}
span.icon>.fa{cursor:default}
a span.icon>.fa{cursor:inherit}
.admonitionblock td.icon [class^="fa icon-"]{font-size:2.5em;text-shadow:1px 1px 2px rgba(0,0,0,.5);cursor:default}
.admonitionblock td.icon .icon-note::before{content:"\f05a";color:#19407c}
.admonitionblock td.icon .icon-tip::before{content:"\f0eb";text-shadow:1px 1px 2px rgba(155,155,0,.8);color:#111}
.admonitionblock td.icon .icon-warning::before{content:"\f071";color:#bf6900}
.admonitionblock td.icon .icon-caution::before{content:"\f06d";color:#bf3400}
.admonitionblock td.icon .icon-important::before{content:"\f06a";color:#bf0000}
.conum[data-value]{display:inline-block;color:#fff!important;background:rgba(0,0,0,.8);border-radius:50%;text-align:center;font-size:.75em;width:1.67em;height:1.67em;line-height:1.67em;font-family:"Open Sans","DejaVu Sans",sans-serif;font-style:normal;font-weight:bold}
.conum[data-value] *{color:#fff!important}
.conum[data-value]+b{display:none}
.conum[data-value]::after{content:attr(data-value)}
pre .conum[data-value]{position:relative;top:-.125em}
b.conum *{color:inherit!important}
.conum:not([data-value]):empty{display:none}
dt,th.tableblock,td.content,div.footnote{text-rendering:optimizeLegibility}
h1,h2,p,td.content,span.alt,summary{letter-spacing:-.01em}
p strong,td.content strong,div.footnote strong{letter-spacing:-.005em}
p,blockquote,dt,td.content,td.hdlist1,span.alt,summary{font-size:1.0625rem}
p{margin-bottom:1.25rem}
.sidebarblock p,.sidebarblock dt,.sidebarblock td.content,p.tableblock{font-size:1em}
.exampleblock>.content{background:#fffef7;border-color:#e0e0dc;box-shadow:0 1px 4px #e0e0dc}
.print-only{display:none!important}
@page{margin:1.25cm .75cm}
@media print{*{box-shadow:none!important;text-shadow:none!important}
html{font-size:80%}
a{color:inherit!important;text-decoration:underline!important}
a.bare,a[href^="#"],a[href^="mailto:"]{text-decoration:none!important}
a[href^="http:"]:not(.bare)::after,a[href^="https:"]:not(.bare)::after{content:"(" attr(href) ")";display:inline-block;font-size:.875em;padding-left:.25em}
abbr[title]{border-bottom:1px dotted}
abbr[title]::after{content:" (" attr(title) ")"}
pre,blockquote,tr,img,object,svg{page-break-inside:avoid}
thead{display:table-header-group}
svg{max-width:100%}
p,blockquote,dt,td.content{font-size:1em;orphans:3;widows:3}
h2,h3,#toctitle,.sidebarblock>.content>.title{page-break-after:avoid}
#header,#content,#footnotes,#footer{max-width:none}
#toc,.sidebarblock,.exampleblock>.content{background:none!important}
#toc{border-bottom:1px solid #dddddf!important;padding-bottom:0!important}
body.book #header{text-align:center}
body.book #header>h1:first-child{border:0!important;margin:2.5em 0 1em}
body.book #header .details{border:0!important;display:block;padding:0!important}
body.book #header .details span:first-child{margin-left:0!important}
body.book #header .details br{display:block}
body.book #header .details br+span::before{content:none!important}
body.book #toc{border:0!important;text-align:left!important;padding:0!important;margin:0!important}
body.book #toc,body.book #preamble,body.book h1.sect0,body.book .sect1>h2{page-break-before:always}
.listingblock code[data-lang]::before{display:block}
#footer{padding:0 .9375em}
.hide-on-print{display:none!important}
.print-only{display:block!important}
.hide-for-print{display:none!important}
.show-for-print{display:inherit!important}}
@media amzn-kf8,print{#header>h1:first-child{margin-top:1.25rem}
.sect1{padding:0!important}
.sect1+.sect1{border:0}
#footer{background:none}
#footer-text{color:rgba(0,0,0,.6);font-size:.9em}}
@media amzn-kf8{#header,#content,#footnotes,#footer{padding:0}}
</style>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.18.3/styles/github.min.css">
</head>
<body class="article toc2 toc-left">
<div id="header">
<h1>MQTT Event Listener Documentation</h1>
<div class="details">
<span id="author" class="author">Abed Hameed</span><br>
<span id="email" class="email"><a href="mailto:aahameed@kth.se">aahameed@kth.se</a></span><br>
<span id="revnumber">version 1.0.0,</span>
<span id="revdate">2025-01-09</span>
<br><span id="revremark">Complete documentation for internal distribution</span>
</div>
<div id="toc" class="toc2">
<div id="toctitle">Table of Contents</div>
<ul class="sectlevel1">
<li><a href="#_quick_start">1. Quick Start</a></li>
<li><a href="#_project_information">2. Project Information</a></li>
<li><a href="#_documentation_sections">3. Documentation Sections</a></li>
<li><a href="#installation">4. Installation Guide</a>
<ul class="sectlevel2">
<li><a href="#_prerequisites">4.1. Prerequisites</a></li>
<li><a href="#_installation_methods">4.2. Installation Methods</a>
<ul class="sectlevel3">
<li><a href="#_method_1_direct_from_repository_recommended">4.2.1. Method 1: Direct from Repository (Recommended)</a></li>
<li><a href="#_method_2_local_clone">4.2.2. Method 2: Local Clone</a></li>
<li><a href="#_method_3_wheel_distribution">4.2.3. Method 3: Wheel Distribution</a></li>
</ul>
</li>
<li><a href="#_verification">4.3. Verification</a></li>
<li><a href="#_development_installation">4.4. Development Installation</a></li>
<li><a href="#_requirements_integration">4.5. Requirements Integration</a></li>
<li><a href="#_troubleshooting_installation">4.6. Troubleshooting Installation</a>
<ul class="sectlevel3">
<li><a href="#_common_issues">4.6.1. Common Issues</a></li>
<li><a href="#_getting_help">4.6.2. Getting Help</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#configuration">5. Configuration Guide</a>
<ul class="sectlevel2">
<li><a href="#_basic_configuration">5.1. Basic Configuration</a>
<ul class="sectlevel3">
<li><a href="#_minimal_setup">5.1.1. Minimal Setup</a></li>
<li><a href="#_complete_configuration">5.1.2. Complete Configuration</a></li>
</ul>
</li>
<li><a href="#_configuration_categories">5.2. Configuration Categories</a>
<ul class="sectlevel3">
<li><a href="#_connection_settings">5.2.1. Connection Settings</a></li>
<li><a href="#_ssltls_configuration">5.2.2. SSL/TLS Configuration</a></li>
<li><a href="#_mqtt_client_settings">5.2.3. MQTT Client Settings</a></li>
<li><a href="#_topic_configuration">5.2.4. Topic Configuration</a>
<ul class="sectlevel4">
<li><a href="#_topic_wildcards">Topic Wildcards</a></li>
</ul>
</li>
<li><a href="#_job_tracking_settings">5.2.5. Job Tracking Settings</a>
<ul class="sectlevel4">
<li><a href="#_duplicate_action_options">Duplicate Action Options</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#_advanced_configuration">5.3. Advanced Configuration</a>
<ul class="sectlevel3">
<li><a href="#_will_messages">5.3.1. Will Messages</a></li>
<li><a href="#_custom_topics">5.3.2. Custom Topics</a></li>
<li><a href="#_configuration_from_environment">5.3.3. Configuration from Environment</a></li>
<li><a href="#_configuration_from_files">5.3.4. Configuration from Files</a></li>
</ul>
</li>
<li><a href="#_configuration_validation">5.4. Configuration Validation</a></li>
<li><a href="#_best_practices">5.5. Best Practices</a></li>
</ul>
</li>
<li><a href="#usage">6. Usage Guide</a>
<ul class="sectlevel2">
<li><a href="#_basic_usage_pattern">6.1. Basic Usage Pattern</a>
<ul class="sectlevel3">
<li><a href="#_simple_event_listener">6.1.1. Simple Event Listener</a></li>
</ul>
</li>
<li><a href="#_message_processing">6.2. Message Processing</a>
<ul class="sectlevel3">
<li><a href="#_toml_message_format">6.2.1. TOML Message Format</a></li>
<li><a href="#_processing_function_patterns">6.2.2. Processing Function Patterns</a>
<ul class="sectlevel4">
<li><a href="#_basic_processing">Basic Processing</a></li>
<li><a href="#_error_handling">Error Handling</a></li>
<li><a href="#_async_processing">Async Processing</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#_job_management">6.3. Job Management</a>
<ul class="sectlevel3">
<li><a href="#_monitoring_job_status">6.3.1. Monitoring Job Status</a></li>
<li><a href="#_querying_jobs_by_status">6.3.2. Querying Jobs by Status</a></li>
<li><a href="#_job_cleanup">6.3.3. Job Cleanup</a></li>
</ul>
</li>
<li><a href="#_configuration_patterns">6.4. Configuration Patterns</a>
<ul class="sectlevel3">
<li><a href="#_environment_based_configuration">6.4.1. Environment-Based Configuration</a></li>
<li><a href="#_multi_environment_configuration">6.4.2. Multi-Environment Configuration</a></li>
</ul>
</li>
<li><a href="#_advanced_usage_patterns">6.5. Advanced Usage Patterns</a>
<ul class="sectlevel3">
<li><a href="#_custom_configuration_parser">6.5.1. Custom Configuration Parser</a></li>
<li><a href="#_multiple_topic_handling">6.5.2. Multiple Topic Handling</a></li>
<li><a href="#_graceful_shutdown">6.5.3. Graceful Shutdown</a></li>
</ul>
</li>
<li><a href="#_performance_optimization">6.6. Performance Optimization</a>
<ul class="sectlevel3">
<li><a href="#_batch_processing">6.6.1. Batch Processing</a></li>
<li><a href="#_memory_management">6.6.2. Memory Management</a></li>
</ul>
</li>
<li><a href="#_error_handling_patterns">6.7. Error Handling Patterns</a>
<ul class="sectlevel3">
<li><a href="#_comprehensive_error_handling">6.7.1. Comprehensive Error Handling</a></li>
</ul>
</li>
<li><a href="#_best_practices_2">6.8. Best Practices</a></li>
</ul>
</li>
<li><a href="#api-reference">7. API Reference</a>
<ul class="sectlevel2">
<li><a href="#_core_classes">7.1. Core Classes</a>
<ul class="sectlevel3">
<li><a href="#_eventlistener">7.1.1. EventListener</a>
<ul class="sectlevel4">
<li><a href="#_constructor">Constructor</a></li>
<li><a href="#_methods">Methods</a></li>
</ul>
</li>
<li><a href="#_eventlistenerconfig">7.1.2. EventListenerConfig</a>
<ul class="sectlevel4">
<li><a href="#_configuration_parameters">Configuration Parameters</a></li>
</ul>
</li>
<li><a href="#_jobinfo">7.1.3. JobInfo</a>
<ul class="sectlevel4">
<li><a href="#_attributes">Attributes</a></li>
</ul>
</li>
<li><a href="#_returntype">7.1.4. ReturnType</a>
<ul class="sectlevel4">
<li><a href="#_attributes_2">Attributes</a></li>
</ul>
</li>
<li><a href="#_safeconfigparser">7.1.5. SafeConfigParser</a>
<ul class="sectlevel4">
<li><a href="#_constructor_2">Constructor</a></li>
<li><a href="#_methods_2">Methods</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#_enumerations">7.2. Enumerations</a>
<ul class="sectlevel3">
<li><a href="#_jobstatus">7.2.1. JobStatus</a>
<ul class="sectlevel4">
<li><a href="#_status_values">Status Values</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#_exceptions">7.3. Exceptions</a>
<ul class="sectlevel3">
<li><a href="#_configerror">7.3.1. ConfigError</a></li>
</ul>
</li>
<li><a href="#_utility_functions">7.4. Utility Functions</a>
<ul class="sectlevel3">
<li><a href="#_helper_functions">7.4.1. Helper Functions</a></li>
</ul>
</li>
<li><a href="#_message_processing_function_signature">7.5. Message Processing Function Signature</a></li>
<li><a href="#_type_hints">7.6. Type Hints</a></li>
</ul>
</li>
<li><a href="#development">8. Development Guide</a>
<ul class="sectlevel2">
<li><a href="#_development_environment_setup">8.1. Development Environment Setup</a>
<ul class="sectlevel3">
<li><a href="#_prerequisites_2">8.1.1. Prerequisites</a></li>
<li><a href="#_initial_setup">8.1.2. Initial Setup</a></li>
<li><a href="#_development_dependencies">8.1.3. Development Dependencies</a></li>
</ul>
</li>
<li><a href="#_project_structure">8.2. Project Structure</a>
<ul class="sectlevel3">
<li><a href="#_directory_layout">8.2.1. Directory Layout</a></li>
<li><a href="#_package_architecture">8.2.2. Package Architecture</a></li>
</ul>
</li>
<li><a href="#_development_workflow">8.3. Development Workflow</a>
<ul class="sectlevel3">
<li><a href="#_branch_strategy">8.3.1. Branch Strategy</a></li>
<li><a href="#_feature_development">8.3.2. Feature Development</a></li>
<li><a href="#_code_standards">8.3.3. Code Standards</a>
<ul class="sectlevel4">
<li><a href="#_python_style">Python Style</a></li>
<li><a href="#_code_quality_checks">Code Quality Checks</a></li>
<li><a href="#_testing_requirements">Testing Requirements</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#_adding_new_features">8.4. Adding New Features</a>
<ul class="sectlevel3">
<li><a href="#_example_adding_new_configuration_option">8.4.1. Example: Adding New Configuration Option</a></li>
<li><a href="#_example_adding_new_job_status">8.4.2. Example: Adding New Job Status</a></li>
</ul>
</li>
<li><a href="#_testing_framework">8.5. Testing Framework</a>
<ul class="sectlevel3">
<li><a href="#_test_categories">8.5.1. Test Categories</a></li>
<li><a href="#_writing_tests">8.5.2. Writing Tests</a>
<ul class="sectlevel4">
<li><a href="#_unit_test_example">Unit Test Example</a></li>
<li><a href="#_integration_test_example">Integration Test Example</a></li>
<li><a href="#_async_test_example">Async Test Example</a></li>
</ul>
</li>
<li><a href="#_test_fixtures">8.5.3. Test Fixtures</a></li>
</ul>
</li>
<li><a href="#_build_and_release_process">8.6. Build and Release Process</a>
<ul class="sectlevel3">
<li><a href="#_building_the_package">8.6.1. Building the Package</a></li>
<li><a href="#_release_checklist">8.6.2. Release Checklist</a></li>
</ul>
</li>
<li><a href="#_debugging_and_troubleshooting">8.7. Debugging and Troubleshooting</a>
<ul class="sectlevel3">
<li><a href="#_logging_configuration">8.7.1. Logging Configuration</a></li>
<li><a href="#_common_debug_scenarios">8.7.2. Common Debug Scenarios</a>
<ul class="sectlevel4">
<li><a href="#_mqtt_connection_issues">MQTT Connection Issues</a></li>
<li><a href="#_job_tracking_issues">Job Tracking Issues</a></li>
</ul>
</li>
<li><a href="#_performance_profiling">8.7.3. Performance Profiling</a></li>
</ul>
</li>
<li><a href="#_contributing_guidelines">8.8. Contributing Guidelines</a>
<ul class="sectlevel3">
<li><a href="#_code_review_process">8.8.1. Code Review Process</a></li>
<li><a href="#_getting_help_2">8.8.2. Getting Help</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#testing">9. Testing Framework</a>
<ul class="sectlevel2">
<li><a href="#_test_suite_overview">9.1. Test Suite Overview</a></li>
<li><a href="#_running_tests">9.2. Running Tests</a>
<ul class="sectlevel3">
<li><a href="#_quick_commands">9.2.1. Quick Commands</a></li>
<li><a href="#_detailed_test_commands">9.2.2. Detailed Test Commands</a></li>
</ul>
</li>
<li><a href="#_test_structure">9.3. Test Structure</a>
<ul class="sectlevel3">
<li><a href="#_test_directory_layout">9.3.1. Test Directory Layout</a></li>
<li><a href="#_test_categories_2">9.3.2. Test Categories</a>
<ul class="sectlevel4">
<li><a href="#_unit_tests_pytest_mark_unit">Unit Tests (<code>@pytest.mark.unit</code>)</a></li>
<li><a href="#_integration_tests_pytest_mark_integration">Integration Tests (<code>@pytest.mark.integration</code>)</a></li>
<li><a href="#_slow_tests_pytest_mark_slow">Slow Tests (<code>@pytest.mark.slow</code>)</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#_test_fixtures_2">9.4. Test Fixtures</a>
<ul class="sectlevel3">
<li><a href="#_configuration_fixtures">9.4.1. Configuration Fixtures</a></li>
<li><a href="#_eventlistener_fixtures">9.4.2. EventListener Fixtures</a></li>
<li><a href="#_data_fixtures">9.4.3. Data Fixtures</a></li>
</ul>
</li>
<li><a href="#_testing_patterns">9.5. Testing Patterns</a>
<ul class="sectlevel3">
<li><a href="#_async_testing">9.5.1. Async Testing</a></li>
<li><a href="#_mocking_external_dependencies">9.5.2. Mocking External Dependencies</a></li>
<li><a href="#_parameterized_tests">9.5.3. Parameterized Tests</a></li>
<li><a href="#_error_condition_testing">9.5.4. Error Condition Testing</a></li>
</ul>
</li>
<li><a href="#_coverage_analysis">9.6. Coverage Analysis</a>
<ul class="sectlevel3">
<li><a href="#_coverage_configuration">9.6.1. Coverage Configuration</a></li>
<li><a href="#_coverage_reports">9.6.2. Coverage Reports</a></li>
<li><a href="#_coverage_targets">9.6.3. Coverage Targets</a></li>
</ul>
</li>
<li><a href="#_performance_testing">9.7. Performance Testing</a>
<ul class="sectlevel3">
<li><a href="#_benchmark_tests">9.7.1. Benchmark Tests</a></li>
<li><a href="#_memory_usage_tests">9.7.2. Memory Usage Tests</a></li>
</ul>
</li>
<li><a href="#_continuous_integration">9.8. Continuous Integration</a>
<ul class="sectlevel3">
<li><a href="#_github_actions_workflow">9.8.1. GitHub Actions Workflow</a></li>
</ul>
</li>
<li><a href="#_test_maintenance">9.9. Test Maintenance</a>
<ul class="sectlevel3">
<li><a href="#_adding_new_tests">9.9.1. Adding New Tests</a></li>
<li><a href="#_test_review_checklist">9.9.2. Test Review Checklist</a></li>
<li><a href="#_debugging_tests">9.9.3. Debugging Tests</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#architecture">10. System Architecture</a>
<ul class="sectlevel2">
<li><a href="#_high_level_architecture">10.1. High-Level Architecture</a></li>
<li><a href="#_component_architecture">10.2. Component Architecture</a>
<ul class="sectlevel3">
<li><a href="#_eventlistener_core">10.2.1. EventListener Core</a></li>
<li><a href="#_data_flow">10.2.2. Data Flow</a></li>
</ul>
</li>
<li><a href="#_memory_management_2">10.3. Memory Management</a>
<ul class="sectlevel3">
<li><a href="#_job_storage_strategy">10.3.1. Job Storage Strategy</a></li>
<li><a href="#_memory_optimization">10.3.2. Memory Optimization</a></li>
</ul>
</li>
<li><a href="#_concurrency_model">10.4. Concurrency Model</a>
<ul class="sectlevel3">
<li><a href="#_asyncawait_architecture">10.4.1. Async/Await Architecture</a></li>
<li><a href="#_thread_safety">10.4.2. Thread Safety</a></li>
</ul>
</li>
<li><a href="#_error_handling_strategy">10.5. Error Handling Strategy</a>
<ul class="sectlevel3">
<li><a href="#_error_classification">10.5.1. Error Classification</a></li>
<li><a href="#_error_recovery">10.5.2. Error Recovery</a></li>
</ul>
</li>
<li><a href="#_performance_characteristics">10.6. Performance Characteristics</a>
<ul class="sectlevel3">
<li><a href="#_throughput_metrics">10.6.1. Throughput Metrics</a></li>
<li><a href="#_scalability_factors">10.6.2. Scalability Factors</a></li>
</ul>
</li>
<li><a href="#_security_architecture">10.7. Security Architecture</a>
<ul class="sectlevel3">
<li><a href="#_security_layers">10.7.1. Security Layers</a></li>
<li><a href="#_security_considerations">10.7.2. Security Considerations</a></li>
</ul>
</li>
<li><a href="#_configuration_architecture">10.8. Configuration Architecture</a>
<ul class="sectlevel3">
<li><a href="#_configuration_hierarchy">10.8.1. Configuration Hierarchy</a></li>
<li><a href="#_configuration_flow">10.8.2. Configuration Flow</a></li>
</ul>
</li>
<li><a href="#_extensibility_points">10.9. Extensibility Points</a>
<ul class="sectlevel3">
<li><a href="#_plugin_architecture">10.9.1. Plugin Architecture</a></li>
<li><a href="#_future_extensions">10.9.2. Future Extensions</a></li>
</ul>
</li>
<li><a href="#_testing_architecture">10.10. Testing Architecture</a>
<ul class="sectlevel3">
<li><a href="#_test_strategy">10.10.1. Test Strategy</a></li>
<li><a href="#_mock_architecture">10.10.2. Mock Architecture</a></li>
</ul>
</li>
<li><a href="#_deployment_architecture">10.11. Deployment Architecture</a>
<ul class="sectlevel3">
<li><a href="#_internal_deployment">10.11.1. Internal Deployment</a></li>
<li><a href="#_distribution_model">10.11.2. Distribution Model</a></li>
</ul>
</li>
<li><a href="#_monitoring_and_observability">10.12. Monitoring and Observability</a>
<ul class="sectlevel3">
<li><a href="#_built_in_monitoring">10.12.1. Built-in Monitoring</a></li>
<li><a href="#_external_integration">10.12.2. External Integration</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#examples">11. Examples and Use Cases</a>
<ul class="sectlevel2">
<li><a href="#_basic_examples">11.1. Basic Examples</a>
<ul class="sectlevel3">
<li><a href="#_simple_message_processing">11.1.1. Simple Message Processing</a></li>
<li><a href="#_configuration_from_environment_2">11.1.2. Configuration from Environment</a></li>
</ul>
</li>
<li><a href="#_advanced_examples">11.2. Advanced Examples</a>
<ul class="sectlevel3">
<li><a href="#_multi_topic_processing">11.2.1. Multi-Topic Processing</a></li>
<li><a href="#_error_handling_and_resilience">11.2.2. Error Handling and Resilience</a></li>
</ul>
</li>
<li><a href="#_real_world_use_cases">11.3. Real-World Use Cases</a>
<ul class="sectlevel3">
<li><a href="#_iot_data_processing">11.3.1. IoT Data Processing</a></li>
<li><a href="#_distributed_task_processing">11.3.2. Distributed Task Processing</a></li>
</ul>
</li>
<li><a href="#_testing_examples">11.4. Testing Examples</a>
<ul class="sectlevel3">
<li><a href="#_unit_test_example_2">11.4.1. Unit Test Example</a></li>
</ul>
</li>
<li><a href="#_configuration_examples">11.5. Configuration Examples</a>
<ul class="sectlevel3">
<li><a href="#_production_configuration">11.5.1. Production Configuration</a></li>
<li><a href="#_development_configuration">11.5.2. Development Configuration</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#performance">12. Performance Guide</a>
<ul class="sectlevel2">
<li><a href="#_performance_metrics">12.1. Performance Metrics</a>
<ul class="sectlevel3">
<li><a href="#_baseline_performance">12.1.1. Baseline Performance</a></li>
<li><a href="#_performance_factors">12.1.2. Performance Factors</a>
<ul class="sectlevel4">
<li><a href="#_message_size_impact">Message Size Impact</a></li>
<li><a href="#_processing_complexity">Processing Complexity</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#_optimization_strategies">12.2. Optimization Strategies</a>
<ul class="sectlevel3">
<li><a href="#_configuration_optimization">12.2.1. Configuration Optimization</a>
<ul class="sectlevel4">
<li><a href="#_memory_management_3">Memory Management</a></li>
<li><a href="#_mqtt_settings">MQTT Settings</a></li>
</ul>
</li>
<li><a href="#_processing_optimization">12.2.2. Processing Optimization</a>
<ul class="sectlevel4">
<li><a href="#_async_processing_2">Async Processing</a></li>
<li><a href="#_batch_processing_2">Batch Processing</a></li>
<li><a href="#_caching_strategy">Caching Strategy</a></li>
</ul>
</li>
<li><a href="#_system_level_optimization">12.2.3. System-Level Optimization</a>
<ul class="sectlevel4">
<li><a href="#_memory_profiling">Memory Profiling</a></li>
<li><a href="#_resource_management">Resource Management</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#_performance_monitoring">12.3. Performance Monitoring</a>
<ul class="sectlevel3">
<li><a href="#_built_in_metrics">12.3.1. Built-in Metrics</a></li>
<li><a href="#_benchmarking">12.3.2. Benchmarking</a></li>
</ul>
</li>
<li><a href="#_performance_tuning_guidelines">12.4. Performance Tuning Guidelines</a>
<ul class="sectlevel3">
<li><a href="#_for_high_throughput">12.4.1. For High Throughput</a></li>
<li><a href="#_for_high_reliability">12.4.2. For High Reliability</a></li>
<li><a href="#_for_low_latency">12.4.3. For Low Latency</a></li>
<li><a href="#_for_low_memory_usage">12.4.4. For Low Memory Usage</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#security">13. Security Guide</a>
<ul class="sectlevel2">
<li><a href="#_security_overview">13.1. Security Overview</a>
<ul class="sectlevel3">
<li><a href="#_security_layers_2">13.1.1. Security Layers</a></li>
</ul>
</li>
<li><a href="#_network_security">13.2. Network Security</a>
<ul class="sectlevel3">
<li><a href="#_ssltls_configuration_2">13.2.1. SSL/TLS Configuration</a></li>
<li><a href="#_authentication_best_practices">13.2.2. Authentication Best Practices</a></li>
</ul>
</li>
<li><a href="#_application_security">13.3. Application Security</a>
<ul class="sectlevel3">
<li><a href="#_input_validation">13.3.1. Input Validation</a></li>
<li><a href="#_error_handling_security">13.3.2. Error Handling Security</a></li>
</ul>
</li>
<li><a href="#_configuration_security">13.4. Configuration Security</a>
<ul class="sectlevel3">
<li><a href="#_sensitive_data_protection">13.4.1. Sensitive Data Protection</a></li>
<li><a href="#_environment_security">13.4.2. Environment Security</a></li>
</ul>
</li>
<li><a href="#_process_security">13.5. Process Security</a>
<ul class="sectlevel3">
<li><a href="#_resource_limits">13.5.1. Resource Limits</a></li>
<li><a href="#_secure_logging">13.5.2. Secure Logging</a></li>
</ul>
</li>
<li><a href="#_security_monitoring">13.6. Security Monitoring</a>
<ul class="sectlevel3">
<li><a href="#_threat_detection">13.6.1. Threat Detection</a></li>
</ul>
</li>
<li><a href="#_compliance_and_auditing">13.7. Compliance and Auditing</a>
<ul class="sectlevel3">
<li><a href="#_audit_logging">13.7.1. Audit Logging</a></li>
</ul>
</li>
<li><a href="#_security_best_practices">13.8. Security Best Practices</a>
<ul class="sectlevel3">
<li><a href="#_deployment_security">13.8.1. Deployment Security</a></li>
<li><a href="#_development_security">13.8.2. Development Security</a></li>
<li><a href="#_operational_security">13.8.3. Operational Security</a></li>
</ul>
</li>
<li><a href="#_security_checklist">13.9. Security Checklist</a>
<ul class="sectlevel3">
<li><a href="#_pre_deployment">13.9.1. Pre-Deployment</a></li>
<li><a href="#_regular_maintenance">13.9.2. Regular Maintenance</a></li>
<li><a href="#_incident_response">13.9.3. Incident Response</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#troubleshooting">14. Troubleshooting Guide</a>
<ul class="sectlevel2">
<li><a href="#_installation_issues">14.1. Installation Issues</a>
<ul class="sectlevel3">
<li><a href="#_git_authentication_errors">14.1.1. Git Authentication Errors</a></li>
<li><a href="#_python_version_issues">14.1.2. Python Version Issues</a></li>
<li><a href="#_dependency_conflicts">14.1.3. Dependency Conflicts</a></li>
</ul>
</li>
<li><a href="#_connection_issues">14.2. Connection Issues</a>
<ul class="sectlevel3">
<li><a href="#_mqtt_broker_connection_failures">14.2.1. MQTT Broker Connection Failures</a></li>
<li><a href="#_ssltls_connection_issues">14.2.2. SSL/TLS Connection Issues</a></li>
<li><a href="#_network_timeout_issues">14.2.3. Network Timeout Issues</a></li>
</ul>
</li>
<li><a href="#_runtime_issues">14.3. Runtime Issues</a>
<ul class="sectlevel3">
<li><a href="#_memory_issues">14.3.1. Memory Issues</a></li>
<li><a href="#_performance_issues">14.3.2. Performance Issues</a></li>
<li><a href="#_job_processing_errors">14.3.3. Job Processing Errors</a></li>
</ul>
</li>
<li><a href="#_configuration_issues">14.4. Configuration Issues</a>
<ul class="sectlevel3">
<li><a href="#_invalid_configuration">14.4.1. Invalid Configuration</a></li>
<li><a href="#_toml_parsing_errors">14.4.2. TOML Parsing Errors</a></li>
</ul>
</li>
<li><a href="#_debugging_tools">14.5. Debugging Tools</a>
<ul class="sectlevel3">
<li><a href="#_enable_debug_logging">14.5.1. Enable Debug Logging</a></li>
<li><a href="#_connection_testing">14.5.2. Connection Testing</a></li>
<li><a href="#_message_monitoring">14.5.3. Message Monitoring</a></li>
</ul>
</li>
<li><a href="#_getting_help_3">14.6. Getting Help</a>
<ul class="sectlevel3">
<li><a href="#_before_seeking_help">14.6.1. Before Seeking Help</a></li>
<li><a href="#_support_channels">14.6.2. Support Channels</a></li>
<li><a href="#_information_to_include">14.6.3. Information to Include</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#changelog">15. Changelog</a>
<ul class="sectlevel2">
<li><a href="#_version_1_0_0_2025_01_09">15.1. Version 1.0.0 (2025-01-09)</a>
<ul class="sectlevel3">
<li><a href="#_features">15.1.1. Features</a></li>
<li><a href="#_core_components">15.1.2. Core Components</a></li>
<li><a href="#_job_tracking_features">15.1.3. Job Tracking Features</a></li>
<li><a href="#_mqtt_features">15.1.4. MQTT Features</a></li>
<li><a href="#_configuration_features">15.1.5. Configuration Features</a></li>
<li><a href="#_development_features">15.1.6. Development Features</a></li>
<li><a href="#_distribution_features">15.1.7. Distribution Features</a></li>
<li><a href="#_documentation">15.1.8. Documentation</a></li>
<li><a href="#_technical_details">15.1.9. Technical Details</a></li>
</ul>
</li>
<li><a href="#_upcoming_features">15.2. Upcoming Features</a>
<ul class="sectlevel3">
<li><a href="#_version_1_1_0_planned">15.2.1. Version 1.1.0 (Planned)</a>
<ul class="sectlevel4">
<li><a href="#_enhanced_job_management">Enhanced Job Management</a></li>
<li><a href="#_monitoring_and_observability_2">Monitoring and Observability</a></li>
<li><a href="#_advanced_configuration_2">Advanced Configuration</a></li>
<li><a href="#_scalability_improvements">Scalability Improvements</a></li>
<li><a href="#_developer_experience">Developer Experience</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#_version_history_guidelines">15.3. Version History Guidelines</a>
<ul class="sectlevel3">
<li><a href="#_semantic_versioning">15.3.1. Semantic Versioning</a></li>
<li><a href="#_release_types">15.3.2. Release Types</a>
<ul class="sectlevel4">
<li><a href="#_major_releases_x_0_0">Major Releases (x.0.0)</a></li>
<li><a href="#_minor_releases_x_y_0">Minor Releases (x.y.0)</a></li>
<li><a href="#_patch_releases_x_y_z">Patch Releases (x.y.z)</a></li>
</ul>
</li>
<li><a href="#_change_categories">15.3.3. Change Categories</a></li>
</ul>
</li>
<li><a href="#_migration_guidelines">15.4. Migration Guidelines</a>
<ul class="sectlevel3">
<li><a href="#_future_api_changes">15.4.1. Future API Changes</a>
<ul class="sectlevel4">
<li><a href="#_deprecation_policy">Deprecation Policy</a></li>
<li><a href="#_migration_support">Migration Support</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#_contributing_to_changelog">15.5. Contributing to Changelog</a>
<ul class="sectlevel3">
<li><a href="#_for_maintainers">15.5.1. For Maintainers</a></li>
<li><a href="#_change_documentation_format">15.5.2. Change Documentation Format</a></li>
<li><a href="#_internal_release_notes">15.5.3. Internal Release Notes</a></li>
</ul>
</li>
<li><a href="#_support_information">15.6. Support Information</a>
<ul class="sectlevel3">
<li><a href="#_version_support">15.6.1. Version Support</a></li>
<li><a href="#_end_of_life_policy">15.6.2. End of Life Policy</a></li>
<li><a href="#_upgrade_recommendations">15.6.3. Upgrade Recommendations</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#_additional_resources">16. Additional Resources</a>
<ul class="sectlevel2">
<li><a href="#_internal_resources">16.1. Internal Resources</a></li>
<li><a href="#_external_resources">16.2. External Resources</a></li>
</ul>
</li>
<li><a href="#_support_and_contact">17. Support and Contact</a></li>
<li><a href="#_license">18. License</a></li>
</ul>
</div>
</div>
<div id="content">
<div id="preamble">
<div class="sectionbody">
<div class="paragraph">
<p>MQTT Event Listener is a Python library for MQTT event listening with comprehensive job tracking, configuration parsing, and error handling capabilities.</p>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
<div class="paragraph">
<p>This is internal software for organizational use only. See the <a href="https://github.com/ed-00/Mqtt-client/blob/main/INTERNAL_DISTRIBUTION.md">Internal Distribution Guide</a> for installation and usage within your organization.</p>
</div>
</td>
</tr>
</table>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_quick_start"><a class="anchor" href="#_quick_start"></a><a class="link" href="#_quick_start">1. Quick Start</a></h2>
<div class="sectionbody">
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash"># Install from repository
pip install git+https://github.com/ed-00/Mqtt-client.git

# Import and use
python -c "from Listener import EventListener; print('Installation successful!')"</code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-python hljs" data-lang="python">import asyncio
from Listener import EventListener, EventListenerConfig

async def main():
    config = EventListenerConfig(host="localhost", topic="events")
    listener = EventListener(config)

    def processor(data, job_id):
        print(f"Processing: {data}")
        return None

    await listener.run(processor)

asyncio.run(main())</code></pre>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_project_information"><a class="anchor" href="#_project_information"></a><a class="link" href="#_project_information">2. Project Information</a></h2>
<div class="sectionbody">
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 25%;">
<col style="width: 75%;">
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Version</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1.0.0</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">License</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Apache 2.0</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Python</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">3.8+</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Author</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Abed Hameed</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Organization</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">KTH Royal Institute of Technology</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Repository</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://github.com/ed-00/Mqtt-client" class="bare">https://github.com/ed-00/Mqtt-client</a></p></td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="sect1">
<h2 id="_documentation_sections"><a class="anchor" href="#_documentation_sections"></a><a class="link" href="#_documentation_sections">3. Documentation Sections</a></h2>
<div class="sectionbody">

</div>
</div>
<div class="sect1">
<h2 id="installation"><a class="anchor" href="#installation"></a><a class="link" href="#installation">4. Installation Guide</a></h2>
<div class="sectionbody">
<div class="paragraph">
<p>This section covers all installation methods for the MQTT Event Listener.</p>
</div>
<div class="sect2">
<h3 id="_prerequisites"><a class="anchor" href="#_prerequisites"></a><a class="link" href="#_prerequisites">4.1. Prerequisites</a></h3>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 25%;">
<col style="width: 50%;">
<col style="width: 25%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Requirement</th>
<th class="tableblock halign-left valign-top">Description</th>
<th class="tableblock halign-left valign-top">Version</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Python</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Python programming language</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">3.8+</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Git</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Version control system</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">2.20+</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Network Access</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Access to internal repositories</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Required</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect2">
<h3 id="_installation_methods"><a class="anchor" href="#_installation_methods"></a><a class="link" href="#_installation_methods">4.2. Installation Methods</a></h3>
<div class="sect3">
<h4 id="_method_1_direct_from_repository_recommended"><a class="anchor" href="#_method_1_direct_from_repository_recommended"></a><a class="link" href="#_method_1_direct_from_repository_recommended">4.2.1. Method 1: Direct from Repository (Recommended)</a></h4>
<div class="paragraph">
<p>Install the latest version directly from the git repository:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash"># Latest version from main branch
pip install git+https://github.com/ed-00/Mqtt-client.git

# Specific version tag
pip install git+https://github.com/ed-00/Mqtt-client.git@v1.0.0

# From develop branch
pip install git+https://github.com/ed-00/Mqtt-client.git@develop</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_method_2_local_clone"><a class="anchor" href="#_method_2_local_clone"></a><a class="link" href="#_method_2_local_clone">4.2.2. Method 2: Local Clone</a></h4>
<div class="paragraph">
<p>For development or when you need the full repository:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash"># Clone repository
git clone https://github.com/ed-00/Mqtt-client.git
cd Mqtt-client

# Install package
pip install .

# Install in editable mode for development
pip install -e .[dev]</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_method_3_wheel_distribution"><a class="anchor" href="#_method_3_wheel_distribution"></a><a class="link" href="#_method_3_wheel_distribution">4.2.3. Method 3: Wheel Distribution</a></h4>
<div class="paragraph">
<p>If you have a wheel file distributed internally:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash"># Install from wheel file
pip install mqtt-event-listener-1.0.0-py3-none-any.whl</code></pre>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_verification"><a class="anchor" href="#_verification"></a><a class="link" href="#_verification">4.3. Verification</a></h3>
<div class="paragraph">
<p>Verify the installation was successful:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-python hljs" data-lang="python">from Listener import EventListener, EventListenerConfig

# Check version
print(f"Installed version: {{EventListener.__version__}}")

# Quick functionality test
config = EventListenerConfig()
print("✅ Installation successful!")</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_development_installation"><a class="anchor" href="#_development_installation"></a><a class="link" href="#_development_installation">4.4. Development Installation</a></h3>
<div class="paragraph">
<p>For contributors and developers:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash"># Clone repository
git clone https://github.com/ed-00/Mqtt-client.git
cd Mqtt-client

# Install development dependencies
pip install -e .[dev]

# Verify development setup
make test</code></pre>
</div>
</div>
<div class="paragraph">
<p>Development installation includes:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Testing frameworks (pytest, pytest-asyncio, pytest-cov)</p>
</li>
<li>
<p>Code quality tools (flake8, bandit, safety)</p>
</li>
<li>
<p>Documentation tools (if needed)</p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_requirements_integration"><a class="anchor" href="#_requirements_integration"></a><a class="link" href="#_requirements_integration">4.5. Requirements Integration</a></h3>
<div class="paragraph">
<p>For projects depending on this library, add to your <code>requirements.txt</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-text hljs" data-lang="text"># Latest version
git+https://github.com/ed-00/Mqtt-client.git

# Specific version
git+https://github.com/ed-00/Mqtt-client.git@v1.0.0

# Development branch
git+https://github.com/ed-00/Mqtt-client.git@develop</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_troubleshooting_installation"><a class="anchor" href="#_troubleshooting_installation"></a><a class="link" href="#_troubleshooting_installation">4.6. Troubleshooting Installation</a></h3>
<div class="sect3">
<h4 id="_common_issues"><a class="anchor" href="#_common_issues"></a><a class="link" href="#_common_issues">4.6.1. Common Issues</a></h4>
<div class="dlist">
<dl>
<dt class="hdlist1"><strong>Git Authentication</strong></dt>
<dd>
<p>Ensure you have access to the repository. Contact your administrator if you receive authentication errors.</p>
</dd>
<dt class="hdlist1"><strong>Python Version</strong></dt>
<dd>
<p>Verify you&#8217;re using Python 3.8 or later:</p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">python --version</code></pre>
</div>
</div>
</dd>
<dt class="hdlist1"><strong>Network Access</strong></dt>
<dd>
<p>Ensure you can access the internal git repository. Test with:</p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">git ls-remote https://github.com/ed-00/Mqtt-client.git</code></pre>
</div>
</div>
</dd>
<dt class="hdlist1"><strong>Dependency Conflicts</strong></dt>
<dd>
<p>If you encounter dependency conflicts, consider using a virtual environment:</p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">python -m venv mqtt-env
source mqtt-env/bin/activate  # On Windows: mqtt-env\Scripts\activate
pip install git+{link-repo}.git</code></pre>
</div>
</div>
</dd>
</dl>
</div>
</div>
<div class="sect3">
<h4 id="_getting_help"><a class="anchor" href="#_getting_help"></a><a class="link" href="#_getting_help">4.6.2. Getting Help</a></h4>
<div class="paragraph">
<p>If you encounter installation issues:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Check the <a href="https://github.com/ed-00/Mqtt-client/issues">issue tracker</a> for known problems</p>
</li>
<li>
<p>Contact the maintainer: <a href="mailto:aahameed@kth.se">aahameed@kth.se</a></p>
</li>
<li>
<p>Review the <a href="https://github.com/ed-00/Mqtt-client/blob/main/INTERNAL_DISTRIBUTION.md">Internal Distribution Guide</a></p>
</li>
</ol>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="configuration"><a class="anchor" href="#configuration"></a><a class="link" href="#configuration">5. Configuration Guide</a></h2>
<div class="sectionbody">
<div class="paragraph">
<p>The MQTT Event Listener uses the <code>EventListenerConfig</code> class for comprehensive configuration management.</p>
</div>
<div class="sect2">
<h3 id="_basic_configuration"><a class="anchor" href="#_basic_configuration"></a><a class="link" href="#_basic_configuration">5.1. Basic Configuration</a></h3>
<div class="sect3">
<h4 id="_minimal_setup"><a class="anchor" href="#_minimal_setup"></a><a class="link" href="#_minimal_setup">5.1.1. Minimal Setup</a></h4>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-python hljs" data-lang="python">from Listener import EventListener, EventListenerConfig

# Minimal configuration
config = EventListenerConfig(
    host="localhost",
    port=1883,
    topic="events"
)</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_complete_configuration"><a class="anchor" href="#_complete_configuration"></a><a class="link" href="#_complete_configuration">5.1.2. Complete Configuration</a></h4>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-python hljs" data-lang="python">config = EventListenerConfig(
    # Connection Settings
    host="mqtt.example.com",
    port=8883,
    client_id="my-listener",
    username="mqtt_user",
    password="secure_password",
    uri="mqtts://mqtt.example.com:8883",

    # SSL/TLS Settings
    cafile="/path/to/ca.crt",
    capath="/path/to/ca/",
    cadata="-----BEGIN CERTIFICATE-----...",

    # MQTT Client Settings
    keep_alive=60,
    ping_delay=1,
    auto_reconnect=True,
    reconnect_retries=5,
    cleansession=False,

    # Topic Settings
    topic="events/+",
    qos=1,
    retain=False,
    error_topic="events/errors",
    log_topic="events/logs",
    results_topic="events/results",

    # Job Tracking Settings
    max_jobs_in_memory=10000,
    job_cleanup_interval=3600,
    allow_job_id_generation=True,
    duplicate_action="reprocess"
)</code></pre>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_configuration_categories"><a class="anchor" href="#_configuration_categories"></a><a class="link" href="#_configuration_categories">5.2. Configuration Categories</a></h3>
<div class="sect3">
<h4 id="_connection_settings"><a class="anchor" href="#_connection_settings"></a><a class="link" href="#_connection_settings">5.2.1. Connection Settings</a></h4>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 16.6666%;">
<col style="width: 33.3333%;">
<col style="width: 16.6666%;">
<col style="width: 33.3335%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Parameter</th>
<th class="tableblock halign-left valign-top">Description</th>
<th class="tableblock halign-left valign-top">Default</th>
<th class="tableblock halign-left valign-top">Example</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>host</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">MQTT broker hostname</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>localhost</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>mqtt.example.com</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>port</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">MQTT broker port</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>1883</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>8883</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>client_id</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Unique client identifier</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>event-listener</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>my-app-v1</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>username</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Authentication username</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>test</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>mqtt_user</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>password</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Authentication password</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>test</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>secure_pass</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>uri</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Complete MQTT URI</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Generated</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>mqtts://host:8883</code></p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect3">
<h4 id="_ssltls_configuration"><a class="anchor" href="#_ssltls_configuration"></a><a class="link" href="#_ssltls_configuration">5.2.2. SSL/TLS Configuration</a></h4>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 16.6666%;">
<col style="width: 33.3333%;">
<col style="width: 16.6666%;">
<col style="width: 33.3335%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Parameter</th>
<th class="tableblock halign-left valign-top">Description</th>
<th class="tableblock halign-left valign-top">Default</th>
<th class="tableblock halign-left valign-top">Example</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>cafile</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">CA certificate file path</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>None</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>/etc/ssl/ca.crt</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>capath</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">CA certificate directory</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>None</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>/etc/ssl/certs/</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>cadata</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">CA certificate data</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>None</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Certificate string</p></td>
</tr>
</tbody>
</table>
<div class="admonitionblock warning">
<table>
<tr>
<td class="icon">
<i class="fa icon-warning" title="Warning"></i>
</td>
<td class="content">
<div class="paragraph">
<p>When using SSL/TLS, ensure:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Certificate files are accessible</p>
</li>
<li>
<p>Certificates are valid and not expired</p>
</li>
<li>
<p>Hostname matches certificate CN/SAN</p>
</li>
</ul>
</div>
</td>
</tr>
</table>
</div>
</div>
<div class="sect3">
<h4 id="_mqtt_client_settings"><a class="anchor" href="#_mqtt_client_settings"></a><a class="link" href="#_mqtt_client_settings">5.2.3. MQTT Client Settings</a></h4>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 16.6666%;">
<col style="width: 33.3333%;">
<col style="width: 16.6666%;">
<col style="width: 33.3335%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Parameter</th>
<th class="tableblock halign-left valign-top">Description</th>
<th class="tableblock halign-left valign-top">Default</th>
<th class="tableblock halign-left valign-top">Recommended</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>keep_alive</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Keep-alive interval (seconds)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>10</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>60</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>ping_delay</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Ping delay (seconds)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>1</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>1</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>auto_reconnect</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Automatic reconnection</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>True</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>True</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>reconnect_retries</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Reconnection attempts</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>2</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>5</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>reconnect_max_interval</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Max reconnect interval</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>10</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>60</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>cleansession</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Clean session flag</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>True</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>False</code></p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect3">
<h4 id="_topic_configuration"><a class="anchor" href="#_topic_configuration"></a><a class="link" href="#_topic_configuration">5.2.4. Topic Configuration</a></h4>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 16.6666%;">
<col style="width: 33.3333%;">
<col style="width: 16.6666%;">
<col style="width: 33.3335%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Parameter</th>
<th class="tableblock halign-left valign-top">Description</th>
<th class="tableblock halign-left valign-top">Default</th>
<th class="tableblock halign-left valign-top">Example</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>topic</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Primary subscription topic</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>test</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>events/+</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>qos</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Quality of Service level</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>0</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>1</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>retain</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Retain message flag</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>False</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>True</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>error_topic</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Error message topic</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>test/error</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>events/errors</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>log_topic</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Log message topic</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>test/log</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>events/logs</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>results_topic</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Result message topic</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>test/results</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>events/results</code></p></td>
</tr>
</tbody>
</table>
<div class="sect4">
<h5 id="_topic_wildcards"><a class="anchor" href="#_topic_wildcards"></a><a class="link" href="#_topic_wildcards">Topic Wildcards</a></h5>
<div class="paragraph">
<p>The library supports MQTT topic wildcards:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>` - Single level wildcard: `events//status</code></p>
</li>
<li>
<p><code><mark></code> - Multi level wildcard: <code>events/</mark></code></p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-python hljs" data-lang="python"># Subscribe to all events from any device
config = EventListenerConfig(topic="devices/+/events")

# Subscribe to all messages under events hierarchy
config = EventListenerConfig(topic="events/#")</code></pre>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_job_tracking_settings"><a class="anchor" href="#_job_tracking_settings"></a><a class="link" href="#_job_tracking_settings">5.2.5. Job Tracking Settings</a></h4>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 16.6666%;">
<col style="width: 33.3333%;">
<col style="width: 16.6666%;">
<col style="width: 33.3335%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Parameter</th>
<th class="tableblock halign-left valign-top">Description</th>
<th class="tableblock halign-left valign-top">Default</th>
<th class="tableblock halign-left valign-top">Recommendation</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>max_jobs_in_memory</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Maximum jobs in memory</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>5000</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>10000</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>job_cleanup_interval</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Cleanup interval (seconds)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>259200</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>3600</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>job_id_field</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">TOML field for job ID</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>job_id</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>job_id</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>allow_job_id_generation</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Auto-generate job IDs</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>False</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>True</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>duplicate_action</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Duplicate job handling</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>skip</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>reprocess</code></p></td>
</tr>
</tbody>
</table>
<div class="sect4">
<h5 id="_duplicate_action_options"><a class="anchor" href="#_duplicate_action_options"></a><a class="link" href="#_duplicate_action_options">Duplicate Action Options</a></h5>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 25%;">
<col style="width: 75%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Option</th>
<th class="tableblock halign-left valign-top">Behavior</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>skip</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Ignore duplicate jobs silently</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>reprocess</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Process duplicate jobs again</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>error</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Raise error for duplicate jobs</p></td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_advanced_configuration"><a class="anchor" href="#_advanced_configuration"></a><a class="link" href="#_advanced_configuration">5.3. Advanced Configuration</a></h3>
<div class="sect3">
<h4 id="_will_messages"><a class="anchor" href="#_will_messages"></a><a class="link" href="#_will_messages">5.3.1. Will Messages</a></h4>
<div class="paragraph">
<p>Configure last will and testament messages:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-python hljs" data-lang="python">config = EventListenerConfig(
    will={
        "topic": "status/offline",
        "message": "Client disconnected",
        "qos": 1,
        "retain": True
    }
)</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_custom_topics"><a class="anchor" href="#_custom_topics"></a><a class="link" href="#_custom_topics">5.3.2. Custom Topics</a></h4>
<div class="paragraph">
<p>Define multiple custom topics with individual settings:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-python hljs" data-lang="python">config = EventListenerConfig(
    custom_topics={
        "alerts": {"qos": 2, "retain": True},
        "metrics": {"qos": 0, "retain": False},
        "commands": {"qos": 1, "retain": False}
    }
)</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_configuration_from_environment"><a class="anchor" href="#_configuration_from_environment"></a><a class="link" href="#_configuration_from_environment">5.3.3. Configuration from Environment</a></h4>
<div class="paragraph">
<p>Load configuration from environment variables:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-python hljs" data-lang="python">import os

config = EventListenerConfig(
    host=os.getenv("MQTT_HOST", "localhost"),
    port=int(os.getenv("MQTT_PORT", 1883)),
    username=os.getenv("MQTT_USERNAME"),
    password=os.getenv("MQTT_PASSWORD"),
    topic=os.getenv("MQTT_TOPIC", "events")
)</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_configuration_from_files"><a class="anchor" href="#_configuration_from_files"></a><a class="link" href="#_configuration_from_files">5.3.4. Configuration from Files</a></h4>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-python hljs" data-lang="python">import json

# Load from JSON
with open("config.json") as f:
    config_data = json.load(f)

config = EventListenerConfig(**config_data)</code></pre>
</div>
</div>
<div class="paragraph">
<p>Example <code>config.json</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-json hljs" data-lang="json">{
    "host": "mqtt.example.com",
    "port": 8883,
    "username": "client",
    "password": "secret",
    "topic": "events/+",
    "auto_reconnect": true,
    "max_jobs_in_memory": 10000
}</code></pre>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_configuration_validation"><a class="anchor" href="#_configuration_validation"></a><a class="link" href="#_configuration_validation">5.4. Configuration Validation</a></h3>
<div class="paragraph">
<p>The configuration class includes built-in validation:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-python hljs" data-lang="python">try:
    config = EventListenerConfig(
        host="invalid-host",
        port=99999,  # Invalid port
        qos=5        # Invalid QoS
    )
except ValueError as e:
    print(f"Configuration error: {e}")</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_best_practices"><a class="anchor" href="#_best_practices"></a><a class="link" href="#_best_practices">5.5. Best Practices</a></h3>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
<div class="paragraph">
<p>Configuration Best Practices:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p><strong>Use environment variables</strong> for sensitive data (passwords, certificates)</p>
</li>
<li>
<p><strong>Set appropriate timeouts</strong> for your network conditions</p>
</li>
<li>
<p><strong>Enable auto-reconnect</strong> for production systems</p>
</li>
<li>
<p><strong>Use QoS 1 or 2</strong> for critical messages</p>
</li>
<li>
<p><strong>Set meaningful client IDs</strong> for debugging</p>
</li>
<li>
<p><strong>Configure will messages</strong> for status monitoring</p>
</li>
<li>
<p><strong>Set appropriate job limits</strong> based on memory constraints</p>
</li>
</ol>
</div>
</td>
</tr>
</table>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="usage"><a class="anchor" href="#usage"></a><a class="link" href="#usage">6. Usage Guide</a></h2>
<div class="sectionbody">
<div class="paragraph">
<p>This section provides comprehensive usage examples for the MQTT Event Listener.</p>
</div>
<div class="sect2">
<h3 id="_basic_usage_pattern"><a class="anchor" href="#_basic_usage_pattern"></a><a class="link" href="#_basic_usage_pattern">6.1. Basic Usage Pattern</a></h3>
<div class="sect3">
<h4 id="_simple_event_listener"><a class="anchor" href="#_simple_event_listener"></a><a class="link" href="#_simple_event_listener">6.1.1. Simple Event Listener</a></h4>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-python hljs" data-lang="python">import asyncio
from Listener import EventListener, EventListenerConfig

async def main():
    # Configure the listener
    config = EventListenerConfig(
        host="localhost",
        port=1883,
        topic="events",
        client_id="my-listener"
    )

    # Create listener instance
    listener = EventListener(config)

    # Define message processing function
    def process_message(data, job_id):
        print(f"Processing job {job_id}: {data}")

        # Your processing logic here
        result = {"status": "processed", "job_id": job_id}

        # Return results to be published
        return ReturnType(
            data=result,
            topic="results",
            qos=0,
            retain=False,
            message_id=1,
            timestamp=datetime.now(),
            job_id=job_id
        )

    # Start listening
    await listener.run(process_message)

if __name__ == "__main__":
    asyncio.run(main())</code></pre>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_message_processing"><a class="anchor" href="#_message_processing"></a><a class="link" href="#_message_processing">6.2. Message Processing</a></h3>
<div class="sect3">
<h4 id="_toml_message_format"><a class="anchor" href="#_toml_message_format"></a><a class="link" href="#_toml_message_format">6.2.1. TOML Message Format</a></h4>
<div class="paragraph">
<p>The library expects messages in TOML format:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-toml hljs" data-lang="toml">job_id = "task-001"
task_type = "data_processing"
priority = "high"
timestamp = "2025-01-09T10:30:00Z"

[data]
input_file = "/path/to/input.csv"
output_file = "/path/to/output.json"
parameters = { timeout = 300, retries = 3 }

[metadata]
user = "data_processor"
department = "analytics"</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_processing_function_patterns"><a class="anchor" href="#_processing_function_patterns"></a><a class="link" href="#_processing_function_patterns">6.2.2. Processing Function Patterns</a></h4>
<div class="sect4">
<h5 id="_basic_processing"><a class="anchor" href="#_basic_processing"></a><a class="link" href="#_basic_processing">Basic Processing</a></h5>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-python hljs" data-lang="python">def simple_processor(data, job_id):
    """Simple message processor."""
    print(f"Processing: {data.get('task_type')}")

    # Process the data
    result = {"job_id": job_id, "status": "completed"}

    return create_return_type(result, "results/simple")</code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="_error_handling"><a class="anchor" href="#_error_handling"></a><a class="link" href="#_error_handling">Error Handling</a></h5>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-python hljs" data-lang="python">def robust_processor(data, job_id):
    """Processor with error handling."""
    try:
        # Validate input
        if not data.get('task_type'):
            raise ValueError("Missing task_type")

        # Process data
        result = process_business_logic(data)

        return create_return_type(result, "results/success")

    except Exception as e:
        error_result = {
            "job_id": job_id,
            "error": str(e),
            "status": "failed"
        }
        return create_return_type(error_result, "results/errors")</code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="_async_processing"><a class="anchor" href="#_async_processing"></a><a class="link" href="#_async_processing">Async Processing</a></h5>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-python hljs" data-lang="python">async def async_processor(data, job_id):
    """Asynchronous message processor."""
    # Async operations
    async with aiohttp.ClientSession() as session:
        result = await external_api_call(session, data)

    # Database operations
    await save_to_database(result)

    return create_return_type(result, "results/async")

# Register async processor
await listener.run(async_processor)</code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_job_management"><a class="anchor" href="#_job_management"></a><a class="link" href="#_job_management">6.3. Job Management</a></h3>
<div class="sect3">
<h4 id="_monitoring_job_status"><a class="anchor" href="#_monitoring_job_status"></a><a class="link" href="#_monitoring_job_status">6.3.1. Monitoring Job Status</a></h4>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-python hljs" data-lang="python"># Get specific job status
job_info = await listener.get_job_status("job-123")
if job_info:
    print(f"Job {job_info.job_id} status: {job_info.status}")
    print(f"Started: {job_info.started_at}")
    if job_info.completed_at:
        print(f"Completed: {job_info.completed_at}")

# Check if job is running
is_running = await listener.is_job_running("job-123")
print(f"Job running: {is_running}")

# Check if job exists
exists = await listener.job_exists("job-123")
print(f"Job exists: {exists}")</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_querying_jobs_by_status"><a class="anchor" href="#_querying_jobs_by_status"></a><a class="link" href="#_querying_jobs_by_status">6.3.2. Querying Jobs by Status</a></h4>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-python hljs" data-lang="python"># Get all running jobs
running_jobs = await listener.get_running_jobs()
print(f"Running jobs: {len(running_jobs)}")

# Get completed jobs
completed_jobs = await listener.get_completed_jobs()
for job_id, job_info in completed_jobs.items():
    print(f"Job {job_id}: {job_info.result}")

# Get duplicate jobs
duplicates = await listener.get_duplicate_jobs()
print(f"Duplicate jobs detected: {len(duplicates)}")

# Get all jobs
all_jobs = await listener.get_all_jobs()
print(f"Total jobs in memory: {len(all_jobs)}")</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_job_cleanup"><a class="anchor" href="#_job_cleanup"></a><a class="link" href="#_job_cleanup">6.3.3. Job Cleanup</a></h4>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-python hljs" data-lang="python"># Manual cleanup of old jobs
await listener.cleanup_old_jobs()

# Automatic cleanup is handled by the cleanup_interval setting
config = EventListenerConfig(
    job_cleanup_interval=3600  # Cleanup every hour
)</code></pre>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_configuration_patterns"><a class="anchor" href="#_configuration_patterns"></a><a class="link" href="#_configuration_patterns">6.4. Configuration Patterns</a></h3>
<div class="sect3">
<h4 id="_environment_based_configuration"><a class="anchor" href="#_environment_based_configuration"></a><a class="link" href="#_environment_based_configuration">6.4.1. Environment-Based Configuration</a></h4>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-python hljs" data-lang="python">import os

def create_config_from_env():
    """Create configuration from environment variables."""
    return EventListenerConfig(
        host=os.getenv("MQTT_HOST", "localhost"),
        port=int(os.getenv("MQTT_PORT", 1883)),
        username=os.getenv("MQTT_USERNAME"),
        password=os.getenv("MQTT_PASSWORD"),
        topic=os.getenv("MQTT_TOPIC", "events"),
        client_id=os.getenv("MQTT_CLIENT_ID", "event-listener"),

        # SSL settings
        cafile=os.getenv("MQTT_CA_FILE"),

        # Job settings
        max_jobs_in_memory=int(os.getenv("MAX_JOBS", 5000)),
        job_cleanup_interval=int(os.getenv("CLEANUP_INTERVAL", 3600))
    )

config = create_config_from_env()</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_multi_environment_configuration"><a class="anchor" href="#_multi_environment_configuration"></a><a class="link" href="#_multi_environment_configuration">6.4.2. Multi-Environment Configuration</a></h4>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-python hljs" data-lang="python">def get_config(environment="development"):
    """Get configuration for different environments."""
    configs = {
        "development": EventListenerConfig(
            host="localhost",
            port=1883,
            topic="dev/events",
            auto_reconnect=True,
            max_jobs_in_memory=1000
        ),

        "staging": EventListenerConfig(
            host="staging-mqtt.example.com",
            port=8883,
            topic="staging/events",
            auto_reconnect=True,
            reconnect_retries=5,
            max_jobs_in_memory=5000,
            cafile="/etc/ssl/staging-ca.crt"
        ),

        "production": EventListenerConfig(
            host="mqtt.example.com",
            port=8883,
            topic="events",
            auto_reconnect=True,
            reconnect_retries=10,
            max_jobs_in_memory=10000,
            cafile="/etc/ssl/production-ca.crt",
            job_cleanup_interval=1800
        )
    }

    return configs.get(environment, configs["development"])</code></pre>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_advanced_usage_patterns"><a class="anchor" href="#_advanced_usage_patterns"></a><a class="link" href="#_advanced_usage_patterns">6.5. Advanced Usage Patterns</a></h3>
<div class="sect3">
<h4 id="_custom_configuration_parser"><a class="anchor" href="#_custom_configuration_parser"></a><a class="link" href="#_custom_configuration_parser">6.5.1. Custom Configuration Parser</a></h4>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-python hljs" data-lang="python">import logging
from Listener import SafeConfigParser

# Create custom parser
logger = logging.getLogger(__name__)
parser = SafeConfigParser(logger)

# Use with EventListener
listener = EventListener(config, config_parser=parser)</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_multiple_topic_handling"><a class="anchor" href="#_multiple_topic_handling"></a><a class="link" href="#_multiple_topic_handling">6.5.2. Multiple Topic Handling</a></h4>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-python hljs" data-lang="python">def multi_topic_processor(data, job_id):
    """Process messages from different topics."""
    topic = data.get('_topic')  # Topic info from context

    if topic.startswith('alerts/'):
        return process_alert(data, job_id)
    elif topic.startswith('metrics/'):
        return process_metric(data, job_id)
    elif topic.startswith('commands/'):
        return process_command(data, job_id)
    else:
        return process_default(data, job_id)

# Configure for multiple topics
config = EventListenerConfig(
    topic="events/#",  # Subscribe to all under events
    custom_topics={
        "alerts/+": {"qos": 2, "retain": True},
        "metrics/+": {"qos": 0, "retain": False},
        "commands/+": {"qos": 1, "retain": False}
    }
)</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_graceful_shutdown"><a class="anchor" href="#_graceful_shutdown"></a><a class="link" href="#_graceful_shutdown">6.5.3. Graceful Shutdown</a></h4>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-python hljs" data-lang="python">import signal
import asyncio

class GracefulEventListener:
    def __init__(self, config):
        self.listener = EventListener(config)
        self.shutdown_event = asyncio.Event()

    def signal_handler(self, signum, frame):
        """Handle shutdown signals."""
        print(f"Received signal {signum}, shutting down...")
        self.listener.stop()
        self.shutdown_event.set()

    async def run(self, processor):
        """Run with graceful shutdown."""
        # Register signal handlers
        signal.signal(signal.SIGINT, self.signal_handler)
        signal.signal(signal.SIGTERM, self.signal_handler)

        try:
            # Start listener
            listener_task = asyncio.create_task(
                self.listener.run(processor)
            )

            # Wait for shutdown
            await self.shutdown_event.wait()

            # Wait for listener to stop
            await listener_task

        except Exception as e:
            print(f"Error during operation: {e}")
        finally:
            print("Shutdown complete")

# Usage
async def main():
    config = EventListenerConfig(host="localhost", topic="events")
    graceful_listener = GracefulEventListener(config)
    await graceful_listener.run(my_processor)</code></pre>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_performance_optimization"><a class="anchor" href="#_performance_optimization"></a><a class="link" href="#_performance_optimization">6.6. Performance Optimization</a></h3>
<div class="sect3">
<h4 id="_batch_processing"><a class="anchor" href="#_batch_processing"></a><a class="link" href="#_batch_processing">6.6.1. Batch Processing</a></h4>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-python hljs" data-lang="python">class BatchProcessor:
    def __init__(self, batch_size=10, timeout=5.0):
        self.batch_size = batch_size
        self.timeout = timeout
        self.batch = []
        self.last_batch_time = time.time()

    async def process_message(self, data, job_id):
        """Add message to batch for processing."""
        self.batch.append((data, job_id))

        # Process batch if full or timeout reached
        if (len(self.batch) &gt;= self.batch_size or
            time.time() - self.last_batch_time &gt; self.timeout):
            await self.process_batch()

    async def process_batch(self):
        """Process accumulated batch."""
        if not self.batch:
            return

        print(f"Processing batch of {len(self.batch)} messages")

        # Process all messages in batch
        results = []
        for data, job_id in self.batch:
            result = await process_single_message(data, job_id)
            results.append(result)

        # Send batch results
        await send_batch_results(results)

        # Reset batch
        self.batch = []
        self.last_batch_time = time.time()

# Usage
batch_processor = BatchProcessor()
await listener.run(batch_processor.process_message)</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_memory_management"><a class="anchor" href="#_memory_management"></a><a class="link" href="#_memory_management">6.6.2. Memory Management</a></h4>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-python hljs" data-lang="python"># Configure for memory efficiency
config = EventListenerConfig(
    max_jobs_in_memory=1000,      # Limit job memory usage
    job_cleanup_interval=300,     # Cleanup every 5 minutes
    duplicate_action="skip"       # Avoid duplicate processing
)

# Monitor memory usage
import psutil

def monitor_memory():
    """Monitor memory usage."""
    process = psutil.Process()
    memory_mb = process.memory_info().rss / 1024 / 1024
    print(f"Memory usage: {memory_mb:.1f} MB")

# Periodic memory monitoring
async def memory_monitor():
    while True:
        monitor_memory()
        await asyncio.sleep(60)  # Check every minute</code></pre>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_error_handling_patterns"><a class="anchor" href="#_error_handling_patterns"></a><a class="link" href="#_error_handling_patterns">6.7. Error Handling Patterns</a></h3>
<div class="sect3">
<h4 id="_comprehensive_error_handling"><a class="anchor" href="#_comprehensive_error_handling"></a><a class="link" href="#_comprehensive_error_handling">6.7.1. Comprehensive Error Handling</a></h4>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-python hljs" data-lang="python">import logging
from Listener import ConfigError

logger = logging.getLogger(__name__)

async def robust_main():
    """Main function with comprehensive error handling."""
    try:
        # Configuration
        config = EventListenerConfig(
            host="mqtt.example.com",
            topic="events"
        )

        # Create listener
        listener = EventListener(config)

        # Define processor with error handling
        def error_tolerant_processor(data, job_id):
            try:
                return process_data_safely(data, job_id)
            except ValueError as e:
                logger.error(f"Data validation error for job {job_id}: {e}")
                return create_error_response(job_id, "validation_error", str(e))
            except Exception as e:
                logger.exception(f"Unexpected error for job {job_id}")
                return create_error_response(job_id, "processing_error", str(e))

        # Run listener
        await listener.run(error_tolerant_processor)

    except ConfigError as e:
        logger.error(f"Configuration error: {e}")
    except ConnectionError as e:
        logger.error(f"Connection error: {e}")
    except Exception as e:
        logger.exception("Unexpected error in main")
    finally:
        logger.info("Application shutdown")

def create_error_response(job_id, error_type, message):
    """Create standardized error response."""
    return ReturnType(
        data={
            "job_id": job_id,
            "status": "error",
            "error_type": error_type,
            "error_message": message,
            "timestamp": datetime.now().isoformat()
        },
        topic="errors",
        qos=1,
        retain=False,
        message_id=int(time.time()),
        timestamp=datetime.now(),
        job_id=job_id
    )</code></pre>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_best_practices_2"><a class="anchor" href="#_best_practices_2"></a><a class="link" href="#_best_practices_2">6.8. Best Practices</a></h3>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
<div class="paragraph">
<p>Usage Best Practices:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p><strong>Always handle exceptions</strong> in your processing functions</p>
</li>
<li>
<p><strong>Use meaningful job IDs</strong> for debugging and tracking</p>
</li>
<li>
<p><strong>Implement proper logging</strong> for troubleshooting</p>
</li>
<li>
<p><strong>Monitor job queues</strong> to prevent memory issues</p>
</li>
<li>
<p><strong>Use QoS appropriately</strong> for message reliability</p>
</li>
<li>
<p><strong>Implement graceful shutdown</strong> for production systems</p>
</li>
<li>
<p><strong>Test with various message formats</strong> and edge cases</p>
</li>
<li>
<p><strong>Monitor performance metrics</strong> regularly</p>
</li>
</ol>
</div>
</td>
</tr>
</table>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="api-reference"><a class="anchor" href="#api-reference"></a><a class="link" href="#api-reference">7. API Reference</a></h2>
<div class="sectionbody">
<div class="paragraph">
<p>Complete API documentation for the MQTT Event Listener.</p>
</div>
<div class="sect2">
<h3 id="_core_classes"><a class="anchor" href="#_core_classes"></a><a class="link" href="#_core_classes">7.1. Core Classes</a></h3>
<div class="sect3">
<h4 id="_eventlistener"><a class="anchor" href="#_eventlistener"></a><a class="link" href="#_eventlistener">7.1.1. EventListener</a></h4>
<div class="paragraph">
<p>The main class for MQTT event listening with job tracking.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-python hljs" data-lang="python">class EventListener:
    """MQTT Event Listener with job tracking capabilities."""</code></pre>
</div>
</div>
<div class="sect4">
<h5 id="_constructor"><a class="anchor" href="#_constructor"></a><a class="link" href="#_constructor">Constructor</a></h5>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-python hljs" data-lang="python">def __init__(self, config: EventListenerConfig,
             config_parser: Optional[SafeConfigParser] = None) -&gt; None</code></pre>
</div>
</div>
<div class="paragraph">
<p><strong>Parameters:</strong></p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>config</code> (EventListenerConfig): Configuration object containing all settings</p>
</li>
<li>
<p><code>config_parser</code> (Optional[SafeConfigParser]): Custom config parser instance</p>
</li>
</ul>
</div>
<div class="paragraph">
<p><strong>Example:</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-python hljs" data-lang="python">config = EventListenerConfig(host="localhost", topic="events")
listener = EventListener(config)</code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="_methods"><a class="anchor" href="#_methods"></a><a class="link" href="#_methods">Methods</a></h5>
<div class="sect5">
<h6 id="_run"><a class="anchor" href="#_run"></a><a class="link" href="#_run">run()</a></h6>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-python hljs" data-lang="python">async def run(self, func: Callable[[Dict[str, Any], str],
              Optional[ReturnType]]) -&gt; None</code></pre>
</div>
</div>
<div class="paragraph">
<p>Start the event listener and process incoming messages.</p>
</div>
<div class="paragraph">
<p><strong>Parameters:</strong></p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>func</code>: Message processing function that takes (data, job_id) and returns Optional[ReturnType]</p>
</li>
</ul>
</div>
<div class="paragraph">
<p><strong>Example:</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-python hljs" data-lang="python">def my_processor(data, job_id):
    return ReturnType(data=result, topic="results", ...)

await listener.run(my_processor)</code></pre>
</div>
</div>
</div>
<div class="sect5">
<h6 id="_stop"><a class="anchor" href="#_stop"></a><a class="link" href="#_stop">stop()</a></h6>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-python hljs" data-lang="python">def stop() -&gt; None</code></pre>
</div>
</div>
<div class="paragraph">
<p>Stop the event listener gracefully.</p>
</div>
<div class="paragraph">
<p><strong>Example:</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-python hljs" data-lang="python">listener.stop()</code></pre>
</div>
</div>
</div>
<div class="sect5">
<h6 id="_job_management_methods"><a class="anchor" href="#_job_management_methods"></a><a class="link" href="#_job_management_methods">Job Management Methods</a></h6>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-python hljs" data-lang="python">async def get_job_status(self, job_id: str) -&gt; Optional[JobInfo]
async def is_job_completed(self, job_id: str) -&gt; bool
async def is_job_running(self, job_id: str) -&gt; bool
async def job_exists(self, job_id: str) -&gt; bool
async def get_all_jobs(self) -&gt; Dict[str, JobInfo]
async def get_running_jobs(self) -&gt; Dict[str, JobInfo]
async def get_completed_jobs(self) -&gt; Dict[str, JobInfo]
async def get_duplicate_jobs(self) -&gt; Dict[str, JobInfo]
async def cleanup_old_jobs(self) -&gt; None</code></pre>
</div>
</div>
<div class="paragraph">
<p><strong>Job Status Methods:</strong></p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 20%;">
<col style="width: 60%;">
<col style="width: 20%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Method</th>
<th class="tableblock halign-left valign-top">Description</th>
<th class="tableblock halign-left valign-top">Return Type</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>get_job_status()</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Get detailed job information</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>Optional[JobInfo]</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>is_job_completed()</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Check if job is completed</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>bool</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>is_job_running()</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Check if job is currently running</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>bool</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>job_exists()</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Check if job exists in memory</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>bool</code></p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p><strong>Job Query Methods:</strong></p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 20%;">
<col style="width: 60%;">
<col style="width: 20%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Method</th>
<th class="tableblock halign-left valign-top">Description</th>
<th class="tableblock halign-left valign-top">Return Type</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>get_all_jobs()</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Get all jobs in memory</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>Dict[str, JobInfo]</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>get_running_jobs()</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Get only running jobs</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>Dict[str, JobInfo]</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>get_completed_jobs()</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Get only completed jobs</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>Dict[str, JobInfo]</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>get_duplicate_jobs()</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Get jobs marked as duplicates</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>Dict[str, JobInfo]</code></p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p><strong>Maintenance Methods:</strong></p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 25%;">
<col style="width: 75%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Method</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>cleanup_old_jobs()</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Remove old completed jobs from memory</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p><strong>Examples:</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-python hljs" data-lang="python"># Check job status
job_info = await listener.get_job_status("job-123")
if job_info and job_info.status == JobStatus.COMPLETED:
    print(f"Job completed with result: {job_info.result}")

# Get running jobs count
running = await listener.get_running_jobs()
print(f"Currently running: {len(running)} jobs")

# Cleanup old jobs
await listener.cleanup_old_jobs()</code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_eventlistenerconfig"><a class="anchor" href="#_eventlistenerconfig"></a><a class="link" href="#_eventlistenerconfig">7.1.2. EventListenerConfig</a></h4>
<div class="paragraph">
<p>Configuration dataclass for the EventListener.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-python hljs" data-lang="python">@dataclass(frozen=True)
class EventListenerConfig:
    """Unified configuration for the MQTT Event Listener."""</code></pre>
</div>
</div>
<div class="sect4">
<h5 id="_configuration_parameters"><a class="anchor" href="#_configuration_parameters"></a><a class="link" href="#_configuration_parameters">Configuration Parameters</a></h5>
<div class="sect5">
<h6 id="_connection_settings_2"><a class="anchor" href="#_connection_settings_2"></a><a class="link" href="#_connection_settings_2">Connection Settings</a></h6>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 16.6666%;">
<col style="width: 33.3333%;">
<col style="width: 16.6666%;">
<col style="width: 33.3335%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Parameter</th>
<th class="tableblock halign-left valign-top">Type</th>
<th class="tableblock halign-left valign-top">Default</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>host</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>str</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>"localhost"</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">MQTT broker hostname</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>port</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>int</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>1883</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">MQTT broker port</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>client_id</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>str</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>"event-listener"</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Unique client identifier</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>username</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>str</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>"test"</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Authentication username</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>password</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>str</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>"test"</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Authentication password</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>uri</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>str</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>"mqtt://localhost:1883"</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Complete MQTT URI</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect5">
<h6 id="_ssltls_settings"><a class="anchor" href="#_ssltls_settings"></a><a class="link" href="#_ssltls_settings">SSL/TLS Settings</a></h6>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 16.6666%;">
<col style="width: 33.3333%;">
<col style="width: 16.6666%;">
<col style="width: 33.3335%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Parameter</th>
<th class="tableblock halign-left valign-top">Type</th>
<th class="tableblock halign-left valign-top">Default</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>cafile</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>Optional[str]</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>None</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">CA certificate file path</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>capath</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>Optional[str]</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>None</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">CA certificate directory</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>cadata</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>Optional[str]</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>None</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">CA certificate data</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>additional_headers</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>Optional[Dict]</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>None</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Additional HTTP headers</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect5">
<h6 id="_mqtt_client_settings_2"><a class="anchor" href="#_mqtt_client_settings_2"></a><a class="link" href="#_mqtt_client_settings_2">MQTT Client Settings</a></h6>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 16.6666%;">
<col style="width: 33.3333%;">
<col style="width: 16.6666%;">
<col style="width: 33.3335%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Parameter</th>
<th class="tableblock halign-left valign-top">Type</th>
<th class="tableblock halign-left valign-top">Default</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>keep_alive</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>int</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>10</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Keep-alive interval (seconds)</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>ping_delay</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>int</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>1</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Ping delay (seconds)</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>default_qos</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>int</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>0</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Default Quality of Service</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>default_retain</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>bool</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>False</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Default retain flag</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>auto_reconnect</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>bool</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>True</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Automatic reconnection</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>connect_timeout</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>Optional[int]</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>None</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Connection timeout</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>reconnect_retries</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>int</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>2</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Reconnection attempts</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>reconnect_max_interval</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>int</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>10</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Max reconnect interval</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>cleansession</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>bool</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>True</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Clean session flag</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect5">
<h6 id="_topic_settings"><a class="anchor" href="#_topic_settings"></a><a class="link" href="#_topic_settings">Topic Settings</a></h6>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 16.6666%;">
<col style="width: 33.3333%;">
<col style="width: 16.6666%;">
<col style="width: 33.3335%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Parameter</th>
<th class="tableblock halign-left valign-top">Type</th>
<th class="tableblock halign-left valign-top">Default</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>topic</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>str</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>"test"</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Primary subscription topic</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>qos</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>int</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>0</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Quality of Service level</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>retain</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>bool</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>False</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Retain message flag</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>error_topic</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>str</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>"test/error"</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Error message topic</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>log_topic</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>str</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>"test/log"</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Log message topic</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>results_topic</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>str</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>"test/results"</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Result message topic</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect5">
<h6 id="_advanced_settings"><a class="anchor" href="#_advanced_settings"></a><a class="link" href="#_advanced_settings">Advanced Settings</a></h6>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 16.6666%;">
<col style="width: 33.3333%;">
<col style="width: 16.6666%;">
<col style="width: 33.3335%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Parameter</th>
<th class="tableblock halign-left valign-top">Type</th>
<th class="tableblock halign-left valign-top">Default</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>will</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>Optional[Dict]</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>None</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Will message configuration</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>custom_topics</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>Dict[str, Dict]</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>{}</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Custom topic configurations</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect5">
<h6 id="_job_tracking_settings_2"><a class="anchor" href="#_job_tracking_settings_2"></a><a class="link" href="#_job_tracking_settings_2">Job Tracking Settings</a></h6>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 16.6666%;">
<col style="width: 33.3333%;">
<col style="width: 16.6666%;">
<col style="width: 33.3335%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Parameter</th>
<th class="tableblock halign-left valign-top">Type</th>
<th class="tableblock halign-left valign-top">Default</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>max_jobs_in_memory</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>int</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>5000</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Maximum jobs in memory</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>job_cleanup_interval</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>int</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>259200</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Cleanup interval (seconds)</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>job_id_field</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>str</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>"job_id"</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">TOML field for job ID</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>allow_job_id_generation</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>bool</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>False</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Auto-generate job IDs</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>duplicate_action</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>str</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>"skip"</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Duplicate job handling</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p><strong>Example:</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-python hljs" data-lang="python">config = EventListenerConfig(
    host="mqtt.example.com",
    port=8883,
    topic="events/+",
    auto_reconnect=True,
    max_jobs_in_memory=10000,
    job_cleanup_interval=3600
)</code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_jobinfo"><a class="anchor" href="#_jobinfo"></a><a class="link" href="#_jobinfo">7.1.3. JobInfo</a></h4>
<div class="paragraph">
<p>Information about a job execution.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-python hljs" data-lang="python">@dataclass
class JobInfo:
    """Information about a job run."""</code></pre>
</div>
</div>
<div class="sect4">
<h5 id="_attributes"><a class="anchor" href="#_attributes"></a><a class="link" href="#_attributes">Attributes</a></h5>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 20%;">
<col style="width: 40%;">
<col style="width: 40%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Attribute</th>
<th class="tableblock halign-left valign-top">Type</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>job_id</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>str</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Unique identifier for the job</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>status</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>JobStatus</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Current status of the job</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>started_at</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>datetime</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">When the job was created</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>completed_at</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>Optional[datetime]</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">When the job completed</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>input_data</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>Optional[Dict[str, Any]]</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Input data for the job</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>result</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>Optional[Any]</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Result returned by job function</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>error</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>Optional[str]</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Error message if job failed</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p><strong>Example:</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-python hljs" data-lang="python">job_info = await listener.get_job_status("job-123")
if job_info:
    print(f"Job ID: {job_info.job_id}")
    print(f"Status: {job_info.status}")
    print(f"Started: {job_info.started_at}")
    if job_info.result:
        print(f"Result: {job_info.result}")</code></pre>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_returntype"><a class="anchor" href="#_returntype"></a><a class="link" href="#_returntype">7.1.4. ReturnType</a></h4>
<div class="paragraph">
<p>Return type for processed messages.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-python hljs" data-lang="python">@dataclass
class ReturnType:
    """Return type for processed messages."""</code></pre>
</div>
</div>
<div class="sect4">
<h5 id="_attributes_2"><a class="anchor" href="#_attributes_2"></a><a class="link" href="#_attributes_2">Attributes</a></h5>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 20%;">
<col style="width: 40%;">
<col style="width: 40%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Attribute</th>
<th class="tableblock halign-left valign-top">Type</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>data</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>Dict[str, Any]</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Processed data to publish</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>topic</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>str</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">MQTT topic for publication</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>qos</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>int</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Quality of Service level</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>retain</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>bool</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Retain message flag</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>message_id</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>int</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Unique message identifier</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>timestamp</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>datetime</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Processing timestamp</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>job_id</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>str</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Associated job ID</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p><strong>Example:</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-python hljs" data-lang="python">def my_processor(data, job_id):
    result = {"status": "processed", "data": data}

    return ReturnType(
        data=result,
        topic="results/processed",
        qos=1,
        retain=False,
        message_id=int(time.time()),
        timestamp=datetime.now(),
        job_id=job_id
    )</code></pre>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_safeconfigparser"><a class="anchor" href="#_safeconfigparser"></a><a class="link" href="#_safeconfigparser">7.1.5. SafeConfigParser</a></h4>
<div class="paragraph">
<p>Safe TOML configuration parser with error handling.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-python hljs" data-lang="python">class SafeConfigParser:
    """Safe TOML configuration parser."""</code></pre>
</div>
</div>
<div class="sect4">
<h5 id="_constructor_2"><a class="anchor" href="#_constructor_2"></a><a class="link" href="#_constructor_2">Constructor</a></h5>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-python hljs" data-lang="python">def __init__(self, logger: Optional[logging.Logger] = None) -&gt; None</code></pre>
</div>
</div>
<div class="paragraph">
<p><strong>Parameters:</strong></p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>logger</code> (Optional[logging.Logger]): Logger instance for error reporting</p>
</li>
</ul>
</div>
</div>
<div class="sect4">
<h5 id="_methods_2"><a class="anchor" href="#_methods_2"></a><a class="link" href="#_methods_2">Methods</a></h5>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-python hljs" data-lang="python">def parse_config_from_dict(self, config_dict: Dict[str, Any]) -&gt; Dict[str, Any]
def parse_config_from_string(self, config_string: str) -&gt; Dict[str, Any]
def parse_config_from_file(self, file_path: str) -&gt; Dict[str, Any]
def validate_config(self, config: Dict[str, Any]) -&gt; bool</code></pre>
</div>
</div>
<div class="paragraph">
<p><strong>Examples:</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-python hljs" data-lang="python">import logging
from Listener import SafeConfigParser

logger = logging.getLogger(__name__)
parser = SafeConfigParser(logger)

# Parse from string
config_data = parser.parse_config_from_string(toml_string)

# Parse from file
config_data = parser.parse_config_from_file("config.toml")

# Validate configuration
is_valid = parser.validate_config(config_data)</code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_enumerations"><a class="anchor" href="#_enumerations"></a><a class="link" href="#_enumerations">7.2. Enumerations</a></h3>
<div class="sect3">
<h4 id="_jobstatus"><a class="anchor" href="#_jobstatus"></a><a class="link" href="#_jobstatus">7.2.1. JobStatus</a></h4>
<div class="paragraph">
<p>Job execution status enumeration.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-python hljs" data-lang="python">class JobStatus(Enum):
    """Job execution status enumeration."""

    PENDING = "pending"
    RUNNING = "running"
    COMPLETED = "completed"
    FAILED = "failed"
    DUPLICATE = "duplicate"</code></pre>
</div>
</div>
<div class="sect4">
<h5 id="_status_values"><a class="anchor" href="#_status_values"></a><a class="link" href="#_status_values">Status Values</a></h5>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 25%;">
<col style="width: 75%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Status</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>PENDING</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Job is queued but not yet started</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>RUNNING</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Job is currently being processed</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>COMPLETED</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Job has completed successfully</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>FAILED</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Job has failed with an error</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>DUPLICATE</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Job was detected as a duplicate</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p><strong>Example:</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-python hljs" data-lang="python">from Listener import JobStatus

# Check job status
job_info = await listener.get_job_status("job-123")
if job_info.status == JobStatus.COMPLETED:
    print("Job completed successfully")
elif job_info.status == JobStatus.FAILED:
    print(f"Job failed: {job_info.error}")</code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_exceptions"><a class="anchor" href="#_exceptions"></a><a class="link" href="#_exceptions">7.3. Exceptions</a></h3>
<div class="sect3">
<h4 id="_configerror"><a class="anchor" href="#_configerror"></a><a class="link" href="#_configerror">7.3.1. ConfigError</a></h4>
<div class="paragraph">
<p>Raised when configuration parsing or validation fails.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-python hljs" data-lang="python">class ConfigError(Exception):
    """Configuration error exception."""</code></pre>
</div>
</div>
<div class="paragraph">
<p><strong>Example:</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-python hljs" data-lang="python">from Listener import ConfigError

try:
    parser = SafeConfigParser()
    config = parser.parse_config_from_file("invalid.toml")
except ConfigError as e:
    print(f"Configuration error: {e}")</code></pre>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_utility_functions"><a class="anchor" href="#_utility_functions"></a><a class="link" href="#_utility_functions">7.4. Utility Functions</a></h3>
<div class="sect3">
<h4 id="_helper_functions"><a class="anchor" href="#_helper_functions"></a><a class="link" href="#_helper_functions">7.4.1. Helper Functions</a></h4>
<div class="paragraph">
<p>These utility functions can help with common tasks:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-python hljs" data-lang="python">def create_return_type(data: Dict[str, Any], topic: str,
                      job_id: str, qos: int = 0,
                      retain: bool = False) -&gt; ReturnType:
    """Helper to create ReturnType instances."""
    return ReturnType(
        data=data,
        topic=topic,
        qos=qos,
        retain=retain,
        message_id=int(time.time()),
        timestamp=datetime.now(),
        job_id=job_id
    )

def create_error_result(job_id: str, error_message: str,
                       error_type: str = "processing_error") -&gt; ReturnType:
    """Helper to create error result."""
    return create_return_type(
        data={
            "job_id": job_id,
            "status": "error",
            "error_type": error_type,
            "error_message": error_message,
            "timestamp": datetime.now().isoformat()
        },
        topic="errors",
        job_id=job_id,
        qos=1
    )</code></pre>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_message_processing_function_signature"><a class="anchor" href="#_message_processing_function_signature"></a><a class="link" href="#_message_processing_function_signature">7.5. Message Processing Function Signature</a></h3>
<div class="paragraph">
<p>Your message processing function must follow this signature:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-python hljs" data-lang="python">def processor(data: Dict[str, Any], job_id: str) -&gt; Optional[ReturnType]:
    """
    Process an incoming MQTT message.

    Args:
        data: Parsed TOML data as dictionary
        job_id: Unique job identifier

    Returns:
        Optional[ReturnType]: Result to publish, or None for no response
    """
    pass</code></pre>
</div>
</div>
<div class="paragraph">
<p>Or for async processing:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-python hljs" data-lang="python">async def async_processor(data: Dict[str, Any],
                         job_id: str) -&gt; Optional[ReturnType]:
    """
    Process an incoming MQTT message asynchronously.

    Args:
        data: Parsed TOML data as dictionary
        job_id: Unique job identifier

    Returns:
        Optional[ReturnType]: Result to publish, or None for no response
    """
    pass</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_type_hints"><a class="anchor" href="#_type_hints"></a><a class="link" href="#_type_hints">7.6. Type Hints</a></h3>
<div class="paragraph">
<p>The library includes comprehensive type hints for better IDE support:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-python hljs" data-lang="python">from typing import Dict, Any, Optional, Callable
from datetime import datetime
from Listener import EventListener, EventListenerConfig, ReturnType

# Function type for message processors
ProcessorFunc = Callable[[Dict[str, Any], str], Optional[ReturnType]]

# Example with proper typing
def typed_processor(data: Dict[str, Any], job_id: str) -&gt; Optional[ReturnType]:
    # Type-safe processing
    task_type: str = data.get("task_type", "unknown")
    priority: int = data.get("priority", 1)

    result: Dict[str, Any] = {
        "job_id": job_id,
        "task_type": task_type,
        "status": "completed"
    }

    return ReturnType(
        data=result,
        topic="results",
        qos=0,
        retain=False,
        message_id=1,
        timestamp=datetime.now(),
        job_id=job_id
    )</code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="development"><a class="anchor" href="#development"></a><a class="link" href="#development">8. Development Guide</a></h2>
<div class="sectionbody">
<div class="paragraph">
<p>Guide for contributors and developers working on the MQTT Event Listener.</p>
</div>
<div class="sect2">
<h3 id="_development_environment_setup"><a class="anchor" href="#_development_environment_setup"></a><a class="link" href="#_development_environment_setup">8.1. Development Environment Setup</a></h3>
<div class="sect3">
<h4 id="_prerequisites_2"><a class="anchor" href="#_prerequisites_2"></a><a class="link" href="#_prerequisites_2">8.1.1. Prerequisites</a></h4>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 25%;">
<col style="width: 50%;">
<col style="width: 25%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Tool</th>
<th class="tableblock halign-left valign-top">Description</th>
<th class="tableblock halign-left valign-top">Version</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Python</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Python programming language</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">3.8+</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Git</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Version control system</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">2.20+</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Make</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Build automation tool</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Any</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Docker</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Containerization (optional)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">20+</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect3">
<h4 id="_initial_setup"><a class="anchor" href="#_initial_setup"></a><a class="link" href="#_initial_setup">8.1.2. Initial Setup</a></h4>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash"># Clone the repository
git clone https://github.com/ed-00/Mqtt-client.git
cd Mqtt-client

# Create virtual environment
python -m venv venv
source venv/bin/activate  # On Windows: venv\Scripts\activate

# Install development dependencies
pip install -e .[dev]

# Verify setup
make test</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_development_dependencies"><a class="anchor" href="#_development_dependencies"></a><a class="link" href="#_development_dependencies">8.1.3. Development Dependencies</a></h4>
<div class="paragraph">
<p>The development installation includes:</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 25%;">
<col style="width: 50%;">
<col style="width: 25%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Package</th>
<th class="tableblock halign-left valign-top">Purpose</th>
<th class="tableblock halign-left valign-top">Version</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">pytest</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Testing framework</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">7.0.0+</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">pytest-asyncio</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Async test support</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0.21.0+</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">pytest-mock</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Mocking utilities</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">3.10.0+</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">pytest-cov</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Coverage reporting</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">4.0.0+</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">flake8</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Code linting</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">6.0.0+</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">bandit</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Security analysis</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1.7.0+</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">safety</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Dependency scanning</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">2.0.0+</p></td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="sect2">
<h3 id="_project_structure"><a class="anchor" href="#_project_structure"></a><a class="link" href="#_project_structure">8.2. Project Structure</a></h3>
<div class="sect3">
<h4 id="_directory_layout"><a class="anchor" href="#_directory_layout"></a><a class="link" href="#_directory_layout">8.2.1. Directory Layout</a></h4>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-text hljs" data-lang="text">Mqtt-client/
├── Listener/                    # Main package
│   ├── __init__.py             # Package initialization
│   ├── event_listener.py       # Core EventListener class
│   ├── safe_config_parser.py   # Configuration parser
│   └── py.typed                # Type hints marker
├── tests/                      # Test suite
│   ├── __init__.py
│   ├── conftest.py             # Test configuration
│   ├── test_event_listener.py  # EventListener tests
│   ├── test_safe_config_parser.py # Parser tests
│   └── test_integration.py     # Integration tests
├── docs/                       # Documentation
│   ├── asciidoc/               # AsciiDoc source
│   ├── html/                   # Generated HTML
│   └── pdf/                    # Generated PDF
├── scripts/                    # Build and utility scripts
│   ├── build_package.sh        # Package build script
│   └── run_tests.py            # Test runner
├── .github/                    # GitHub configuration
│   └── workflows/              # CI/CD workflows
├── pyproject.toml              # Modern Python packaging
├── MANIFEST.in                 # Package manifest
├── README.md                   # Project readme
├── LICENSE                     # License file
├── requirements.txt            # Dependencies
├── pytest.ini                 # Test configuration
├── Makefile                    # Build automation
└── .gitignore                  # Git ignore rules</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_package_architecture"><a class="anchor" href="#_package_architecture"></a><a class="link" href="#_package_architecture">8.2.2. Package Architecture</a></h4>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-text hljs" data-lang="text">Listener Package:
├── EventListener              # Main listener class
│   ├── Job tracking           # In-memory job management
│   ├── MQTT client           # AMQTT client wrapper
│   ├── Message processing    # TOML message handling
│   └── Error handling        # Exception management
├── EventListenerConfig       # Configuration dataclass
│   ├── Connection settings   # MQTT broker config
│   ├── Job tracking config   # Job management settings
│   └── SSL/TLS settings      # Security configuration
├── SafeConfigParser          # TOML parser with validation
│   ├── String parsing        # Parse TOML strings
│   ├── File parsing          # Parse TOML files
│   └── Validation            # Configuration validation
├── Data Classes              # Type definitions
│   ├── JobInfo              # Job information
│   ├── ReturnType           # Message return type
│   └── JobStatus (Enum)     # Job status enumeration
└── Exceptions               # Custom exceptions
    └── ConfigError          # Configuration errors</code></pre>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_development_workflow"><a class="anchor" href="#_development_workflow"></a><a class="link" href="#_development_workflow">8.3. Development Workflow</a></h3>
<div class="sect3">
<h4 id="_branch_strategy"><a class="anchor" href="#_branch_strategy"></a><a class="link" href="#_branch_strategy">8.3.1. Branch Strategy</a></h4>
<div class="ulist">
<ul>
<li>
<p><code>main</code> - Stable production code</p>
</li>
<li>
<p><code>develop</code> - Development integration branch</p>
</li>
<li>
<p><code>feature/*</code> - Feature development branches</p>
</li>
<li>
<p><code>hotfix/*</code> - Critical bug fixes</p>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="_feature_development"><a class="anchor" href="#_feature_development"></a><a class="link" href="#_feature_development">8.3.2. Feature Development</a></h4>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash"># Start new feature
git checkout develop
git pull origin develop
git checkout -b feature/my-new-feature

# Make changes and test
# ... development work ...
make test
make lint

# Commit changes
git add .
git commit -m "feat: add new feature description"

# Push and create PR
git push origin feature/my-new-feature
# Create pull request to develop branch</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_code_standards"><a class="anchor" href="#_code_standards"></a><a class="link" href="#_code_standards">8.3.3. Code Standards</a></h4>
<div class="sect4">
<h5 id="_python_style"><a class="anchor" href="#_python_style"></a><a class="link" href="#_python_style">Python Style</a></h5>
<div class="ulist">
<ul>
<li>
<p>Follow PEP 8 coding standards</p>
</li>
<li>
<p>Use type hints for all functions</p>
</li>
<li>
<p>Maximum line length: 127 characters</p>
</li>
<li>
<p>Use meaningful variable and function names</p>
</li>
<li>
<p>Include docstrings for all public methods</p>
</li>
</ul>
</div>
</div>
<div class="sect4">
<h5 id="_code_quality_checks"><a class="anchor" href="#_code_quality_checks"></a><a class="link" href="#_code_quality_checks">Code Quality Checks</a></h5>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash"># Run linting
make lint

# Check specific files
flake8 Listener/event_listener.py

# Security analysis
make security

# Dependency vulnerability check
safety check</code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="_testing_requirements"><a class="anchor" href="#_testing_requirements"></a><a class="link" href="#_testing_requirements">Testing Requirements</a></h5>
<div class="ulist">
<ul>
<li>
<p>All new code must have tests</p>
</li>
<li>
<p>Maintain 80%+ code coverage</p>
</li>
<li>
<p>Include both unit and integration tests</p>
</li>
<li>
<p>Test error conditions and edge cases</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash"># Run all tests
make test

# Run with coverage
make coverage

# Run specific test file
pytest tests/test_event_listener.py -v

# Run specific test method
pytest tests/test_event_listener.py::TestJobManagement::test_job_creation -v</code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_adding_new_features"><a class="anchor" href="#_adding_new_features"></a><a class="link" href="#_adding_new_features">8.4. Adding New Features</a></h3>
<div class="sect3">
<h4 id="_example_adding_new_configuration_option"><a class="anchor" href="#_example_adding_new_configuration_option"></a><a class="link" href="#_example_adding_new_configuration_option">8.4.1. Example: Adding New Configuration Option</a></h4>
<div class="olist arabic">
<ol class="arabic">
<li>
<p><strong>Add to EventListenerConfig</strong>:</p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-python hljs" data-lang="python">@dataclass(frozen=True)
class EventListenerConfig:
    # ... existing fields ...
    new_option: bool = False  # Add new configuration option</code></pre>
</div>
</div>
</li>
<li>
<p><strong>Update EventListener to use it</strong>:</p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-python hljs" data-lang="python">def __init__(self, config: EventListenerConfig, ...):
    self.config = config
    # Use the new option
    if config.new_option:
        self.enable_new_feature()</code></pre>
</div>
</div>
</li>
<li>
<p><strong>Add tests</strong>:</p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-python hljs" data-lang="python">def test_new_configuration_option():
    """Test new configuration option."""
    config = EventListenerConfig(new_option=True)
    listener = EventListener(config)
    assert listener.config.new_option is True</code></pre>
</div>
</div>
</li>
<li>
<p><strong>Update documentation</strong>:</p>
<div class="ulist">
<ul>
<li>
<p>Add to configuration guide</p>
</li>
<li>
<p>Update API reference</p>
</li>
<li>
<p>Include usage examples</p>
</li>
</ul>
</div>
</li>
</ol>
</div>
</div>
<div class="sect3">
<h4 id="_example_adding_new_job_status"><a class="anchor" href="#_example_adding_new_job_status"></a><a class="link" href="#_example_adding_new_job_status">8.4.2. Example: Adding New Job Status</a></h4>
<div class="olist arabic">
<ol class="arabic">
<li>
<p><strong>Add to JobStatus enum</strong>:</p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-python hljs" data-lang="python">class JobStatus(Enum):
    # ... existing statuses ...
    NEW_STATUS = "new_status"</code></pre>
</div>
</div>
</li>
<li>
<p><strong>Handle in job management</strong>:</p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-python hljs" data-lang="python">async def handle_new_status(self, job_id: str):
    """Handle new job status."""
    await self._update_job_status(job_id, JobStatus.NEW_STATUS)</code></pre>
</div>
</div>
</li>
<li>
<p><strong>Add query method</strong>:</p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-python hljs" data-lang="python">async def get_new_status_jobs(self) -&gt; Dict[str, JobInfo]:
    """Get jobs with new status."""
    async with self.job_lock:
        return {jid: job for jid, job in self.jobs.items()
                if job.status == JobStatus.NEW_STATUS}</code></pre>
</div>
</div>
</li>
</ol>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_testing_framework"><a class="anchor" href="#_testing_framework"></a><a class="link" href="#_testing_framework">8.5. Testing Framework</a></h3>
<div class="sect3">
<h4 id="_test_categories"><a class="anchor" href="#_test_categories"></a><a class="link" href="#_test_categories">8.5.1. Test Categories</a></h4>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 25%;">
<col style="width: 50%;">
<col style="width: 25%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Category</th>
<th class="tableblock halign-left valign-top">Description</th>
<th class="tableblock halign-left valign-top">Marker</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Unit Tests</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Test individual components</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>@pytest.mark.unit</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Integration Tests</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Test component interactions</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>@pytest.mark.integration</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Slow Tests</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Long-running tests</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>@pytest.mark.slow</code></p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect3">
<h4 id="_writing_tests"><a class="anchor" href="#_writing_tests"></a><a class="link" href="#_writing_tests">8.5.2. Writing Tests</a></h4>
<div class="sect4">
<h5 id="_unit_test_example"><a class="anchor" href="#_unit_test_example"></a><a class="link" href="#_unit_test_example">Unit Test Example</a></h5>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-python hljs" data-lang="python">import pytest
from Listener import EventListenerConfig, EventListener

@pytest.mark.unit
class TestEventListenerConfig:
    """Test EventListenerConfig class."""

    def test_default_configuration(self):
        """Test default configuration values."""
        config = EventListenerConfig()
        assert config.host == "localhost"
        assert config.port == 1883
        assert config.auto_reconnect is True

    def test_custom_configuration(self):
        """Test custom configuration values."""
        config = EventListenerConfig(
            host="mqtt.example.com",
            port=8883,
            auto_reconnect=False
        )
        assert config.host == "mqtt.example.com"
        assert config.port == 8883
        assert config.auto_reconnect is False</code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="_integration_test_example"><a class="anchor" href="#_integration_test_example"></a><a class="link" href="#_integration_test_example">Integration Test Example</a></h5>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-python hljs" data-lang="python">import pytest
import asyncio
from unittest.mock import AsyncMock

@pytest.mark.integration
@pytest.mark.asyncio
class TestEventListenerIntegration:
    """Integration tests for EventListener."""

    async def test_message_processing_workflow(self, event_listener):
        """Test complete message processing workflow."""
        # Mock MQTT client
        event_listener.client = AsyncMock()

        # Test data
        test_data = {"job_id": "test-001", "task": "process"}

        # Process message
        result = await event_listener.process_message(test_data)

        # Verify job tracking
        job_info = await event_listener.get_job_status("test-001")
        assert job_info is not None
        assert job_info.status == JobStatus.COMPLETED</code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="_async_test_example"><a class="anchor" href="#_async_test_example"></a><a class="link" href="#_async_test_example">Async Test Example</a></h5>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-python hljs" data-lang="python">@pytest.mark.asyncio
async def test_async_job_management(event_listener):
    """Test async job management operations."""
    # Create test job
    await event_listener._create_job("async-001", {"data": "test"})

    # Verify job exists
    exists = await event_listener.job_exists("async-001")
    assert exists is True

    # Check job status
    is_running = await event_listener.is_job_running("async-001")
    assert is_running is True</code></pre>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_test_fixtures"><a class="anchor" href="#_test_fixtures"></a><a class="link" href="#_test_fixtures">8.5.3. Test Fixtures</a></h4>
<div class="paragraph">
<p>Common test fixtures are defined in <code>conftest.py</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-python hljs" data-lang="python">@pytest.fixture
def sample_config():
    """Sample EventListener configuration."""
    return EventListenerConfig(
        host="test-host",
        port=1883,
        topic="test/topic",
        client_id="test-client"
    )

@pytest.fixture
def event_listener(sample_config):
    """EventListener instance for testing."""
    return EventListener(sample_config)

@pytest.fixture
async def running_listener(event_listener):
    """Running EventListener instance."""
    # Setup
    await event_listener._connect()
    yield event_listener
    # Cleanup
    event_listener.stop()</code></pre>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_build_and_release_process"><a class="anchor" href="#_build_and_release_process"></a><a class="link" href="#_build_and_release_process">8.6. Build and Release Process</a></h3>
<div class="sect3">
<h4 id="_building_the_package"><a class="anchor" href="#_building_the_package"></a><a class="link" href="#_building_the_package">8.6.1. Building the Package</a></h4>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash"># Clean previous builds
rm -rf dist/ build/ *.egg-info/

# Build package
python -m build

# Verify build
ls -la dist/</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_release_checklist"><a class="anchor" href="#_release_checklist"></a><a class="link" href="#_release_checklist">8.6.2. Release Checklist</a></h4>
<div class="olist arabic">
<ol class="arabic">
<li>
<p><strong>Pre-release</strong>:</p>
<div class="ulist checklist">
<ul class="checklist">
<li>
<p><i class="fa fa-square-o"></i> All tests pass</p>
</li>
<li>
<p><i class="fa fa-square-o"></i> Code coverage meets requirements</p>
</li>
<li>
<p><i class="fa fa-square-o"></i> Documentation updated</p>
</li>
<li>
<p><i class="fa fa-square-o"></i> Version numbers updated</p>
</li>
<li>
<p><i class="fa fa-square-o"></i> CHANGELOG.md updated</p>
</li>
</ul>
</div>
</li>
<li>
<p><strong>Version Update</strong>:</p>
<div class="ulist checklist">
<ul class="checklist">
<li>
<p><i class="fa fa-square-o"></i> Update <code>pyproject.toml</code> version</p>
</li>
<li>
<p><i class="fa fa-square-o"></i> Update <code>Listener/<em>init</em>.py</code> version</p>
</li>
<li>
<p><i class="fa fa-square-o"></i> Update documentation version references</p>
</li>
</ul>
</div>
</li>
<li>
<p><strong>Create Release</strong>:</p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash"># Create git tag
git tag -a v1.x.x -m "Release version 1.x.x"
git push origin v1.x.x

# Build and distribute
./scripts/build_package.sh</code></pre>
</div>
</div>
</li>
<li>
<p><strong>Post-release</strong>:</p>
<div class="ulist checklist">
<ul class="checklist">
<li>
<p><i class="fa fa-square-o"></i> Verify installation from git tag</p>
</li>
<li>
<p><i class="fa fa-square-o"></i> Update internal distribution documentation</p>
</li>
<li>
<p><i class="fa fa-square-o"></i> Notify team of new release</p>
</li>
</ul>
</div>
</li>
</ol>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_debugging_and_troubleshooting"><a class="anchor" href="#_debugging_and_troubleshooting"></a><a class="link" href="#_debugging_and_troubleshooting">8.7. Debugging and Troubleshooting</a></h3>
<div class="sect3">
<h4 id="_logging_configuration"><a class="anchor" href="#_logging_configuration"></a><a class="link" href="#_logging_configuration">8.7.1. Logging Configuration</a></h4>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-python hljs" data-lang="python">import logging

# Enable debug logging
logging.basicConfig(
    level=logging.DEBUG,
    format='%(asctime)s - %(name)s - %(levelname)s - %(message)s'
)

# Create logger for the library
logger = logging.getLogger('Listener')
logger.setLevel(logging.DEBUG)</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_common_debug_scenarios"><a class="anchor" href="#_common_debug_scenarios"></a><a class="link" href="#_common_debug_scenarios">8.7.2. Common Debug Scenarios</a></h4>
<div class="sect4">
<h5 id="_mqtt_connection_issues"><a class="anchor" href="#_mqtt_connection_issues"></a><a class="link" href="#_mqtt_connection_issues">MQTT Connection Issues</a></h5>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-python hljs" data-lang="python"># Enable MQTT client debugging
import logging
logging.getLogger('amqtt.client').setLevel(logging.DEBUG)

# Test connection manually
config = EventListenerConfig(host="localhost", port=1883)
listener = EventListener(config)
try:
    await listener._connect()
    print("Connection successful")
except Exception as e:
    print(f"Connection failed: {e}")</code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="_job_tracking_issues"><a class="anchor" href="#_job_tracking_issues"></a><a class="link" href="#_job_tracking_issues">Job Tracking Issues</a></h5>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-python hljs" data-lang="python"># Monitor job status
async def debug_job_tracking(listener):
    while True:
        all_jobs = await listener.get_all_jobs()
        running = await listener.get_running_jobs()
        completed = await listener.get_completed_jobs()

        print(f"Total jobs: {len(all_jobs)}")
        print(f"Running: {len(running)}")
        print(f"Completed: {len(completed)}")

        await asyncio.sleep(10)</code></pre>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_performance_profiling"><a class="anchor" href="#_performance_profiling"></a><a class="link" href="#_performance_profiling">8.7.3. Performance Profiling</a></h4>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-python hljs" data-lang="python">import cProfile
import pstats

def profile_message_processing():
    """Profile message processing performance."""
    pr = cProfile.Profile()
    pr.enable()

    # Run message processing
    asyncio.run(process_test_messages())

    pr.disable()
    stats = pstats.Stats(pr)
    stats.sort_stats('cumulative').print_stats(20)</code></pre>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_contributing_guidelines"><a class="anchor" href="#_contributing_guidelines"></a><a class="link" href="#_contributing_guidelines">8.8. Contributing Guidelines</a></h3>
<div class="sect3">
<h4 id="_code_review_process"><a class="anchor" href="#_code_review_process"></a><a class="link" href="#_code_review_process">8.8.1. Code Review Process</a></h4>
<div class="olist arabic">
<ol class="arabic">
<li>
<p><strong>Pull Request Requirements</strong>:</p>
<div class="ulist checklist">
<ul class="checklist">
<li>
<p><i class="fa fa-square-o"></i> Descriptive title and description</p>
</li>
<li>
<p><i class="fa fa-square-o"></i> All tests pass</p>
</li>
<li>
<p><i class="fa fa-square-o"></i> Code coverage maintained</p>
</li>
<li>
<p><i class="fa fa-square-o"></i> Documentation updated</p>
</li>
<li>
<p><i class="fa fa-square-o"></i> No linting errors</p>
</li>
</ul>
</div>
</li>
<li>
<p><strong>Review Checklist</strong>:</p>
<div class="ulist checklist">
<ul class="checklist">
<li>
<p><i class="fa fa-square-o"></i> Code follows project standards</p>
</li>
<li>
<p><i class="fa fa-square-o"></i> Tests cover new functionality</p>
</li>
<li>
<p><i class="fa fa-square-o"></i> Error handling is appropriate</p>
</li>
<li>
<p><i class="fa fa-square-o"></i> Performance impact considered</p>
</li>
<li>
<p><i class="fa fa-square-o"></i> Security implications reviewed</p>
</li>
</ul>
</div>
</li>
</ol>
</div>
</div>
<div class="sect3">
<h4 id="_getting_help_2"><a class="anchor" href="#_getting_help_2"></a><a class="link" href="#_getting_help_2">8.8.2. Getting Help</a></h4>
<div class="ulist">
<ul>
<li>
<p>Check existing issues in the repository</p>
</li>
<li>
<p>Review test cases for usage examples</p>
</li>
<li>
<p>Contact maintainer: <a href="mailto:aahameed@kth.se">aahameed@kth.se</a></p>
</li>
<li>
<p>Review internal documentation</p>
</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="testing"><a class="anchor" href="#testing"></a><a class="link" href="#testing">9. Testing Framework</a></h2>
<div class="sectionbody">
<div class="paragraph">
<p>Comprehensive testing guide for the MQTT Event Listener.</p>
</div>
<div class="sect2">
<h3 id="_test_suite_overview"><a class="anchor" href="#_test_suite_overview"></a><a class="link" href="#_test_suite_overview">9.1. Test Suite Overview</a></h3>
<div class="paragraph">
<p>The project maintains high code quality through comprehensive testing:</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 20%;">
<col style="width: 40%;">
<col style="width: 20%;">
<col style="width: 20%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Metric</th>
<th class="tableblock halign-left valign-top">Description</th>
<th class="tableblock halign-left valign-top">Current</th>
<th class="tableblock halign-left valign-top">Target</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Line Coverage</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Percentage of code lines tested</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">85%</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">80%+</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Unit Tests</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Individual component tests</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">45+</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Growing</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Integration Tests</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Component interaction tests</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">12+</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Growing</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Performance</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Test execution time</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">~12s</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">&lt;15s</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect2">
<h3 id="_running_tests"><a class="anchor" href="#_running_tests"></a><a class="link" href="#_running_tests">9.2. Running Tests</a></h3>
<div class="sect3">
<h4 id="_quick_commands"><a class="anchor" href="#_quick_commands"></a><a class="link" href="#_quick_commands">9.2.1. Quick Commands</a></h4>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash"># Run all tests with coverage
make test

# Run only unit tests (fast)
make test-unit

# Run integration tests
make test-integration

# Generate coverage report
make coverage

# Quick development check
make quick</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_detailed_test_commands"><a class="anchor" href="#_detailed_test_commands"></a><a class="link" href="#_detailed_test_commands">9.2.2. Detailed Test Commands</a></h4>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash"># Run tests with verbose output
pytest -v

# Run specific test file
pytest tests/test_event_listener.py

# Run specific test class
pytest tests/test_event_listener.py::TestJobManagement

# Run specific test method
pytest tests/test_event_listener.py::TestJobManagement::test_job_creation

# Run tests by marker
pytest -m unit                    # Unit tests only
pytest -m integration            # Integration tests only
pytest -m "unit and not slow"    # Fast unit tests

# Run with coverage
pytest --cov=Listener --cov-report=html

# Run with debugging
pytest -s -vv --tb=long</code></pre>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_test_structure"><a class="anchor" href="#_test_structure"></a><a class="link" href="#_test_structure">9.3. Test Structure</a></h3>
<div class="sect3">
<h4 id="_test_directory_layout"><a class="anchor" href="#_test_directory_layout"></a><a class="link" href="#_test_directory_layout">9.3.1. Test Directory Layout</a></h4>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-text hljs" data-lang="text">tests/
├── __init__.py                 # Test package initialization
├── conftest.py                 # Shared fixtures and configuration
├── test_event_listener.py      # EventListener class tests
├── test_safe_config_parser.py  # SafeConfigParser tests
├── test_integration.py         # Integration tests
└── README.md                   # Testing documentation</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_test_categories_2"><a class="anchor" href="#_test_categories_2"></a><a class="link" href="#_test_categories_2">9.3.2. Test Categories</a></h4>
<div class="sect4">
<h5 id="_unit_tests_pytest_mark_unit"><a class="anchor" href="#_unit_tests_pytest_mark_unit"></a><a class="link" href="#_unit_tests_pytest_mark_unit">Unit Tests (<code>@pytest.mark.unit</code>)</a></h5>
<div class="paragraph">
<p>Test individual components in isolation:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-python hljs" data-lang="python">@pytest.mark.unit
class TestEventListenerConfig:
    """Unit tests for EventListenerConfig."""

    def test_default_values(self):
        """Test default configuration values."""
        config = EventListenerConfig()
        assert config.host == "localhost"
        assert config.port == 1883
        assert config.auto_reconnect is True

    def test_custom_values(self):
        """Test custom configuration values."""
        config = EventListenerConfig(
            host="custom.host",
            port=8883,
            max_jobs_in_memory=1000
        )
        assert config.host == "custom.host"
        assert config.port == 8883
        assert config.max_jobs_in_memory == 1000</code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="_integration_tests_pytest_mark_integration"><a class="anchor" href="#_integration_tests_pytest_mark_integration"></a><a class="link" href="#_integration_tests_pytest_mark_integration">Integration Tests (<code>@pytest.mark.integration</code>)</a></h5>
<div class="paragraph">
<p>Test component interactions and workflows:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-python hljs" data-lang="python">@pytest.mark.integration
@pytest.mark.asyncio
class TestEventListenerIntegration:
    """Integration tests for EventListener."""

    async def test_complete_workflow(self, event_listener):
        """Test complete message processing workflow."""
        # Mock MQTT client
        event_listener.client = AsyncMock()

        # Process test message
        test_data = {"job_id": "integration-001", "task": "test"}

        def test_processor(data, job_id):
            return ReturnType(
                data={"result": "processed"},
                topic="test/results",
                qos=0,
                retain=False,
                message_id=1,
                timestamp=datetime.now(),
                job_id=job_id
            )

        # Start processing
        task = asyncio.create_task(event_listener.run(test_processor))

        # Simulate message processing
        await event_listener._process_message(test_data)

        # Verify job tracking
        job_info = await event_listener.get_job_status("integration-001")
        assert job_info is not None
        assert job_info.status == JobStatus.COMPLETED

        # Cleanup
        event_listener.stop()
        await task</code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="_slow_tests_pytest_mark_slow"><a class="anchor" href="#_slow_tests_pytest_mark_slow"></a><a class="link" href="#_slow_tests_pytest_mark_slow">Slow Tests (<code>@pytest.mark.slow</code>)</a></h5>
<div class="paragraph">
<p>Long-running tests for comprehensive scenarios:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-python hljs" data-lang="python">@pytest.mark.slow
@pytest.mark.asyncio
async def test_memory_management_over_time(event_listener):
    """Test memory management with many jobs over time."""
    # Configure for fast cleanup
    event_listener.config = EventListenerConfig(
        max_jobs_in_memory=100,
        job_cleanup_interval=1  # 1 second cleanup
    )

    # Create many jobs
    for i in range(200):
        await event_listener._create_job(f"job-{i}", {"data": i})

    # Wait for cleanup
    await asyncio.sleep(2)

    # Verify memory management
    all_jobs = await event_listener.get_all_jobs()
    assert len(all_jobs) &lt;= 100</code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_test_fixtures_2"><a class="anchor" href="#_test_fixtures_2"></a><a class="link" href="#_test_fixtures_2">9.4. Test Fixtures</a></h3>
<div class="sect3">
<h4 id="_configuration_fixtures"><a class="anchor" href="#_configuration_fixtures"></a><a class="link" href="#_configuration_fixtures">9.4.1. Configuration Fixtures</a></h4>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-python hljs" data-lang="python">@pytest.fixture
def sample_config():
    """Sample configuration for testing."""
    return EventListenerConfig(
        host="test-broker",
        port=1883,
        topic="test/events",
        client_id="test-client",
        max_jobs_in_memory=100,
        job_cleanup_interval=60
    )

@pytest.fixture
def ssl_config():
    """SSL configuration for testing."""
    return EventListenerConfig(
        host="ssl-broker",
        port=8883,
        cafile="/path/to/test-ca.crt",
        topic="secure/events"
    )</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_eventlistener_fixtures"><a class="anchor" href="#_eventlistener_fixtures"></a><a class="link" href="#_eventlistener_fixtures">9.4.2. EventListener Fixtures</a></h4>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-python hljs" data-lang="python">@pytest.fixture
def event_listener(sample_config):
    """EventListener instance for testing."""
    return EventListener(sample_config)

@pytest.fixture
def mock_mqtt_client():
    """Mocked MQTT client."""
    client = AsyncMock()
    client.connect = AsyncMock()
    client.disconnect = AsyncMock()
    client.subscribe = AsyncMock()
    client.publish = AsyncMock()
    return client

@pytest.fixture
async def connected_listener(event_listener, mock_mqtt_client):
    """EventListener with mocked MQTT client."""
    event_listener.client = mock_mqtt_client
    await event_listener._connect()
    yield event_listener
    event_listener.stop()</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_data_fixtures"><a class="anchor" href="#_data_fixtures"></a><a class="link" href="#_data_fixtures">9.4.3. Data Fixtures</a></h4>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-python hljs" data-lang="python">@pytest.fixture
def sample_toml_data():
    """Sample TOML data for testing."""
    return {
        "job_id": "test-001",
        "task_type": "data_processing",
        "priority": "high",
        "data": {
            "input_file": "/test/input.csv",
            "output_file": "/test/output.json"
        }
    }

@pytest.fixture
def temp_toml_file(tmp_path):
    """Temporary TOML file for testing."""
    toml_content = """
    job_id = "file-test-001"
    task_type = "file_processing"

    [data]
    input = "/path/to/input"
    output = "/path/to/output"
    """

    toml_file = tmp_path / "test_config.toml"
    toml_file.write_text(toml_content)
    return str(toml_file)</code></pre>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_testing_patterns"><a class="anchor" href="#_testing_patterns"></a><a class="link" href="#_testing_patterns">9.5. Testing Patterns</a></h3>
<div class="sect3">
<h4 id="_async_testing"><a class="anchor" href="#_async_testing"></a><a class="link" href="#_async_testing">9.5.1. Async Testing</a></h4>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-python hljs" data-lang="python">@pytest.mark.asyncio
async def test_async_job_operations(event_listener):
    """Test async job management operations."""
    # Create job
    await event_listener._create_job("async-001", {"test": "data"})

    # Check job status
    job_info = await event_listener.get_job_status("async-001")
    assert job_info is not None
    assert job_info.status == JobStatus.PENDING

    # Update job status
    await event_listener._update_job_status(
        "async-001",
        JobStatus.COMPLETED,
        result={"success": True}
    )

    # Verify update
    updated_job = await event_listener.get_job_status("async-001")
    assert updated_job.status == JobStatus.COMPLETED
    assert updated_job.result == {"success": True}</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_mocking_external_dependencies"><a class="anchor" href="#_mocking_external_dependencies"></a><a class="link" href="#_mocking_external_dependencies">9.5.2. Mocking External Dependencies</a></h4>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-python hljs" data-lang="python">from unittest.mock import AsyncMock, patch

@pytest.mark.unit
async def test_mqtt_connection_error_handling(event_listener):
    """Test MQTT connection error handling."""
    # Mock connection failure
    with patch.object(event_listener.client, 'connect') as mock_connect:
        mock_connect.side_effect = ConnectionError("Connection failed")

        # Test error handling
        with pytest.raises(ConnectionError):
            await event_listener._connect()

@pytest.mark.unit
def test_toml_parsing_error_handling(safe_config_parser):
    """Test TOML parsing error handling."""
    invalid_toml = "invalid toml content [[[["

    with pytest.raises(ConfigError):
        safe_config_parser.parse_config_from_string(invalid_toml)</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_parameterized_tests"><a class="anchor" href="#_parameterized_tests"></a><a class="link" href="#_parameterized_tests">9.5.3. Parameterized Tests</a></h4>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-python hljs" data-lang="python">@pytest.mark.parametrize("host,port,expected", [
    ("localhost", 1883, "mqtt://localhost:1883"),
    ("mqtt.example.com", 8883, "mqtt://mqtt.example.com:8883"),
    ("ssl-broker", 8884, "mqtt://ssl-broker:8884"),
])
def test_uri_generation(host, port, expected):
    """Test URI generation with different parameters."""
    config = EventListenerConfig(host=host, port=port)
    assert config.uri == expected

@pytest.mark.parametrize("status,expected_running", [
    (JobStatus.PENDING, False),
    (JobStatus.RUNNING, True),
    (JobStatus.COMPLETED, False),
    (JobStatus.FAILED, False),
])
async def test_job_running_status(event_listener, status, expected_running):
    """Test job running status detection."""
    await event_listener._create_job("param-001", {})
    await event_listener._update_job_status("param-001", status)

    is_running = await event_listener.is_job_running("param-001")
    assert is_running == expected_running</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_error_condition_testing"><a class="anchor" href="#_error_condition_testing"></a><a class="link" href="#_error_condition_testing">9.5.4. Error Condition Testing</a></h4>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-python hljs" data-lang="python">@pytest.mark.unit
def test_invalid_configuration():
    """Test handling of invalid configuration."""
    with pytest.raises(ValueError):
        EventListenerConfig(port=-1)  # Invalid port

    with pytest.raises(ValueError):
        EventListenerConfig(qos=5)    # Invalid QoS

@pytest.mark.unit
async def test_duplicate_job_handling(event_listener):
    """Test duplicate job detection and handling."""
    # Create initial job
    await event_listener._create_job("dup-001", {"data": "test"})

    # Try to create duplicate
    duplicate_created = await event_listener._create_job("dup-001", {"data": "test2"})
    assert duplicate_created is False

    # Verify duplicate tracking
    duplicates = await event_listener.get_duplicate_jobs()
    assert "dup-001" in duplicates</code></pre>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_coverage_analysis"><a class="anchor" href="#_coverage_analysis"></a><a class="link" href="#_coverage_analysis">9.6. Coverage Analysis</a></h3>
<div class="sect3">
<h4 id="_coverage_configuration"><a class="anchor" href="#_coverage_configuration"></a><a class="link" href="#_coverage_configuration">9.6.1. Coverage Configuration</a></h4>
<div class="paragraph">
<p>Coverage settings in <code>pyproject.toml</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-toml hljs" data-lang="toml">[tool.coverage.run]
source = ["Listener"]
omit = ["*/tests/*", "*/test_*"]

[tool.coverage.report]
exclude_lines = [
    "pragma: no cover",
    "def __repr__",
    "if self.debug:",
    "raise AssertionError",
    "raise NotImplementedError",
    "if __name__ == .__main__.:",
]</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_coverage_reports"><a class="anchor" href="#_coverage_reports"></a><a class="link" href="#_coverage_reports">9.6.2. Coverage Reports</a></h4>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash"># Generate HTML coverage report
pytest --cov=Listener --cov-report=html
open htmlcov/index.html

# Generate terminal report
pytest --cov=Listener --cov-report=term-missing

# Generate XML report (for CI)
pytest --cov=Listener --cov-report=xml</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_coverage_targets"><a class="anchor" href="#_coverage_targets"></a><a class="link" href="#_coverage_targets">9.6.3. Coverage Targets</a></h4>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 20%;">
<col style="width: 40%;">
<col style="width: 20%;">
<col style="width: 20%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Coverage Type</th>
<th class="tableblock halign-left valign-top">Description</th>
<th class="tableblock halign-left valign-top">Current</th>
<th class="tableblock halign-left valign-top">Target</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Line Coverage</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Percentage of lines executed</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">85%</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">80%+</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Branch Coverage</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Percentage of branches taken</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">82%</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">80%+</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Function Coverage</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Percentage of functions called</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">95%</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">90%+</p></td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="sect2">
<h3 id="_performance_testing"><a class="anchor" href="#_performance_testing"></a><a class="link" href="#_performance_testing">9.7. Performance Testing</a></h3>
<div class="sect3">
<h4 id="_benchmark_tests"><a class="anchor" href="#_benchmark_tests"></a><a class="link" href="#_benchmark_tests">9.7.1. Benchmark Tests</a></h4>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-python hljs" data-lang="python">import time
import pytest

@pytest.mark.benchmark
def test_job_creation_performance(event_listener, benchmark):
    """Benchmark job creation performance."""
    def create_jobs():
        for i in range(100):
            asyncio.run(event_listener._create_job(f"perf-{i}", {"data": i}))

    result = benchmark(create_jobs)
    assert result is not None

@pytest.mark.benchmark
async def test_message_processing_throughput(event_listener):
    """Test message processing throughput."""
    start_time = time.time()

    # Process 1000 messages
    for i in range(1000):
        test_data = {"job_id": f"throughput-{i}", "data": i}
        await event_listener._process_message(test_data)

    end_time = time.time()
    duration = end_time - start_time
    throughput = 1000 / duration

    print(f"Throughput: {throughput:.1f} messages/second")
    assert throughput &gt; 100  # Minimum acceptable throughput</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_memory_usage_tests"><a class="anchor" href="#_memory_usage_tests"></a><a class="link" href="#_memory_usage_tests">9.7.2. Memory Usage Tests</a></h4>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-python hljs" data-lang="python">import psutil
import gc

@pytest.mark.slow
async def test_memory_usage_under_load(event_listener):
    """Test memory usage under sustained load."""
    process = psutil.Process()
    initial_memory = process.memory_info().rss

    # Create many jobs
    for i in range(10000):
        await event_listener._create_job(f"memory-{i}", {"data": f"test-{i}"})

    # Force garbage collection
    gc.collect()

    peak_memory = process.memory_info().rss
    memory_increase = peak_memory - initial_memory
    memory_mb = memory_increase / 1024 / 1024

    print(f"Memory increase: {memory_mb:.1f} MB")
    assert memory_mb &lt; 100  # Should not use more than 100MB</code></pre>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_continuous_integration"><a class="anchor" href="#_continuous_integration"></a><a class="link" href="#_continuous_integration">9.8. Continuous Integration</a></h3>
<div class="sect3">
<h4 id="_github_actions_workflow"><a class="anchor" href="#_github_actions_workflow"></a><a class="link" href="#_github_actions_workflow">9.8.1. GitHub Actions Workflow</a></h4>
<div class="paragraph">
<p>Tests run automatically on:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Push to <code>main</code> or <code>develop</code> branches</p>
</li>
<li>
<p>Pull requests</p>
</li>
<li>
<p>Tag creation</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-yaml hljs" data-lang="yaml">name: Tests
on: [push, pull_request]

jobs:
  test:
    runs-on: ubuntu-latest
    strategy:
      matrix:
        python-version: [3.8, 3.9, 3.10, 3.11, 3.12]

    steps:
    - uses: actions/checkout@v3
    - name: Set up Python ${{ matrix.python-version }}
      uses: actions/setup-python@v3
      with:
        python-version: ${{ matrix.python-version }}

    - name: Install dependencies
      run: |
        pip install -e .[dev]

    - name: Run tests
      run: |
        pytest --cov=Listener --cov-report=xml

    - name: Upload coverage
      uses: codecov/codecov-action@v3</code></pre>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_test_maintenance"><a class="anchor" href="#_test_maintenance"></a><a class="link" href="#_test_maintenance">9.9. Test Maintenance</a></h3>
<div class="sect3">
<h4 id="_adding_new_tests"><a class="anchor" href="#_adding_new_tests"></a><a class="link" href="#_adding_new_tests">9.9.1. Adding New Tests</a></h4>
<div class="paragraph">
<p>When adding new functionality:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p><strong>Write tests first</strong> (TDD approach)</p>
</li>
<li>
<p><strong>Cover both success and failure cases</strong></p>
</li>
<li>
<p><strong>Include edge cases and error conditions</strong></p>
</li>
<li>
<p><strong>Add integration tests for new workflows</strong></p>
</li>
<li>
<p><strong>Update test documentation</strong></p>
</li>
</ol>
</div>
</div>
<div class="sect3">
<h4 id="_test_review_checklist"><a class="anchor" href="#_test_review_checklist"></a><a class="link" href="#_test_review_checklist">9.9.2. Test Review Checklist</a></h4>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>[ ] Tests cover new functionality</p>
</li>
<li>
<p>[ ] Both positive and negative cases tested</p>
</li>
<li>
<p>[ ] Async operations properly tested</p>
</li>
<li>
<p>[ ] Mocks used appropriately</p>
</li>
<li>
<p>[ ] Test names are descriptive</p>
</li>
<li>
<p>[ ] Tests are fast and reliable</p>
</li>
<li>
<p>[ ] Coverage requirements met</p>
</li>
</ol>
</div>
</div>
<div class="sect3">
<h4 id="_debugging_tests"><a class="anchor" href="#_debugging_tests"></a><a class="link" href="#_debugging_tests">9.9.3. Debugging Tests</a></h4>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash"># Run single test with debugging
pytest tests/test_event_listener.py::test_specific -s -vv

# Run tests and drop into debugger on failure
pytest --pdb

# Run tests with profiling
pytest --profile

# Show test durations
pytest --durations=10</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="architecture"><a class="anchor" href="#architecture"></a><a class="link" href="#architecture">10. System Architecture</a></h2>
<div class="sectionbody">
<div class="paragraph">
<p>Technical architecture and design of the MQTT Event Listener.</p>
</div>
<div class="sect2">
<h3 id="_high_level_architecture"><a class="anchor" href="#_high_level_architecture"></a><a class="link" href="#_high_level_architecture">10.1. High-Level Architecture</a></h3>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-text hljs" data-lang="text">┌─────────────────────────────────────────────────────────────────┐
│                    MQTT Event Listener                         │
├─────────────────────────────────────────────────────────────────┤
│  ┌─────────────────┐  ┌─────────────────┐  ┌─────────────────┐ │
│  │  EventListener  │  │ SafeConfigParser│  │ EventListener   │ │
│  │                 │  │                 │  │ Config          │ │
│  │ • Message Proc  │  │ • TOML Parsing  │  │ • Configuration │ │
│  │ • Job Tracking  │  │ • Validation    │  │ • Validation    │ │
│  │ • MQTT Client   │  │ • Error Handling│  │ • Defaults      │ │
│  └─────────────────┘  └─────────────────┘  └─────────────────┘ │
├─────────────────────────────────────────────────────────────────┤
│  ┌─────────────────┐  ┌─────────────────┐  ┌─────────────────┐ │
│  │    JobInfo      │  │   ReturnType    │  │   JobStatus     │ │
│  │                 │  │                 │  │                 │ │
│  │ • Job Metadata  │  │ • Result Data   │  │ • Status Enum   │ │
│  │ • Status        │  │ • Topic Info    │  │ • Transitions   │ │
│  │ • Timestamps    │  │ • MQTT Settings │  │                 │ │
│  └─────────────────┘  └─────────────────┘  └─────────────────┘ │
├─────────────────────────────────────────────────────────────────┤
│                       Dependencies                             │
│  ┌─────────────────┐  ┌─────────────────┐  ┌─────────────────┐ │
│  │     AMQTT       │  │      TOML       │  │    asyncio      │ │
│  │                 │  │                 │  │                 │ │
│  │ • MQTT Client   │  │ • Config Parser │  │ • Async Runtime │ │
│  │ • SSL Support   │  │ • Serialization │  │ • Event Loop    │ │
│  │ • Auto-reconnect│  │                 │  │ • Concurrency   │ │
│  └─────────────────┘  └─────────────────┘  └─────────────────┘ │
└─────────────────────────────────────────────────────────────────┘</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_component_architecture"><a class="anchor" href="#_component_architecture"></a><a class="link" href="#_component_architecture">10.2. Component Architecture</a></h3>
<div class="sect3">
<h4 id="_eventlistener_core"><a class="anchor" href="#_eventlistener_core"></a><a class="link" href="#_eventlistener_core">10.2.1. EventListener Core</a></h4>
<div class="paragraph">
<p>The main <code>EventListener</code> class orchestrates all functionality:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-text hljs" data-lang="text">EventListener
├── Configuration Management
│   ├── Config validation
│   ├── Environment integration
│   └── Default value handling
├── MQTT Client Management
│   ├── Connection handling
│   ├── Subscription management
│   ├── Auto-reconnection
│   └── SSL/TLS support
├── Message Processing
│   ├── TOML parsing
│   ├── Job creation
│   ├── Function execution
│   └── Result publishing
├── Job Tracking System
│   ├── In-memory storage
│   ├── Status management
│   ├── Duplicate detection
│   └── Cleanup operations
└── Error Handling
    ├── Connection errors
    ├── Processing errors
    ├── Configuration errors
    └── Recovery mechanisms</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_data_flow"><a class="anchor" href="#_data_flow"></a><a class="link" href="#_data_flow">10.2.2. Data Flow</a></h4>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-text hljs" data-lang="text">MQTT Message → TOML Parser → Job Creation → Processing Function → Result Publishing
     ↓              ↓             ↓              ↓                  ↓
Connection     Validation    Job Tracking   User Function     MQTT Publish
Management     &amp; Parsing     &amp; Status       Execution         &amp; Logging
     ↓              ↓             ↓              ↓                  ↓
Auto-reconnect Error         Memory         Error            Topic
&amp; Monitoring   Handling      Management     Handling         Routing</code></pre>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_memory_management_2"><a class="anchor" href="#_memory_management_2"></a><a class="link" href="#_memory_management_2">10.3. Memory Management</a></h3>
<div class="sect3">
<h4 id="_job_storage_strategy"><a class="anchor" href="#_job_storage_strategy"></a><a class="link" href="#_job_storage_strategy">10.3.1. Job Storage Strategy</a></h4>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 16.6666%;">
<col style="width: 33.3333%;">
<col style="width: 16.6666%;">
<col style="width: 33.3335%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Component</th>
<th class="tableblock halign-left valign-top">Storage Type</th>
<th class="tableblock halign-left valign-top">Lifetime</th>
<th class="tableblock halign-left valign-top">Cleanup Strategy</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Active Jobs</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">In-memory Dict</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Processing duration</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Immediate on completion</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Completed Jobs</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">In-memory Dict</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Configurable TTL</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Periodic cleanup</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Failed Jobs</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">In-memory Dict</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Configurable TTL</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Periodic cleanup</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Duplicate Jobs</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">In-memory Set</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Configurable TTL</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Periodic cleanup</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect3">
<h4 id="_memory_optimization"><a class="anchor" href="#_memory_optimization"></a><a class="link" href="#_memory_optimization">10.3.2. Memory Optimization</a></h4>
<div class="ulist">
<ul>
<li>
<p><strong>Configurable limits</strong> on maximum jobs in memory</p>
</li>
<li>
<p><strong>Periodic cleanup</strong> of old completed jobs</p>
</li>
<li>
<p><strong>Efficient data structures</strong> for job tracking</p>
</li>
<li>
<p><strong>Memory monitoring</strong> capabilities</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-python hljs" data-lang="python"># Memory-efficient job storage
class JobTracker:
    def __init__(self, max_jobs: int = 5000):
        self.jobs: Dict[str, JobInfo] = {}
        self.max_jobs = max_jobs
        self.cleanup_interval = 3600  # 1 hour

    async def cleanup_old_jobs(self):
        """Remove old completed/failed jobs."""
        cutoff_time = datetime.now() - timedelta(seconds=self.cleanup_interval)

        to_remove = [
            job_id for job_id, job in self.jobs.items()
            if job.status in [JobStatus.COMPLETED, JobStatus.FAILED]
            and job.completed_at
            and job.completed_at &lt; cutoff_time
        ]

        for job_id in to_remove:
            del self.jobs[job_id]</code></pre>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_concurrency_model"><a class="anchor" href="#_concurrency_model"></a><a class="link" href="#_concurrency_model">10.4. Concurrency Model</a></h3>
<div class="sect3">
<h4 id="_asyncawait_architecture"><a class="anchor" href="#_asyncawait_architecture"></a><a class="link" href="#_asyncawait_architecture">10.4.1. Async/Await Architecture</a></h4>
<div class="paragraph">
<p>The library is built on Python&#8217;s asyncio framework:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-text hljs" data-lang="text">Main Event Loop
├── MQTT Client Task
│   ├── Connection monitoring
│   ├── Message receiving
│   └── Reconnection handling
├── Message Processing Tasks
│   ├── Parallel processing
│   ├── Job status updates
│   └── Result publishing
├── Cleanup Tasks
│   ├── Periodic job cleanup
│   ├── Memory monitoring
│   └── Health checks
└── User Function Execution
    ├── Sync function wrapper
    ├── Async function direct call
    └── Error boundary handling</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_thread_safety"><a class="anchor" href="#_thread_safety"></a><a class="link" href="#_thread_safety">10.4.2. Thread Safety</a></h4>
<div class="ulist">
<ul>
<li>
<p><strong>asyncio-based</strong> - Single-threaded event loop</p>
</li>
<li>
<p><strong>Lock-protected</strong> job management operations</p>
</li>
<li>
<p><strong>Atomic updates</strong> for job status changes</p>
</li>
<li>
<p><strong>Thread-safe</strong> configuration access</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-python hljs" data-lang="python">class EventListener:
    def __init__(self, config: EventListenerConfig):
        self.job_lock = asyncio.Lock()  # Protects job operations
        self.jobs: Dict[str, JobInfo] = {}

    async def _create_job(self, job_id: str, data: Dict[str, Any]) -&gt; bool:
        async with self.job_lock:
            if job_id in self.jobs:
                return False  # Duplicate
            self.jobs[job_id] = JobInfo(job_id=job_id, ...)
            return True</code></pre>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_error_handling_strategy"><a class="anchor" href="#_error_handling_strategy"></a><a class="link" href="#_error_handling_strategy">10.5. Error Handling Strategy</a></h3>
<div class="sect3">
<h4 id="_error_classification"><a class="anchor" href="#_error_classification"></a><a class="link" href="#_error_classification">10.5.1. Error Classification</a></h4>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 16.6666%;">
<col style="width: 33.3333%;">
<col style="width: 16.6666%;">
<col style="width: 33.3335%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Error Type</th>
<th class="tableblock halign-left valign-top">Description</th>
<th class="tableblock halign-left valign-top">Recovery</th>
<th class="tableblock halign-left valign-top">Impact</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Connection Errors</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">MQTT broker connectivity</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Auto-reconnect</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Service disruption</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Configuration Errors</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Invalid settings</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Manual fix required</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Startup failure</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Processing Errors</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">User function failures</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Job marked failed</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Single job impact</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Memory Errors</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Resource exhaustion</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Cleanup + backpressure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Performance degradation</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect3">
<h4 id="_error_recovery"><a class="anchor" href="#_error_recovery"></a><a class="link" href="#_error_recovery">10.5.2. Error Recovery</a></h4>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-text hljs" data-lang="text">Error Detection
     ↓
Error Classification
     ↓
Recovery Strategy Selection
     ├── Auto-retry (Connection)
     ├── Job Failure (Processing)
     ├── Circuit Breaker (Repeated failures)
     └── Graceful Degradation (Resource issues)
     ↓
Error Logging &amp; Monitoring
     ↓
Recovery Execution</code></pre>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_performance_characteristics"><a class="anchor" href="#_performance_characteristics"></a><a class="link" href="#_performance_characteristics">10.6. Performance Characteristics</a></h3>
<div class="sect3">
<h4 id="_throughput_metrics"><a class="anchor" href="#_throughput_metrics"></a><a class="link" href="#_throughput_metrics">10.6.1. Throughput Metrics</a></h4>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 20%;">
<col style="width: 40%;">
<col style="width: 20%;">
<col style="width: 20%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Metric</th>
<th class="tableblock halign-left valign-top">Description</th>
<th class="tableblock halign-left valign-top">Typical Value</th>
<th class="tableblock halign-left valign-top">Target</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Message Processing</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Messages per second</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">100-1000 msg/s</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">&gt;100 msg/s</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Memory Usage</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">RAM per 1000 jobs</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">~10-50 MB</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">&lt;100 MB</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Latency</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Processing delay</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">&lt;100ms</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">&lt;500ms</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Connection Recovery</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Reconnection time</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1-10 seconds</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">&lt;30 seconds</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect3">
<h4 id="_scalability_factors"><a class="anchor" href="#_scalability_factors"></a><a class="link" href="#_scalability_factors">10.6.2. Scalability Factors</a></h4>
<div class="ulist">
<ul>
<li>
<p><strong>Message size</strong> - Larger TOML messages require more parsing time</p>
</li>
<li>
<p><strong>Processing complexity</strong> - User function execution time dominates</p>
</li>
<li>
<p><strong>Job retention</strong> - More jobs in memory increase lookup time</p>
</li>
<li>
<p><strong>Network latency</strong> - MQTT broker distance affects performance</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_security_architecture"><a class="anchor" href="#_security_architecture"></a><a class="link" href="#_security_architecture">10.7. Security Architecture</a></h3>
<div class="sect3">
<h4 id="_security_layers"><a class="anchor" href="#_security_layers"></a><a class="link" href="#_security_layers">10.7.1. Security Layers</a></h4>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-text hljs" data-lang="text">Application Security
├── Input Validation
│   ├── TOML syntax validation
│   ├── Configuration validation
│   └── Message size limits
├── Connection Security
│   ├── SSL/TLS encryption
│   ├── Certificate validation
│   ├── Authentication
│   └── Authorization
├── Data Security
│   ├── Secure configuration handling
│   ├── Credential management
│   └── Memory protection
└── Process Security
    ├── Error information filtering
    ├── Logging sanitization
    └── Resource limits</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_security_considerations"><a class="anchor" href="#_security_considerations"></a><a class="link" href="#_security_considerations">10.7.2. Security Considerations</a></h4>
<div class="ulist">
<ul>
<li>
<p><strong>Credential Protection</strong> - Environment variables for sensitive data</p>
</li>
<li>
<p><strong>Network Security</strong> - SSL/TLS for all MQTT connections</p>
</li>
<li>
<p><strong>Input Validation</strong> - Strict TOML parsing and validation</p>
</li>
<li>
<p><strong>Resource Limits</strong> - Memory and processing bounds</p>
</li>
<li>
<p><strong>Error Handling</strong> - No sensitive data in error messages</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_configuration_architecture"><a class="anchor" href="#_configuration_architecture"></a><a class="link" href="#_configuration_architecture">10.8. Configuration Architecture</a></h3>
<div class="sect3">
<h4 id="_configuration_hierarchy"><a class="anchor" href="#_configuration_hierarchy"></a><a class="link" href="#_configuration_hierarchy">10.8.1. Configuration Hierarchy</a></h4>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-text hljs" data-lang="text">Configuration Sources (Priority Order)
1. Explicit Parameters (Highest)
2. Environment Variables
3. Configuration Files
4. Default Values (Lowest)

Configuration Validation
├── Type checking
├── Range validation
├── Format validation
└── Dependency validation

Configuration Application
├── MQTT client setup
├── Job management setup
├── Error handling setup
└── Performance tuning</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_configuration_flow"><a class="anchor" href="#_configuration_flow"></a><a class="link" href="#_configuration_flow">10.8.2. Configuration Flow</a></h4>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-python hljs" data-lang="python"># Configuration processing flow
EventListenerConfig.__post_init__()
    ↓
validate_configuration()
    ├── Port range (1-65535)
    ├── QoS values (0, 1, 2)
    ├── Timeout values (&gt;0)
    └── Memory limits (&gt;0)
    ↓
apply_environment_overrides()
    ↓
generate_derived_values()
    ├── URI from host/port
    ├── Topic configurations
    └── SSL context setup</code></pre>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_extensibility_points"><a class="anchor" href="#_extensibility_points"></a><a class="link" href="#_extensibility_points">10.9. Extensibility Points</a></h3>
<div class="sect3">
<h4 id="_plugin_architecture"><a class="anchor" href="#_plugin_architecture"></a><a class="link" href="#_plugin_architecture">10.9.1. Plugin Architecture</a></h4>
<div class="paragraph">
<p>The library provides several extension points:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>Custom Processors</strong> - User-defined message processing functions</p>
</li>
<li>
<p><strong>Configuration Parsers</strong> - Alternative to SafeConfigParser</p>
</li>
<li>
<p><strong>Error Handlers</strong> - Custom error processing logic</p>
</li>
<li>
<p><strong>Monitoring Hooks</strong> - Performance and health monitoring</p>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="_future_extensions"><a class="anchor" href="#_future_extensions"></a><a class="link" href="#_future_extensions">10.9.2. Future Extensions</a></h4>
<div class="ulist">
<ul>
<li>
<p><strong>Persistence Layer</strong> - Database storage for jobs</p>
</li>
<li>
<p><strong>Message Serializers</strong> - Support for JSON, MessagePack, etc.</p>
</li>
<li>
<p><strong>Load Balancing</strong> - Distributed processing capabilities</p>
</li>
<li>
<p><strong>Caching Layer</strong> - Redis/Memcached integration</p>
</li>
<li>
<p><strong>Metrics Export</strong> - Prometheus/StatsD integration</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_testing_architecture"><a class="anchor" href="#_testing_architecture"></a><a class="link" href="#_testing_architecture">10.10. Testing Architecture</a></h3>
<div class="sect3">
<h4 id="_test_strategy"><a class="anchor" href="#_test_strategy"></a><a class="link" href="#_test_strategy">10.10.1. Test Strategy</a></h4>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-text hljs" data-lang="text">Testing Pyramid
├── Unit Tests (45+ tests)
│   ├── Configuration validation
│   ├── Job management
│   ├── TOML parsing
│   └── Error handling
├── Integration Tests (12+ tests)
│   ├── MQTT connectivity
│   ├── End-to-end workflows
│   ├── Error scenarios
│   └── Performance tests
└── System Tests
    ├── Multi-environment
    ├── Load testing
    └── Failure testing</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_mock_architecture"><a class="anchor" href="#_mock_architecture"></a><a class="link" href="#_mock_architecture">10.10.2. Mock Architecture</a></h4>
<div class="ulist">
<ul>
<li>
<p><strong>MQTT Client Mocking</strong> - AsyncMock for AMQTT client</p>
</li>
<li>
<p><strong>Network Simulation</strong> - Connection failure scenarios</p>
</li>
<li>
<p><strong>Time Mocking</strong> - Accelerated cleanup testing</p>
</li>
<li>
<p><strong>File System Mocking</strong> - Configuration file testing</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_deployment_architecture"><a class="anchor" href="#_deployment_architecture"></a><a class="link" href="#_deployment_architecture">10.11. Deployment Architecture</a></h3>
<div class="sect3">
<h4 id="_internal_deployment"><a class="anchor" href="#_internal_deployment"></a><a class="link" href="#_internal_deployment">10.11.1. Internal Deployment</a></h4>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-text hljs" data-lang="text">Development Environment
├── Local MQTT broker
├── Development configuration
├── Debug logging
└── Test data

Staging Environment
├── Staging MQTT broker
├── Production-like config
├── Integration testing
└── Performance validation

Production Environment
├── Production MQTT broker
├── Optimized configuration
├── Monitoring &amp; alerting
└── High availability</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_distribution_model"><a class="anchor" href="#_distribution_model"></a><a class="link" href="#_distribution_model">10.11.2. Distribution Model</a></h4>
<div class="ulist">
<ul>
<li>
<p><strong>Git-based Installation</strong> - Direct from repository</p>
</li>
<li>
<p><strong>Wheel Distribution</strong> - Pre-built packages</p>
</li>
<li>
<p><strong>Container Support</strong> - Docker deployment ready</p>
</li>
<li>
<p><strong>Internal Package Index</strong> - Private package repository</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_monitoring_and_observability"><a class="anchor" href="#_monitoring_and_observability"></a><a class="link" href="#_monitoring_and_observability">10.12. Monitoring and Observability</a></h3>
<div class="sect3">
<h4 id="_built_in_monitoring"><a class="anchor" href="#_built_in_monitoring"></a><a class="link" href="#_built_in_monitoring">10.12.1. Built-in Monitoring</a></h4>
<div class="ulist">
<ul>
<li>
<p><strong>Job Status Tracking</strong> - Real-time job state monitoring</p>
</li>
<li>
<p><strong>Connection Health</strong> - MQTT connection status</p>
</li>
<li>
<p><strong>Memory Usage</strong> - Job memory consumption</p>
</li>
<li>
<p><strong>Error Rates</strong> - Processing failure statistics</p>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="_external_integration"><a class="anchor" href="#_external_integration"></a><a class="link" href="#_external_integration">10.12.2. External Integration</a></h4>
<div class="ulist">
<ul>
<li>
<p><strong>Logging Integration</strong> - Standard Python logging</p>
</li>
<li>
<p><strong>Metrics Export</strong> - Future Prometheus support</p>
</li>
<li>
<p><strong>Health Checks</strong> - HTTP endpoint (planned)</p>
</li>
<li>
<p><strong>Distributed Tracing</strong> - OpenTelemetry (planned)</p>
</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="examples"><a class="anchor" href="#examples"></a><a class="link" href="#examples">11. Examples and Use Cases</a></h2>
<div class="sectionbody">
<div class="paragraph">
<p>Practical examples for common use cases of the MQTT Event Listener.</p>
</div>
<div class="sect2">
<h3 id="_basic_examples"><a class="anchor" href="#_basic_examples"></a><a class="link" href="#_basic_examples">11.1. Basic Examples</a></h3>
<div class="sect3">
<h4 id="_simple_message_processing"><a class="anchor" href="#_simple_message_processing"></a><a class="link" href="#_simple_message_processing">11.1.1. Simple Message Processing</a></h4>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-python hljs" data-lang="python">import asyncio
from Listener import EventListener, EventListenerConfig

async def main():
    """Basic message processing example."""
    # Configuration
    config = EventListenerConfig(
        host="localhost",
        port=1883,
        topic="events/tasks",
        client_id="simple-processor"
    )

    # Create listener
    listener = EventListener(config)

    # Define processor
    def simple_processor(data, job_id):
        """Process incoming messages."""
        print(f"Processing job {job_id}")
        print(f"Task: {data.get('task_type', 'unknown')}")

        # Simple processing logic
        result = {
            "job_id": job_id,
            "status": "completed",
            "processed_at": datetime.now().isoformat(),
            "data": data
        }

        return ReturnType(
            data=result,
            topic="events/results",
            qos=1,
            retain=False,
            message_id=int(time.time()),
            timestamp=datetime.now(),
            job_id=job_id
        )

    # Start processing
    print("Starting MQTT Event Listener...")
    await listener.run(simple_processor)

if __name__ == "__main__":
    asyncio.run(main())</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_configuration_from_environment_2"><a class="anchor" href="#_configuration_from_environment_2"></a><a class="link" href="#_configuration_from_environment_2">11.1.2. Configuration from Environment</a></h4>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-python hljs" data-lang="python">import os
import asyncio
from Listener import EventListener, EventListenerConfig

def create_config_from_env():
    """Create configuration from environment variables."""
    return EventListenerConfig(
        host=os.getenv("MQTT_HOST", "localhost"),
        port=int(os.getenv("MQTT_PORT", 1883)),
        username=os.getenv("MQTT_USERNAME"),
        password=os.getenv("MQTT_PASSWORD"),
        topic=os.getenv("MQTT_TOPIC", "events"),
        client_id=os.getenv("MQTT_CLIENT_ID", "env-listener"),

        # SSL settings
        cafile=os.getenv("MQTT_CA_FILE"),

        # Job settings
        max_jobs_in_memory=int(os.getenv("MAX_JOBS", 5000)),
        job_cleanup_interval=int(os.getenv("CLEANUP_INTERVAL", 3600))
    )

async def main():
    config = create_config_from_env()
    listener = EventListener(config)

    def env_processor(data, job_id):
        return ReturnType(
            data={"processed": True, "job_id": job_id},
            topic=os.getenv("RESULTS_TOPIC", "results"),
            qos=1,
            retain=False,
            message_id=1,
            timestamp=datetime.now(),
            job_id=job_id
        )

    await listener.run(env_processor)

if __name__ == "__main__":
    asyncio.run(main())</code></pre>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_advanced_examples"><a class="anchor" href="#_advanced_examples"></a><a class="link" href="#_advanced_examples">11.2. Advanced Examples</a></h3>
<div class="sect3">
<h4 id="_multi_topic_processing"><a class="anchor" href="#_multi_topic_processing"></a><a class="link" href="#_multi_topic_processing">11.2.1. Multi-Topic Processing</a></h4>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-python hljs" data-lang="python">import asyncio
from Listener import EventListener, EventListenerConfig, ReturnType

async def multi_topic_example():
    """Process messages from multiple topics with different handling."""

    config = EventListenerConfig(
        host="mqtt.example.com",
        port=1883,
        topic="events/#",  # Subscribe to all events
        custom_topics={
            "events/alerts": {"qos": 2, "retain": True},
            "events/metrics": {"qos": 0, "retain": False},
            "events/commands": {"qos": 1, "retain": False}
        }
    )

    listener = EventListener(config)

    def multi_topic_processor(data, job_id):
        """Route processing based on topic or message type."""
        topic = data.get('_topic', '')  # Topic info from context
        message_type = data.get('type', 'unknown')

        if 'alerts' in topic or message_type == 'alert':
            return process_alert(data, job_id)
        elif 'metrics' in topic or message_type == 'metric':
            return process_metric(data, job_id)
        elif 'commands' in topic or message_type == 'command':
            return process_command(data, job_id)
        else:
            return process_default(data, job_id)

    def process_alert(data, job_id):
        """Process alert messages with high priority."""
        severity = data.get('severity', 'info')
        message = data.get('message', 'No message')

        print(f"🚨 ALERT [{severity.upper()}]: {message}")

        # Send to monitoring system
        result = {
            "type": "alert_processed",
            "job_id": job_id,
            "severity": severity,
            "processed_at": datetime.now().isoformat(),
            "alert_id": data.get('alert_id')
        }

        return ReturnType(
            data=result,
            topic="monitoring/alerts",
            qos=2,  # High reliability for alerts
            retain=True,
            message_id=int(time.time()),
            timestamp=datetime.now(),
            job_id=job_id
        )

    def process_metric(data, job_id):
        """Process metric data for analytics."""
        metric_name = data.get('metric_name')
        value = data.get('value')
        timestamp = data.get('timestamp')

        print(f"📊 METRIC: {metric_name} = {value} at {timestamp}")

        result = {
            "type": "metric_processed",
            "job_id": job_id,
            "metric": metric_name,
            "value": value,
            "processed_at": datetime.now().isoformat()
        }

        return ReturnType(
            data=result,
            topic="analytics/metrics",
            qos=0,  # Lower reliability for metrics
            retain=False,
            message_id=int(time.time()),
            timestamp=datetime.now(),
            job_id=job_id
        )

    def process_command(data, job_id):
        """Process command messages."""
        command = data.get('command')
        params = data.get('parameters', {})

        print(f"⚡ COMMAND: {command} with params {params}")

        # Execute command (simplified)
        success = execute_command(command, params)

        result = {
            "type": "command_executed",
            "job_id": job_id,
            "command": command,
            "success": success,
            "executed_at": datetime.now().isoformat()
        }

        return ReturnType(
            data=result,
            topic="commands/results",
            qos=1,
            retain=False,
            message_id=int(time.time()),
            timestamp=datetime.now(),
            job_id=job_id
        )

    def process_default(data, job_id):
        """Default processing for unknown message types."""
        print(f"📝 DEFAULT: Processing job {job_id}")

        result = {
            "type": "default_processed",
            "job_id": job_id,
            "original_data": data,
            "processed_at": datetime.now().isoformat()
        }

        return ReturnType(
            data=result,
            topic="events/processed",
            qos=0,
            retain=False,
            message_id=int(time.time()),
            timestamp=datetime.now(),
            job_id=job_id
        )

    def execute_command(command, params):
        """Simulate command execution."""
        # Simplified command execution
        commands = {
            "restart": lambda: True,
            "status": lambda: True,
            "backup": lambda: params.get('target') is not None
        }

        handler = commands.get(command)
        return handler() if handler else False

    # Start processing
    await listener.run(multi_topic_processor)

if __name__ == "__main__":
    asyncio.run(multi_topic_example())</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_error_handling_and_resilience"><a class="anchor" href="#_error_handling_and_resilience"></a><a class="link" href="#_error_handling_and_resilience">11.2.2. Error Handling and Resilience</a></h4>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-python hljs" data-lang="python">import asyncio
import logging
from datetime import datetime, timedelta
from Listener import EventListener, EventListenerConfig, ReturnType, ConfigError

# Configure logging
logging.basicConfig(level=logging.INFO)
logger = logging.getLogger(__name__)

async def resilient_processor_example():
    """Example with comprehensive error handling and resilience."""

    config = EventListenerConfig(
        host="mqtt.example.com",
        port=1883,
        topic="tasks/+",
        auto_reconnect=True,
        reconnect_retries=10,
        reconnect_max_interval=60,
        max_jobs_in_memory=1000,
        job_cleanup_interval=1800  # 30 minutes
    )

    class ResilientProcessor:
        def __init__(self):
            self.error_count = 0
            self.last_error_time = None
            self.circuit_breaker_open = False
            self.max_errors = 5
            self.circuit_reset_time = timedelta(minutes=5)

        def check_circuit_breaker(self):
            """Simple circuit breaker implementation."""
            if self.circuit_breaker_open:
                if (datetime.now() - self.last_error_time) &gt; self.circuit_reset_time:
                    self.circuit_breaker_open = False
                    self.error_count = 0
                    logger.info("Circuit breaker reset")
                    return False
                return True
            return False

        def record_error(self):
            """Record error for circuit breaker."""
            self.error_count += 1
            self.last_error_time = datetime.now()

            if self.error_count &gt;= self.max_errors:
                self.circuit_breaker_open = True
                logger.warning("Circuit breaker opened due to errors")

        def record_success(self):
            """Record successful processing."""
            if self.error_count &gt; 0:
                self.error_count = max(0, self.error_count - 1)

        def process_message(self, data, job_id):
            """Process message with error handling."""
            try:
                # Check circuit breaker
                if self.check_circuit_breaker():
                    return self.create_error_response(
                        job_id,
                        "circuit_breaker",
                        "Circuit breaker is open"
                    )

                # Validate input
                if not self.validate_input(data):
                    return self.create_error_response(
                        job_id,
                        "validation_error",
                        "Invalid input data"
                    )

                # Process based on task type
                task_type = data.get('task_type', 'unknown')

                if task_type == 'data_processing':
                    result = self.process_data_task(data, job_id)
                elif task_type == 'file_operation':
                    result = self.process_file_task(data, job_id)
                elif task_type == 'api_call':
                    result = self.process_api_task(data, job_id)
                else:
                    result = self.process_unknown_task(data, job_id)

                # Record success
                self.record_success()
                return result

            except ValueError as e:
                logger.error(f"Validation error for job {job_id}: {e}")
                return self.create_error_response(job_id, "validation_error", str(e))

            except ConnectionError as e:
                logger.error(f"Connection error for job {job_id}: {e}")
                self.record_error()
                return self.create_error_response(job_id, "connection_error", str(e))

            except TimeoutError as e:
                logger.error(f"Timeout for job {job_id}: {e}")
                return self.create_error_response(job_id, "timeout_error", str(e))

            except Exception as e:
                logger.exception(f"Unexpected error for job {job_id}")
                self.record_error()
                return self.create_error_response(job_id, "processing_error", str(e))

        def validate_input(self, data):
            """Validate input data."""
            required_fields = ['task_type', 'job_id']
            return all(field in data for field in required_fields)

        def process_data_task(self, data, job_id):
            """Process data processing task."""
            input_data = data.get('input_data', {})
            operation = data.get('operation', 'transform')

            # Simulate processing
            if operation == 'transform':
                result_data = {key: str(value).upper() for key, value in input_data.items()}
            elif operation == 'aggregate':
                result_data = {"count": len(input_data), "keys": list(input_data.keys())}
            else:
                raise ValueError(f"Unknown operation: {operation}")

            return self.create_success_response(job_id, result_data, "data/results")

        def process_file_task(self, data, job_id):
            """Process file operation task."""
            file_path = data.get('file_path')
            operation = data.get('operation', 'read')

            if not file_path:
                raise ValueError("file_path is required for file operations")

            # Simulate file operation
            if operation == 'read':
                result = {"operation": "read", "file": file_path, "size": 1024}
            elif operation == 'write':
                result = {"operation": "write", "file": file_path, "success": True}
            else:
                raise ValueError(f"Unknown file operation: {operation}")

            return self.create_success_response(job_id, result, "files/results")

        def process_api_task(self, data, job_id):
            """Process API call task."""
            endpoint = data.get('endpoint')
            method = data.get('method', 'GET')

            if not endpoint:
                raise ValueError("endpoint is required for API calls")

            # Simulate API call (could raise ConnectionError, TimeoutError)
            result = {
                "endpoint": endpoint,
                "method": method,
                "status_code": 200,
                "response": {"success": True}
            }

            return self.create_success_response(job_id, result, "api/results")

        def process_unknown_task(self, data, job_id):
            """Process unknown task type."""
            logger.warning(f"Unknown task type for job {job_id}: {data.get('task_type')}")

            result = {
                "job_id": job_id,
                "status": "skipped",
                "reason": "unknown_task_type",
                "original_data": data
            }

            return ReturnType(
                data=result,
                topic="tasks/skipped",
                qos=0,
                retain=False,
                message_id=int(time.time()),
                timestamp=datetime.now(),
                job_id=job_id
            )

        def create_success_response(self, job_id, result_data, topic):
            """Create success response."""
            result = {
                "job_id": job_id,
                "status": "completed",
                "result": result_data,
                "processed_at": datetime.now().isoformat()
            }

            return ReturnType(
                data=result,
                topic=topic,
                qos=1,
                retain=False,
                message_id=int(time.time()),
                timestamp=datetime.now(),
                job_id=job_id
            )

        def create_error_response(self, job_id, error_type, error_message):
            """Create error response."""
            result = {
                "job_id": job_id,
                "status": "error",
                "error_type": error_type,
                "error_message": error_message,
                "failed_at": datetime.now().isoformat()
            }

            return ReturnType(
                data=result,
                topic="tasks/errors",
                qos=1,
                retain=True,  # Retain error messages
                message_id=int(time.time()),
                timestamp=datetime.now(),
                job_id=job_id
            )

    # Create processor and listener
    processor = ResilientProcessor()
    listener = EventListener(config)

    # Start processing
    logger.info("Starting resilient processor...")
    await listener.run(processor.process_message)

if __name__ == "__main__":
    asyncio.run(resilient_processor_example())</code></pre>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_real_world_use_cases"><a class="anchor" href="#_real_world_use_cases"></a><a class="link" href="#_real_world_use_cases">11.3. Real-World Use Cases</a></h3>
<div class="sect3">
<h4 id="_iot_data_processing"><a class="anchor" href="#_iot_data_processing"></a><a class="link" href="#_iot_data_processing">11.3.1. IoT Data Processing</a></h4>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-python hljs" data-lang="python">import asyncio
import json
from datetime import datetime
from Listener import EventListener, EventListenerConfig, ReturnType

async def iot_data_processor():
    """Process IoT sensor data from MQTT."""

    config = EventListenerConfig(
        host="iot-mqtt-broker.local",
        port=1883,
        topic="sensors/+/data",
        qos=1,
        max_jobs_in_memory=10000,
        job_cleanup_interval=3600
    )

    class IoTProcessor:
        def __init__(self):
            self.sensor_thresholds = {
                "temperature": {"min": -40, "max": 80, "critical": 75},
                "humidity": {"min": 0, "max": 100, "critical": 95},
                "pressure": {"min": 900, "max": 1100, "critical": 1050}
            }

        def process_sensor_data(self, data, job_id):
            """Process IoT sensor data."""
            sensor_id = data.get('sensor_id')
            sensor_type = data.get('sensor_type')
            value = data.get('value')
            timestamp = data.get('timestamp')

            if not all([sensor_id, sensor_type, value is not None]):
                return self.create_error("missing_fields", job_id)

            # Validate and process data
            processed_data = {
                "sensor_id": sensor_id,
                "sensor_type": sensor_type,
                "value": value,
                "timestamp": timestamp,
                "processed_at": datetime.now().isoformat(),
                "job_id": job_id
            }

            # Check thresholds
            alerts = self.check_thresholds(sensor_type, value, sensor_id)
            if alerts:
                processed_data["alerts"] = alerts
                self.send_alerts(alerts, sensor_id, job_id)

            # Store processed data
            return ReturnType(
                data=processed_data,
                topic=f"processed/sensors/{sensor_type}",
                qos=1,
                retain=False,
                message_id=int(time.time()),
                timestamp=datetime.now(),
                job_id=job_id
            )

        def check_thresholds(self, sensor_type, value, sensor_id):
            """Check if sensor value exceeds thresholds."""
            alerts = []
            thresholds = self.sensor_thresholds.get(sensor_type, {})

            if value &lt; thresholds.get("min", float('-inf')):
                alerts.append({
                    "type": "below_minimum",
                    "threshold": thresholds["min"],
                    "value": value
                })

            if value &gt; thresholds.get("max", float('inf')):
                alerts.append({
                    "type": "above_maximum",
                    "threshold": thresholds["max"],
                    "value": value
                })

            if value &gt; thresholds.get("critical", float('inf')):
                alerts.append({
                    "type": "critical",
                    "threshold": thresholds["critical"],
                    "value": value
                })

            return alerts

        def send_alerts(self, alerts, sensor_id, job_id):
            """Send alert notifications."""
            for alert in alerts:
                alert_data = {
                    "alert_id": f"alert-{job_id}-{len(alerts)}",
                    "sensor_id": sensor_id,
                    "alert_type": alert["type"],
                    "value": alert["value"],
                    "threshold": alert["threshold"],
                    "severity": "critical" if alert["type"] == "critical" else "warning",
                    "created_at": datetime.now().isoformat()
                }

                # Would send to alerts topic
                print(f"🚨 Alert: {alert_data}")

        def create_error(self, error_type, job_id):
            """Create error response."""
            return ReturnType(
                data={
                    "job_id": job_id,
                    "status": "error",
                    "error_type": error_type,
                    "error_time": datetime.now().isoformat()
                },
                topic="sensors/errors",
                qos=1,
                retain=True,
                message_id=int(time.time()),
                timestamp=datetime.now(),
                job_id=job_id
            )

    processor = IoTProcessor()
    listener = EventListener(config)

    print("Starting IoT data processor...")
    await listener.run(processor.process_sensor_data)

if __name__ == "__main__":
    asyncio.run(iot_data_processor())</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_distributed_task_processing"><a class="anchor" href="#_distributed_task_processing"></a><a class="link" href="#_distributed_task_processing">11.3.2. Distributed Task Processing</a></h4>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-python hljs" data-lang="python">import asyncio
import uuid
from datetime import datetime, timedelta
from Listener import EventListener, EventListenerConfig, ReturnType

async def distributed_task_processor():
    """Distributed task processing system."""

    config = EventListenerConfig(
        host="task-queue.example.com",
        port=1883,
        topic="tasks/queue",
        client_id=f"worker-{uuid.uuid4().hex[:8]}",
        qos=2,  # Exactly once delivery
        max_jobs_in_memory=500,
        job_cleanup_interval=1800
    )

    class TaskWorker:
        def __init__(self, worker_id):
            self.worker_id = worker_id
            self.processed_count = 0
            self.start_time = datetime.now()

        def process_task(self, data, job_id):
            """Process distributed task."""
            task_type = data.get('task_type')
            priority = data.get('priority', 'normal')
            created_at = data.get('created_at')

            # Calculate task age
            if created_at:
                task_age = datetime.now() - datetime.fromisoformat(created_at)
                if task_age &gt; timedelta(hours=1):
                    return self.create_expired_response(job_id, task_age)

            # Process based on task type
            if task_type == 'image_processing':
                return self.process_image_task(data, job_id)
            elif task_type == 'data_analysis':
                return self.process_analysis_task(data, job_id)
            elif task_type == 'report_generation':
                return self.process_report_task(data, job_id)
            else:
                return self.create_unknown_task_response(job_id, task_type)

        def process_image_task(self, data, job_id):
            """Process image processing task."""
            image_url = data.get('image_url')
            operations = data.get('operations', [])

            # Simulate image processing
            result = {
                "job_id": job_id,
                "task_type": "image_processing",
                "worker_id": self.worker_id,
                "image_url": image_url,
                "operations_performed": operations,
                "output_url": f"processed/{job_id}.jpg",
                "processing_time": "2.3s",
                "status": "completed"
            }

            self.processed_count += 1

            return ReturnType(
                data=result,
                topic="tasks/completed/image",
                qos=2,
                retain=False,
                message_id=int(time.time()),
                timestamp=datetime.now(),
                job_id=job_id
            )

        def process_analysis_task(self, data, job_id):
            """Process data analysis task."""
            dataset_id = data.get('dataset_id')
            analysis_type = data.get('analysis_type')

            # Simulate analysis
            result = {
                "job_id": job_id,
                "task_type": "data_analysis",
                "worker_id": self.worker_id,
                "dataset_id": dataset_id,
                "analysis_type": analysis_type,
                "results": {
                    "total_records": 10000,
                    "anomalies_detected": 23,
                    "confidence_score": 0.94
                },
                "status": "completed"
            }

            self.processed_count += 1

            return ReturnType(
                data=result,
                topic="tasks/completed/analysis",
                qos=2,
                retain=False,
                message_id=int(time.time()),
                timestamp=datetime.now(),
                job_id=job_id
            )

        def process_report_task(self, data, job_id):
            """Process report generation task."""
            report_type = data.get('report_type')
            parameters = data.get('parameters', {})

            # Simulate report generation
            result = {
                "job_id": job_id,
                "task_type": "report_generation",
                "worker_id": self.worker_id,
                "report_type": report_type,
                "report_url": f"reports/{job_id}.pdf",
                "parameters": parameters,
                "page_count": 15,
                "status": "completed"
            }

            self.processed_count += 1

            return ReturnType(
                data=result,
                topic="tasks/completed/reports",
                qos=2,
                retain=False,
                message_id=int(time.time()),
                timestamp=datetime.now(),
                job_id=job_id
            )

        def create_expired_response(self, job_id, task_age):
            """Handle expired tasks."""
            return ReturnType(
                data={
                    "job_id": job_id,
                    "status": "expired",
                    "worker_id": self.worker_id,
                    "task_age_seconds": task_age.total_seconds(),
                    "expired_at": datetime.now().isoformat()
                },
                topic="tasks/expired",
                qos=1,
                retain=False,
                message_id=int(time.time()),
                timestamp=datetime.now(),
                job_id=job_id
            )

        def create_unknown_task_response(self, job_id, task_type):
            """Handle unknown task types."""
            return ReturnType(
                data={
                    "job_id": job_id,
                    "status": "error",
                    "error_type": "unknown_task_type",
                    "task_type": task_type,
                    "worker_id": self.worker_id,
                    "error_time": datetime.now().isoformat()
                },
                topic="tasks/errors",
                qos=1,
                retain=True,
                message_id=int(time.time()),
                timestamp=datetime.now(),
                job_id=job_id
            )

        def get_worker_stats(self):
            """Get worker statistics."""
            uptime = datetime.now() - self.start_time
            return {
                "worker_id": self.worker_id,
                "processed_count": self.processed_count,
                "uptime_seconds": uptime.total_seconds(),
                "rate_per_hour": self.processed_count / (uptime.total_seconds() / 3600)
            }

    # Create worker and listener
    worker_id = f"worker-{uuid.uuid4().hex[:8]}"
    worker = TaskWorker(worker_id)
    listener = EventListener(config)

    print(f"Starting distributed task worker: {worker_id}")

    # Periodically log statistics
    async def log_stats():
        while True:
            await asyncio.sleep(300)  # Every 5 minutes
            stats = worker.get_worker_stats()
            print(f"Worker stats: {stats}")

    # Start both the listener and stats logging
    stats_task = asyncio.create_task(log_stats())

    try:
        await listener.run(worker.process_task)
    finally:
        stats_task.cancel()

if __name__ == "__main__":
    asyncio.run(distributed_task_processor())</code></pre>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_testing_examples"><a class="anchor" href="#_testing_examples"></a><a class="link" href="#_testing_examples">11.4. Testing Examples</a></h3>
<div class="sect3">
<h4 id="_unit_test_example_2"><a class="anchor" href="#_unit_test_example_2"></a><a class="link" href="#_unit_test_example_2">11.4.1. Unit Test Example</a></h4>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-python hljs" data-lang="python">import pytest
import asyncio
from unittest.mock import AsyncMock
from Listener import EventListener, EventListenerConfig, JobStatus

@pytest.mark.unit
@pytest.mark.asyncio
class TestExampleProcessor:
    """Example unit tests for custom processor."""

    async def test_simple_message_processing(self):
        """Test basic message processing functionality."""
        # Setup
        config = EventListenerConfig(
            host="test-host",
            port=1883,
            topic="test/topic"
        )
        listener = EventListener(config)

        # Mock MQTT client
        listener.client = AsyncMock()

        # Test data
        test_data = {
            "job_id": "test-001",
            "task_type": "test_task",
            "data": {"key": "value"}
        }

        # Define test processor
        def test_processor(data, job_id):
            return ReturnType(
                data={"processed": True, "job_id": job_id},
                topic="test/results",
                qos=0,
                retain=False,
                message_id=1,
                timestamp=datetime.now(),
                job_id=job_id
            )

        # Process message
        await listener._process_message(test_data)

        # Verify job was created and processed
        job_info = await listener.get_job_status("test-001")
        assert job_info is not None
        assert job_info.job_id == "test-001"

    async def test_error_handling(self):
        """Test error handling in processor."""
        config = EventListenerConfig()
        listener = EventListener(config)
        listener.client = AsyncMock()

        def error_processor(data, job_id):
            if data.get("should_fail"):
                raise ValueError("Test error")
            return ReturnType(
                data={"success": True},
                topic="test/results",
                qos=0,
                retain=False,
                message_id=1,
                timestamp=datetime.now(),
                job_id=job_id
            )

        # Test error condition
        error_data = {"job_id": "error-001", "should_fail": True}
        await listener._process_message(error_data)

        # Verify job failed
        job_info = await listener.get_job_status("error-001")
        assert job_info.status == JobStatus.FAILED
        assert "Test error" in job_info.error</code></pre>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_configuration_examples"><a class="anchor" href="#_configuration_examples"></a><a class="link" href="#_configuration_examples">11.5. Configuration Examples</a></h3>
<div class="sect3">
<h4 id="_production_configuration"><a class="anchor" href="#_production_configuration"></a><a class="link" href="#_production_configuration">11.5.1. Production Configuration</a></h4>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-python hljs" data-lang="python">"""Production configuration example."""

import os
from Listener import EventListenerConfig

def get_production_config():
    """Get production-ready configuration."""
    return EventListenerConfig(
        # Connection settings
        host=os.getenv("MQTT_HOST", "prod-mqtt.example.com"),
        port=int(os.getenv("MQTT_PORT", 8883)),
        username=os.getenv("MQTT_USERNAME"),
        password=os.getenv("MQTT_PASSWORD"),
        client_id=f"prod-listener-{os.getenv('HOSTNAME', 'unknown')}",

        # SSL/TLS settings
        cafile="/etc/ssl/certs/ca-certificates.crt",

        # Connection reliability
        auto_reconnect=True,
        reconnect_retries=10,
        reconnect_max_interval=60,
        keep_alive=60,

        # Topic settings
        topic="production/events",
        qos=1,
        error_topic="production/errors",
        results_topic="production/results",

        # Job management
        max_jobs_in_memory=10000,
        job_cleanup_interval=3600,  # 1 hour
        duplicate_action="reprocess",

        # Will message for monitoring
        will={
            "topic": "production/status",
            "message": "listener_offline",
            "qos": 1,
            "retain": True
        }
    )</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_development_configuration"><a class="anchor" href="#_development_configuration"></a><a class="link" href="#_development_configuration">11.5.2. Development Configuration</a></h4>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-python hljs" data-lang="python">"""Development configuration example."""

from Listener import EventListenerConfig

def get_development_config():
    """Get development configuration."""
    return EventListenerConfig(
        # Local development settings
        host="localhost",
        port=1883,
        username="dev",
        password="dev",
        client_id="dev-listener",

        # Development topics
        topic="dev/events",
        error_topic="dev/errors",
        results_topic="dev/results",

        # Faster feedback for development
        max_jobs_in_memory=1000,
        job_cleanup_interval=300,  # 5 minutes
        auto_reconnect=True,
        reconnect_retries=3,

        # Debug settings
        qos=0,  # Faster delivery
        retain=False
    )</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="performance"><a class="anchor" href="#performance"></a><a class="link" href="#performance">12. Performance Guide</a></h2>
<div class="sectionbody">
<div class="paragraph">
<p>Performance characteristics and optimization guidelines for the MQTT Event Listener.</p>
</div>
<div class="sect2">
<h3 id="_performance_metrics"><a class="anchor" href="#_performance_metrics"></a><a class="link" href="#_performance_metrics">12.1. Performance Metrics</a></h3>
<div class="sect3">
<h4 id="_baseline_performance"><a class="anchor" href="#_baseline_performance"></a><a class="link" href="#_baseline_performance">12.1.1. Baseline Performance</a></h4>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 20%;">
<col style="width: 40%;">
<col style="width: 20%;">
<col style="width: 20%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Metric</th>
<th class="tableblock halign-left valign-top">Description</th>
<th class="tableblock halign-left valign-top">Typical Value</th>
<th class="tableblock halign-left valign-top">Target</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Throughput</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Messages processed per second</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">100-1000 msg/s</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">&gt;100 msg/s</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Latency</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Message processing delay</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">&lt;100ms</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">&lt;500ms</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Memory Usage</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">RAM consumption per 1000 jobs</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">10-50 MB</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">&lt;100 MB</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>CPU Usage</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Processor utilization</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">5-15%</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">&lt;25%</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Connection Recovery</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Time to reconnect</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1-10 seconds</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">&lt;30 seconds</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect3">
<h4 id="_performance_factors"><a class="anchor" href="#_performance_factors"></a><a class="link" href="#_performance_factors">12.1.2. Performance Factors</a></h4>
<div class="sect4">
<h5 id="_message_size_impact"><a class="anchor" href="#_message_size_impact"></a><a class="link" href="#_message_size_impact">Message Size Impact</a></h5>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 20%;">
<col style="width: 40%;">
<col style="width: 20%;">
<col style="width: 20%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Message Size</th>
<th class="tableblock halign-left valign-top">Processing Time</th>
<th class="tableblock halign-left valign-top">Memory Impact</th>
<th class="tableblock halign-left valign-top">Throughput</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Small (&lt;1KB)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">&lt;10ms</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">~1KB per job</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">&gt;500 msg/s</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Medium (1-10KB)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">10-50ms</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">~5KB per job</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">200-500 msg/s</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Large (10-100KB)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">50-200ms</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">~50KB per job</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">50-200 msg/s</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Very Large (&gt;100KB)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">&gt;200ms</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">&gt;100KB per job</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">&lt;50 msg/s</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect4">
<h5 id="_processing_complexity"><a class="anchor" href="#_processing_complexity"></a><a class="link" href="#_processing_complexity">Processing Complexity</a></h5>
<div class="ulist">
<ul>
<li>
<p><strong>Simple operations</strong> (data transformation) - &lt;50ms</p>
</li>
<li>
<p><strong>I/O operations</strong> (file access, API calls) - 100-1000ms</p>
</li>
<li>
<p><strong>Complex calculations</strong> (data analysis) - 500-5000ms</p>
</li>
<li>
<p><strong>External dependencies</strong> (databases, services) - Variable</p>
</li>
</ul>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_optimization_strategies"><a class="anchor" href="#_optimization_strategies"></a><a class="link" href="#_optimization_strategies">12.2. Optimization Strategies</a></h3>
<div class="sect3">
<h4 id="_configuration_optimization"><a class="anchor" href="#_configuration_optimization"></a><a class="link" href="#_configuration_optimization">12.2.1. Configuration Optimization</a></h4>
<div class="sect4">
<h5 id="_memory_management_3"><a class="anchor" href="#_memory_management_3"></a><a class="link" href="#_memory_management_3">Memory Management</a></h5>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-python hljs" data-lang="python"># Optimized for high throughput
config = EventListenerConfig(
    max_jobs_in_memory=1000,      # Reduce memory usage
    job_cleanup_interval=300,     # More frequent cleanup (5 min)
    duplicate_action="skip"       # Avoid reprocessing
)

# Optimized for reliability
config = EventListenerConfig(
    max_jobs_in_memory=10000,     # Higher job retention
    job_cleanup_interval=3600,    # Less frequent cleanup (1 hour)
    duplicate_action="reprocess"  # Handle all messages
)</code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="_mqtt_settings"><a class="anchor" href="#_mqtt_settings"></a><a class="link" href="#_mqtt_settings">MQTT Settings</a></h5>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-python hljs" data-lang="python"># High performance settings
config = EventListenerConfig(
    qos=0,                       # Fastest delivery
    keep_alive=30,               # Shorter keepalive
    reconnect_retries=5,         # Quick reconnection
    reconnect_max_interval=30
)

# High reliability settings
config = EventListenerConfig(
    qos=2,                       # Guaranteed delivery
    keep_alive=60,               # Stable keepalive
    reconnect_retries=10,        # Persistent reconnection
    reconnect_max_interval=60
)</code></pre>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_processing_optimization"><a class="anchor" href="#_processing_optimization"></a><a class="link" href="#_processing_optimization">12.2.2. Processing Optimization</a></h4>
<div class="sect4">
<h5 id="_async_processing_2"><a class="anchor" href="#_async_processing_2"></a><a class="link" href="#_async_processing_2">Async Processing</a></h5>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-python hljs" data-lang="python">import asyncio
import aiohttp
from Listener import EventListener, ReturnType

async def optimized_async_processor(data, job_id):
    """High-performance async processor."""

    # Use connection pooling
    async with aiohttp.ClientSession() as session:
        # Parallel API calls
        tasks = [
            fetch_data(session, data['endpoint1']),
            fetch_data(session, data['endpoint2']),
            fetch_data(session, data['endpoint3'])
        ]

        results = await asyncio.gather(*tasks, return_exceptions=True)

    # Process results
    processed_data = combine_results(results)

    return ReturnType(
        data=processed_data,
        topic="results/optimized",
        qos=0,
        retain=False,
        message_id=int(time.time()),
        timestamp=datetime.now(),
        job_id=job_id
    )

async def fetch_data(session, endpoint):
    """Optimized data fetching with timeout."""
    timeout = aiohttp.ClientTimeout(total=5)
    async with session.get(endpoint, timeout=timeout) as response:
        return await response.json()</code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="_batch_processing_2"><a class="anchor" href="#_batch_processing_2"></a><a class="link" href="#_batch_processing_2">Batch Processing</a></h5>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-python hljs" data-lang="python">class BatchProcessor:
    """High-throughput batch processor."""

    def __init__(self, batch_size=50, flush_interval=10.0):
        self.batch_size = batch_size
        self.flush_interval = flush_interval
        self.batch = []
        self.last_flush = time.time()

    async def process_message(self, data, job_id):
        """Add to batch and process when ready."""
        self.batch.append((data, job_id))

        # Process batch if conditions met
        if (len(self.batch) &gt;= self.batch_size or
            time.time() - self.last_flush &gt; self.flush_interval):
            await self.flush_batch()

    async def flush_batch(self):
        """Process entire batch efficiently."""
        if not self.batch:
            return

        batch_data = [item[0] for item in self.batch]
        job_ids = [item[1] for item in self.batch]

        # Bulk processing
        results = await process_batch_efficiently(batch_data)

        # Publish results
        for result, job_id in zip(results, job_ids):
            await publish_result(result, job_id)

        # Reset batch
        self.batch = []
        self.last_flush = time.time()</code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="_caching_strategy"><a class="anchor" href="#_caching_strategy"></a><a class="link" href="#_caching_strategy">Caching Strategy</a></h5>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-python hljs" data-lang="python">import functools
import time
from typing import Dict, Any

class CachedProcessor:
    """Processor with intelligent caching."""

    def __init__(self, cache_ttl=300):  # 5 minutes
        self.cache: Dict[str, tuple] = {}
        self.cache_ttl = cache_ttl

    def process_with_cache(self, data: Dict[str, Any], job_id: str):
        """Process with caching for expensive operations."""

        # Create cache key from relevant data
        cache_key = self.create_cache_key(data)

        # Check cache
        cached_result = self.get_cached_result(cache_key)
        if cached_result:
            return self.create_cached_response(cached_result, job_id)

        # Process and cache
        result = self.expensive_processing(data)
        self.cache_result(cache_key, result)

        return self.create_response(result, job_id)

    def create_cache_key(self, data: Dict[str, Any]) -&gt; str:
        """Create deterministic cache key."""
        relevant_fields = ['input_data', 'parameters', 'operation_type']
        key_data = {k: data.get(k) for k in relevant_fields if k in data}
        return hashlib.md5(str(sorted(key_data.items())).encode()).hexdigest()

    def get_cached_result(self, cache_key: str):
        """Retrieve from cache if valid."""
        if cache_key in self.cache:
            result, timestamp = self.cache[cache_key]
            if time.time() - timestamp &lt; self.cache_ttl:
                return result
            else:
                del self.cache[cache_key]  # Expired
        return None

    def cache_result(self, cache_key: str, result):
        """Store in cache with timestamp."""
        self.cache[cache_key] = (result, time.time())

        # Cleanup old entries periodically
        if len(self.cache) &gt; 1000:
            self.cleanup_cache()

    def cleanup_cache(self):
        """Remove expired cache entries."""
        current_time = time.time()
        expired_keys = [
            key for key, (_, timestamp) in self.cache.items()
            if current_time - timestamp &gt; self.cache_ttl
        ]
        for key in expired_keys:
            del self.cache[key]</code></pre>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_system_level_optimization"><a class="anchor" href="#_system_level_optimization"></a><a class="link" href="#_system_level_optimization">12.2.3. System-Level Optimization</a></h4>
<div class="sect4">
<h5 id="_memory_profiling"><a class="anchor" href="#_memory_profiling"></a><a class="link" href="#_memory_profiling">Memory Profiling</a></h5>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-python hljs" data-lang="python">import psutil
import gc
import asyncio

class PerformanceMonitor:
    """Monitor system performance."""

    def __init__(self, listener):
        self.listener = listener
        self.stats = {
            'messages_processed': 0,
            'processing_times': [],
            'memory_samples': [],
            'error_count': 0
        }

    async def monitor_performance(self):
        """Continuous performance monitoring."""
        while True:
            await self.collect_metrics()
            await asyncio.sleep(60)  # Every minute

    async def collect_metrics(self):
        """Collect performance metrics."""
        # Memory usage
        process = psutil.Process()
        memory_mb = process.memory_info().rss / 1024 / 1024
        self.stats['memory_samples'].append(memory_mb)

        # Job statistics
        all_jobs = await self.listener.get_all_jobs()
        running_jobs = await self.listener.get_running_jobs()

        # Performance report
        if len(self.stats['memory_samples']) % 10 == 0:  # Every 10 minutes
            await self.generate_report()

    async def generate_report(self):
        """Generate performance report."""
        memory_avg = sum(self.stats['memory_samples'][-10:]) / 10
        processing_avg = sum(self.stats['processing_times'][-100:]) / 100 if self.stats['processing_times'] else 0

        print(f"Performance Report:")
        print(f"  Average Memory: {memory_avg:.1f} MB")
        print(f"  Average Processing Time: {processing_avg:.3f}s")
        print(f"  Messages Processed: {self.stats['messages_processed']}")
        print(f"  Error Rate: {self.stats['error_count'] / max(1, self.stats['messages_processed']) * 100:.1f}%")</code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="_resource_management"><a class="anchor" href="#_resource_management"></a><a class="link" href="#_resource_management">Resource Management</a></h5>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-python hljs" data-lang="python">import resource
import signal

def setup_resource_limits():
    """Configure system resource limits."""

    # Memory limit (1GB)
    resource.setrlimit(resource.RLIMIT_AS, (1024 * 1024 * 1024, -1))

    # File descriptor limit
    resource.setrlimit(resource.RLIMIT_NOFILE, (1024, 4096))

    # CPU time limit (if needed)
    # resource.setrlimit(resource.RLIMIT_CPU, (3600, -1))  # 1 hour

def setup_graceful_shutdown(listener):
    """Setup graceful shutdown handling."""

    def signal_handler(signum, frame):
        print(f"Received signal {signum}, initiating graceful shutdown...")
        listener.stop()

    signal.signal(signal.SIGINT, signal_handler)
    signal.signal(signal.SIGTERM, signal_handler)</code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_performance_monitoring"><a class="anchor" href="#_performance_monitoring"></a><a class="link" href="#_performance_monitoring">12.3. Performance Monitoring</a></h3>
<div class="sect3">
<h4 id="_built_in_metrics"><a class="anchor" href="#_built_in_metrics"></a><a class="link" href="#_built_in_metrics">12.3.1. Built-in Metrics</a></h4>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-python hljs" data-lang="python">class MetricsCollector:
    """Collect performance metrics during operation."""

    def __init__(self):
        self.start_time = time.time()
        self.message_count = 0
        self.processing_times = []
        self.error_count = 0

    def record_processing_time(self, duration: float):
        """Record message processing time."""
        self.processing_times.append(duration)
        self.message_count += 1

        # Keep only recent measurements
        if len(self.processing_times) &gt; 1000:
            self.processing_times = self.processing_times[-500:]

    def record_error(self):
        """Record processing error."""
        self.error_count += 1

    def get_metrics(self) -&gt; Dict[str, Any]:
        """Get current performance metrics."""
        uptime = time.time() - self.start_time

        if self.processing_times:
            avg_time = sum(self.processing_times) / len(self.processing_times)
            p95_time = sorted(self.processing_times)[int(len(self.processing_times) * 0.95)]
        else:
            avg_time = p95_time = 0

        return {
            'uptime_seconds': uptime,
            'messages_processed': self.message_count,
            'messages_per_second': self.message_count / uptime if uptime &gt; 0 else 0,
            'average_processing_time': avg_time,
            'p95_processing_time': p95_time,
            'error_count': self.error_count,
            'error_rate': self.error_count / max(1, self.message_count)
        }

# Integration with EventListener
def instrumented_processor(metrics: MetricsCollector):
    """Create instrumented processor."""

    def processor(data, job_id):
        start_time = time.time()

        try:
            result = your_processing_logic(data, job_id)
            return result
        except Exception as e:
            metrics.record_error()
            raise
        finally:
            processing_time = time.time() - start_time
            metrics.record_processing_time(processing_time)

    return processor</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_benchmarking"><a class="anchor" href="#_benchmarking"></a><a class="link" href="#_benchmarking">12.3.2. Benchmarking</a></h4>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-python hljs" data-lang="python">import asyncio
import time
from typing import List

async def benchmark_throughput(listener, message_count=1000):
    """Benchmark message processing throughput."""

    processed_jobs = []

    def benchmark_processor(data, job_id):
        """Simple processor for benchmarking."""
        processed_jobs.append(job_id)
        return ReturnType(
            data={"processed": True, "job_id": job_id},
            topic="benchmark/results",
            qos=0,
            retain=False,
            message_id=1,
            timestamp=datetime.now(),
            job_id=job_id
        )

    # Generate test messages
    test_messages = [
        {"job_id": f"benchmark-{i}", "data": f"test-data-{i}"}
        for i in range(message_count)
    ]

    # Measure processing time
    start_time = time.time()

    # Process messages
    for message in test_messages:
        await listener._process_message(message)

    # Wait for completion
    while len(processed_jobs) &lt; message_count:
        await asyncio.sleep(0.1)

    end_time = time.time()
    duration = end_time - start_time
    throughput = message_count / duration

    print(f"Benchmark Results:")
    print(f"  Messages: {message_count}")
    print(f"  Duration: {duration:.2f} seconds")
    print(f"  Throughput: {throughput:.1f} messages/second")

    return throughput

async def benchmark_memory_usage(listener, job_count=10000):
    """Benchmark memory usage with many jobs."""

    import psutil
    process = psutil.Process()

    initial_memory = process.memory_info().rss / 1024 / 1024

    # Create many jobs
    for i in range(job_count):
        job_data = {"job_id": f"memory-test-{i}", "data": f"data-{i}"}
        await listener._create_job(f"memory-test-{i}", job_data)

    peak_memory = process.memory_info().rss / 1024 / 1024
    memory_per_job = (peak_memory - initial_memory) / job_count * 1024  # KB per job

    print(f"Memory Benchmark:")
    print(f"  Jobs Created: {job_count}")
    print(f"  Initial Memory: {initial_memory:.1f} MB")
    print(f"  Peak Memory: {peak_memory:.1f} MB")
    print(f"  Memory per Job: {memory_per_job:.2f} KB")

    return memory_per_job</code></pre>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_performance_tuning_guidelines"><a class="anchor" href="#_performance_tuning_guidelines"></a><a class="link" href="#_performance_tuning_guidelines">12.4. Performance Tuning Guidelines</a></h3>
<div class="sect3">
<h4 id="_for_high_throughput"><a class="anchor" href="#_for_high_throughput"></a><a class="link" href="#_for_high_throughput">12.4.1. For High Throughput</a></h4>
<div class="olist arabic">
<ol class="arabic">
<li>
<p><strong>Use QoS 0</strong> for maximum speed</p>
</li>
<li>
<p><strong>Reduce job retention</strong> time and count</p>
</li>
<li>
<p><strong>Implement batch processing</strong> for multiple messages</p>
</li>
<li>
<p><strong>Use async operations</strong> for I/O</p>
</li>
<li>
<p><strong>Minimize logging</strong> in production</p>
</li>
<li>
<p><strong>Optimize processing function</strong> complexity</p>
</li>
</ol>
</div>
</div>
<div class="sect3">
<h4 id="_for_high_reliability"><a class="anchor" href="#_for_high_reliability"></a><a class="link" href="#_for_high_reliability">12.4.2. For High Reliability</a></h4>
<div class="olist arabic">
<ol class="arabic">
<li>
<p><strong>Use QoS 1 or 2</strong> for guaranteed delivery</p>
</li>
<li>
<p><strong>Increase job retention</strong> for audit trails</p>
</li>
<li>
<p><strong>Implement retry mechanisms</strong> in processing</p>
</li>
<li>
<p><strong>Use comprehensive error handling</strong></p>
</li>
<li>
<p><strong>Enable detailed logging</strong> for debugging</p>
</li>
<li>
<p><strong>Configure appropriate timeouts</strong></p>
</li>
</ol>
</div>
</div>
<div class="sect3">
<h4 id="_for_low_latency"><a class="anchor" href="#_for_low_latency"></a><a class="link" href="#_for_low_latency">12.4.3. For Low Latency</a></h4>
<div class="olist arabic">
<ol class="arabic">
<li>
<p><strong>Minimize processing</strong> function complexity</p>
</li>
<li>
<p><strong>Use local resources</strong> over network calls</p>
</li>
<li>
<p><strong>Implement caching</strong> for repeated operations</p>
</li>
<li>
<p><strong>Reduce serialization</strong> overhead</p>
</li>
<li>
<p><strong>Optimize network</strong> connectivity to broker</p>
</li>
<li>
<p><strong>Use faster storage</strong> for any file operations</p>
</li>
</ol>
</div>
</div>
<div class="sect3">
<h4 id="_for_low_memory_usage"><a class="anchor" href="#_for_low_memory_usage"></a><a class="link" href="#_for_low_memory_usage">12.4.4. For Low Memory Usage</a></h4>
<div class="olist arabic">
<ol class="arabic">
<li>
<p><strong>Reduce <code>max_jobs_in_memory</code></strong> setting</p>
</li>
<li>
<p><strong>Decrease <code>job_cleanup_interval</code></strong> for frequent cleanup</p>
</li>
<li>
<p><strong>Use <code>duplicate_action="skip"</code></strong> to avoid reprocessing</p>
</li>
<li>
<p><strong>Implement result streaming</strong> instead of accumulation</p>
</li>
<li>
<p><strong>Use lazy loading</strong> for large data structures</p>
</li>
<li>
<p><strong>Profile memory usage</strong> regularly</p>
</li>
</ol>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="security"><a class="anchor" href="#security"></a><a class="link" href="#security">13. Security Guide</a></h2>
<div class="sectionbody">
<div class="paragraph">
<p>Security considerations and best practices for the MQTT Event Listener.</p>
</div>
<div class="sect2">
<h3 id="_security_overview"><a class="anchor" href="#_security_overview"></a><a class="link" href="#_security_overview">13.1. Security Overview</a></h3>
<div class="sect3">
<h4 id="_security_layers_2"><a class="anchor" href="#_security_layers_2"></a><a class="link" href="#_security_layers_2">13.1.1. Security Layers</a></h4>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 20%;">
<col style="width: 60%;">
<col style="width: 20%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Layer</th>
<th class="tableblock halign-left valign-top">Components</th>
<th class="tableblock halign-left valign-top">Status</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Network</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">SSL/TLS, Authentication, Authorization</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">✅ Implemented</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Application</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Input validation, Error handling</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">✅ Implemented</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Data</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Configuration protection, Memory safety</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">✅ Implemented</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Process</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Resource limits, Secure logging</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">✅ Implemented</p></td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="sect2">
<h3 id="_network_security"><a class="anchor" href="#_network_security"></a><a class="link" href="#_network_security">13.2. Network Security</a></h3>
<div class="sect3">
<h4 id="_ssltls_configuration_2"><a class="anchor" href="#_ssltls_configuration_2"></a><a class="link" href="#_ssltls_configuration_2">13.2.1. SSL/TLS Configuration</a></h4>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-python hljs" data-lang="python"># Secure SSL configuration
config = EventListenerConfig(
    host="secure-mqtt.example.com",
    port=8883,  # SSL port

    # Certificate validation
    cafile="/etc/ssl/certs/ca.crt",
    capath="/etc/ssl/certs/",

    # Authentication
    username=os.getenv("MQTT_USERNAME"),
    password=os.getenv("MQTT_PASSWORD")
)</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_authentication_best_practices"><a class="anchor" href="#_authentication_best_practices"></a><a class="link" href="#_authentication_best_practices">13.2.2. Authentication Best Practices</a></h4>
<div class="ulist">
<ul>
<li>
<p><strong>Use environment variables</strong> for credentials</p>
</li>
<li>
<p><strong>Rotate passwords</strong> regularly</p>
</li>
<li>
<p><strong>Use strong authentication</strong> (certificates when possible)</p>
</li>
<li>
<p><strong>Limit connection privileges</strong> to minimum required</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-python hljs" data-lang="python"># Secure credential handling
import os
from getpass import getpass

def get_secure_config():
    return EventListenerConfig(
        username=os.getenv("MQTT_USER"),
        password=os.getenv("MQTT_PASS") or getpass("MQTT Password: "),
        cafile=os.getenv("MQTT_CA_FILE", "/etc/ssl/ca.crt")
    )</code></pre>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_application_security"><a class="anchor" href="#_application_security"></a><a class="link" href="#_application_security">13.3. Application Security</a></h3>
<div class="sect3">
<h4 id="_input_validation"><a class="anchor" href="#_input_validation"></a><a class="link" href="#_input_validation">13.3.1. Input Validation</a></h4>
<div class="ulist">
<ul>
<li>
<p><strong>TOML syntax validation</strong> prevents injection attacks</p>
</li>
<li>
<p><strong>Message size limits</strong> prevent DoS attacks</p>
</li>
<li>
<p><strong>Configuration validation</strong> ensures safe operation</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-python hljs" data-lang="python"># Secure message processing
def secure_processor(data, job_id):
    # Validate input size
    if len(str(data)) &gt; 1024 * 1024:  # 1MB limit
        raise ValueError("Message too large")

    # Validate required fields
    required = ['job_id', 'task_type']
    if not all(field in data for field in required):
        raise ValueError("Missing required fields")

    # Sanitize data
    sanitized_data = sanitize_input(data)

    return process_safely(sanitized_data, job_id)</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_error_handling_security"><a class="anchor" href="#_error_handling_security"></a><a class="link" href="#_error_handling_security">13.3.2. Error Handling Security</a></h4>
<div class="ulist">
<ul>
<li>
<p><strong>No sensitive data</strong> in error messages</p>
</li>
<li>
<p><strong>Sanitized logging</strong> to prevent information disclosure</p>
</li>
<li>
<p><strong>Controlled error responses</strong></p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-python hljs" data-lang="python">def secure_error_handler(job_id, error):
    # Log detailed error internally
    logger.error(f"Job {job_id} failed: {error}", extra={'job_id': job_id})

    # Return sanitized error
    return ReturnType(
        data={
            "job_id": job_id,
            "status": "error",
            "error_code": "PROCESSING_ERROR",
            # No sensitive details exposed
        },
        topic="errors",
        qos=1,
        retain=False,
        message_id=int(time.time()),
        timestamp=datetime.now(),
        job_id=job_id
    )</code></pre>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_configuration_security"><a class="anchor" href="#_configuration_security"></a><a class="link" href="#_configuration_security">13.4. Configuration Security</a></h3>
<div class="sect3">
<h4 id="_sensitive_data_protection"><a class="anchor" href="#_sensitive_data_protection"></a><a class="link" href="#_sensitive_data_protection">13.4.1. Sensitive Data Protection</a></h4>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-python hljs" data-lang="python"># Secure configuration management
class SecureConfig:
    def __init__(self):
        self.sensitive_fields = {'password', 'token', 'key', 'secret'}

    def sanitize_config_for_logging(self, config_dict):
        """Remove sensitive data from logs."""
        sanitized = {}
        for key, value in config_dict.items():
            if any(sensitive in key.lower() for sensitive in self.sensitive_fields):
                sanitized[key] = "***REDACTED***"
            else:
                sanitized[key] = value
        return sanitized</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_environment_security"><a class="anchor" href="#_environment_security"></a><a class="link" href="#_environment_security">13.4.2. Environment Security</a></h4>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash"># Secure environment setup
export MQTT_HOST="secure-broker.internal"
export MQTT_PORT="8883"
export MQTT_USERNAME="service-account"
export MQTT_PASSWORD="$(cat /secure/mqtt.pass)"
export MQTT_CA_FILE="/etc/ssl/internal-ca.crt"

# Restrict environment file access
chmod 600 ~/.env</code></pre>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_process_security"><a class="anchor" href="#_process_security"></a><a class="link" href="#_process_security">13.5. Process Security</a></h3>
<div class="sect3">
<h4 id="_resource_limits"><a class="anchor" href="#_resource_limits"></a><a class="link" href="#_resource_limits">13.5.1. Resource Limits</a></h4>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-python hljs" data-lang="python"># Security-focused configuration
config = EventListenerConfig(
    max_jobs_in_memory=1000,     # Limit memory usage
    job_cleanup_interval=300,    # Frequent cleanup
    connect_timeout=30,          # Prevent hanging connections
    reconnect_retries=5          # Limit retry attempts
)</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_secure_logging"><a class="anchor" href="#_secure_logging"></a><a class="link" href="#_secure_logging">13.5.2. Secure Logging</a></h4>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-python hljs" data-lang="python">import logging
import re

class SecureFormatter(logging.Formatter):
    """Logging formatter that sanitizes sensitive data."""

    def __init__(self):
        super().__init__(
            '%(asctime)s - %(name)s - %(levelname)s - %(message)s'
        )
        # Patterns to redact
        self.patterns = [
            (re.compile(r'password["\']?\s*[:=]\s*["\']?([^"\'\s]+)', re.I), 'password=***'),
            (re.compile(r'token["\']?\s*[:=]\s*["\']?([^"\'\s]+)', re.I), 'token=***'),
            (re.compile(r'key["\']?\s*[:=]\s*["\']?([^"\'\s]+)', re.I), 'key=***'),
        ]

    def format(self, record):
        msg = super().format(record)

        # Sanitize sensitive data
        for pattern, replacement in self.patterns:
            msg = pattern.sub(replacement, msg)

        return msg

# Configure secure logging
handler = logging.StreamHandler()
handler.setFormatter(SecureFormatter())
logger = logging.getLogger('Listener')
logger.addHandler(handler)</code></pre>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_security_monitoring"><a class="anchor" href="#_security_monitoring"></a><a class="link" href="#_security_monitoring">13.6. Security Monitoring</a></h3>
<div class="sect3">
<h4 id="_threat_detection"><a class="anchor" href="#_threat_detection"></a><a class="link" href="#_threat_detection">13.6.1. Threat Detection</a></h4>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-python hljs" data-lang="python">class SecurityMonitor:
    def __init__(self):
        self.failed_attempts = {}
        self.suspicious_patterns = [
            'script', 'exec', 'eval', 'import',
            '../', '..\\', '/etc/', 'cmd.exe'
        ]

    def check_message_security(self, data, job_id):
        """Check message for security threats."""
        message_str = str(data).lower()

        # Check for suspicious patterns
        for pattern in self.suspicious_patterns:
            if pattern in message_str:
                self.log_security_event(
                    f"Suspicious pattern '{pattern}' in job {job_id}"
                )
                return False

        # Check message size
        if len(message_str) &gt; 100000:  # 100KB
            self.log_security_event(f"Oversized message in job {job_id}")
            return False

        return True

    def log_security_event(self, event):
        """Log security events for monitoring."""
        logger.warning(f"SECURITY: {event}")</code></pre>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_compliance_and_auditing"><a class="anchor" href="#_compliance_and_auditing"></a><a class="link" href="#_compliance_and_auditing">13.7. Compliance and Auditing</a></h3>
<div class="sect3">
<h4 id="_audit_logging"><a class="anchor" href="#_audit_logging"></a><a class="link" href="#_audit_logging">13.7.1. Audit Logging</a></h4>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-python hljs" data-lang="python">class AuditLogger:
    def __init__(self):
        self.audit_logger = logging.getLogger('audit')

    def log_job_processing(self, job_id, status, user_context=None):
        """Log job processing for audit trail."""
        audit_data = {
            'timestamp': datetime.now().isoformat(),
            'job_id': job_id,
            'status': status,
            'user_context': user_context,
            'service': 'mqtt-event-listener'
        }

        self.audit_logger.info(json.dumps(audit_data))</code></pre>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_security_best_practices"><a class="anchor" href="#_security_best_practices"></a><a class="link" href="#_security_best_practices">13.8. Security Best Practices</a></h3>
<div class="sect3">
<h4 id="_deployment_security"><a class="anchor" href="#_deployment_security"></a><a class="link" href="#_deployment_security">13.8.1. Deployment Security</a></h4>
<div class="olist arabic">
<ol class="arabic">
<li>
<p><strong>Use SSL/TLS</strong> for all MQTT connections</p>
</li>
<li>
<p><strong>Store credentials</strong> in environment variables or secure vaults</p>
</li>
<li>
<p><strong>Limit network access</strong> to MQTT broker</p>
</li>
<li>
<p><strong>Run with minimal privileges</strong> (non-root user)</p>
</li>
<li>
<p><strong>Monitor for security events</strong> and anomalies</p>
</li>
<li>
<p><strong>Keep dependencies updated</strong> for security patches</p>
</li>
<li>
<p><strong>Use internal networks</strong> when possible</p>
</li>
<li>
<p><strong>Implement logging</strong> for security monitoring</p>
</li>
</ol>
</div>
</div>
<div class="sect3">
<h4 id="_development_security"><a class="anchor" href="#_development_security"></a><a class="link" href="#_development_security">13.8.2. Development Security</a></h4>
<div class="olist arabic">
<ol class="arabic">
<li>
<p><strong>Code review</strong> all changes for security implications</p>
</li>
<li>
<p><strong>Use static analysis</strong> tools (bandit) for vulnerability detection</p>
</li>
<li>
<p><strong>Test security controls</strong> with unit tests</p>
</li>
<li>
<p><strong>Follow secure coding</strong> practices</p>
</li>
<li>
<p><strong>Validate all inputs</strong> from external sources</p>
</li>
<li>
<p><strong>Handle errors</strong> without exposing sensitive information</p>
</li>
</ol>
</div>
</div>
<div class="sect3">
<h4 id="_operational_security"><a class="anchor" href="#_operational_security"></a><a class="link" href="#_operational_security">13.8.3. Operational Security</a></h4>
<div class="olist arabic">
<ol class="arabic">
<li>
<p><strong>Regular security assessments</strong> of the deployment</p>
</li>
<li>
<p><strong>Monitor logs</strong> for suspicious activity</p>
</li>
<li>
<p><strong>Rotate credentials</strong> periodically</p>
</li>
<li>
<p><strong>Update certificates</strong> before expiration</p>
</li>
<li>
<p><strong>Backup and test</strong> recovery procedures</p>
</li>
<li>
<p><strong>Document security procedures</strong> for incident response</p>
</li>
</ol>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_security_checklist"><a class="anchor" href="#_security_checklist"></a><a class="link" href="#_security_checklist">13.9. Security Checklist</a></h3>
<div class="sect3">
<h4 id="_pre_deployment"><a class="anchor" href="#_pre_deployment"></a><a class="link" href="#_pre_deployment">13.9.1. Pre-Deployment</a></h4>
<div class="ulist checklist">
<ul class="checklist">
<li>
<p><i class="fa fa-square-o"></i> SSL/TLS properly configured</p>
</li>
<li>
<p><i class="fa fa-square-o"></i> Credentials stored securely</p>
</li>
<li>
<p><i class="fa fa-square-o"></i> Input validation implemented</p>
</li>
<li>
<p><i class="fa fa-square-o"></i> Error handling sanitized</p>
</li>
<li>
<p><i class="fa fa-square-o"></i> Logging configured securely</p>
</li>
<li>
<p><i class="fa fa-square-o"></i> Resource limits set</p>
</li>
<li>
<p><i class="fa fa-square-o"></i> Security monitoring enabled</p>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="_regular_maintenance"><a class="anchor" href="#_regular_maintenance"></a><a class="link" href="#_regular_maintenance">13.9.2. Regular Maintenance</a></h4>
<div class="ulist checklist">
<ul class="checklist">
<li>
<p><i class="fa fa-square-o"></i> Dependencies updated</p>
</li>
<li>
<p><i class="fa fa-square-o"></i> Certificates renewed</p>
</li>
<li>
<p><i class="fa fa-square-o"></i> Credentials rotated</p>
</li>
<li>
<p><i class="fa fa-square-o"></i> Logs reviewed for threats</p>
</li>
<li>
<p><i class="fa fa-square-o"></i> Performance monitoring</p>
</li>
<li>
<p><i class="fa fa-square-o"></i> Security assessments</p>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="_incident_response"><a class="anchor" href="#_incident_response"></a><a class="link" href="#_incident_response">13.9.3. Incident Response</a></h4>
<div class="ulist checklist">
<ul class="checklist">
<li>
<p><i class="fa fa-square-o"></i> Contact procedures documented</p>
</li>
<li>
<p><i class="fa fa-square-o"></i> Log collection automated</p>
</li>
<li>
<p><i class="fa fa-square-o"></i> Service shutdown procedures</p>
</li>
<li>
<p><i class="fa fa-square-o"></i> Recovery procedures tested</p>
</li>
<li>
<p><i class="fa fa-square-o"></i> Communication plan ready</p>
</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="troubleshooting"><a class="anchor" href="#troubleshooting"></a><a class="link" href="#troubleshooting">14. Troubleshooting Guide</a></h2>
<div class="sectionbody">
<div class="paragraph">
<p>Common issues and solutions for the MQTT Event Listener.</p>
</div>
<div class="sect2">
<h3 id="_installation_issues"><a class="anchor" href="#_installation_issues"></a><a class="link" href="#_installation_issues">14.1. Installation Issues</a></h3>
<div class="sect3">
<h4 id="_git_authentication_errors"><a class="anchor" href="#_git_authentication_errors"></a><a class="link" href="#_git_authentication_errors">14.1.1. Git Authentication Errors</a></h4>
<div class="paragraph">
<p><strong>Problem:</strong> Cannot clone repository or install from git.</p>
</div>
<div class="paragraph">
<p><strong>Symptoms:</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-text hljs" data-lang="text">fatal: Authentication failed
Permission denied (publickey)</code></pre>
</div>
</div>
<div class="paragraph">
<p><strong>Solutions:</strong></p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p><strong>Check repository access:</strong></p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">git ls-remote https://github.com/ed-00/Mqtt-client.git</code></pre>
</div>
</div>
</li>
<li>
<p><strong>Configure Git credentials:</strong></p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">git config --global user.name "Your Name"
git config --global user.email "your.email@example.com"</code></pre>
</div>
</div>
</li>
<li>
<p><strong>Use SSH key authentication:</strong></p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">ssh-keygen -t rsa -b 4096 -C "your.email@example.com"
# Add public key to your Git provider</code></pre>
</div>
</div>
</li>
<li>
<p><strong>Contact your administrator</strong> for repository access</p>
</li>
</ol>
</div>
</div>
<div class="sect3">
<h4 id="_python_version_issues"><a class="anchor" href="#_python_version_issues"></a><a class="link" href="#_python_version_issues">14.1.2. Python Version Issues</a></h4>
<div class="paragraph">
<p><strong>Problem:</strong> Installation fails due to Python version incompatibility.</p>
</div>
<div class="paragraph">
<p><strong>Symptoms:</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-text hljs" data-lang="text">ERROR: Package requires Python '&gt;=3.8' but the running Python is 3.7</code></pre>
</div>
</div>
<div class="paragraph">
<p><strong>Solutions:</strong></p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p><strong>Check Python version:</strong></p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">python --version
python3 --version</code></pre>
</div>
</div>
</li>
<li>
<p><strong>Use Python 3.8 or later:</strong></p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash"># Install Python 3.8+ using package manager
sudo apt update &amp;&amp; sudo apt install python3.8

# Or use pyenv
pyenv install 3.8.10
pyenv local 3.8.10</code></pre>
</div>
</div>
</li>
<li>
<p><strong>Use virtual environment:</strong></p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">python3.8 -m venv mqtt-env
source mqtt-env/bin/activate
pip install git+{link-repo}.git</code></pre>
</div>
</div>
</li>
</ol>
</div>
</div>
<div class="sect3">
<h4 id="_dependency_conflicts"><a class="anchor" href="#_dependency_conflicts"></a><a class="link" href="#_dependency_conflicts">14.1.3. Dependency Conflicts</a></h4>
<div class="paragraph">
<p><strong>Problem:</strong> Package installation fails due to dependency conflicts.</p>
</div>
<div class="paragraph">
<p><strong>Symptoms:</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-text hljs" data-lang="text">ERROR: pip's dependency resolver does not currently consider pre-releases
ResolutionImpossible: for help visit https://pip.pypa.io/en/stable/...</code></pre>
</div>
</div>
<div class="paragraph">
<p><strong>Solutions:</strong></p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p><strong>Use clean virtual environment:</strong></p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">python -m venv clean-env
source clean-env/bin/activate
pip install --upgrade pip
pip install git+{link-repo}.git</code></pre>
</div>
</div>
</li>
<li>
<p><strong>Install with no dependencies first:</strong></p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">pip install --no-deps git+{link-repo}.git
pip install -r requirements.txt</code></pre>
</div>
</div>
</li>
<li>
<p><strong>Check for conflicting packages:</strong></p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">pip check
pip list --outdated</code></pre>
</div>
</div>
</li>
</ol>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_connection_issues"><a class="anchor" href="#_connection_issues"></a><a class="link" href="#_connection_issues">14.2. Connection Issues</a></h3>
<div class="sect3">
<h4 id="_mqtt_broker_connection_failures"><a class="anchor" href="#_mqtt_broker_connection_failures"></a><a class="link" href="#_mqtt_broker_connection_failures">14.2.1. MQTT Broker Connection Failures</a></h4>
<div class="paragraph">
<p><strong>Problem:</strong> Cannot connect to MQTT broker.</p>
</div>
<div class="paragraph">
<p><strong>Symptoms:</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-text hljs" data-lang="text">ConnectionError: [Errno 111] Connection refused
TimeoutError: Connection timeout</code></pre>
</div>
</div>
<div class="paragraph">
<p><strong>Solutions:</strong></p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p><strong>Verify broker connectivity:</strong></p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash"># Test network connectivity
ping mqtt-broker-host

# Test port connectivity
telnet mqtt-broker-host 1883
nc -zv mqtt-broker-host 1883</code></pre>
</div>
</div>
</li>
<li>
<p><strong>Check configuration:</strong></p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-python hljs" data-lang="python">config = EventListenerConfig(
    host="correct-host",
    port=1883,  # or 8883 for SSL
    username="valid-username",
    password="valid-password"
)</code></pre>
</div>
</div>
</li>
<li>
<p><strong>Enable debug logging:</strong></p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-python hljs" data-lang="python">import logging
logging.basicConfig(level=logging.DEBUG)
logging.getLogger('amqtt.client').setLevel(logging.DEBUG)</code></pre>
</div>
</div>
</li>
<li>
<p><strong>Test with MQTT client tools:</strong></p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash"># Install mosquitto-clients
sudo apt install mosquitto-clients

# Test connection
mosquitto_sub -h mqtt-host -p 1883 -t test/topic -u username -P password</code></pre>
</div>
</div>
</li>
</ol>
</div>
</div>
<div class="sect3">
<h4 id="_ssltls_connection_issues"><a class="anchor" href="#_ssltls_connection_issues"></a><a class="link" href="#_ssltls_connection_issues">14.2.2. SSL/TLS Connection Issues</a></h4>
<div class="paragraph">
<p><strong>Problem:</strong> SSL connection fails or certificate errors.</p>
</div>
<div class="paragraph">
<p><strong>Symptoms:</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-text hljs" data-lang="text">SSL: CERTIFICATE_VERIFY_FAILED
ssl.SSLError: [SSL: WRONG_VERSION_NUMBER]</code></pre>
</div>
</div>
<div class="paragraph">
<p><strong>Solutions:</strong></p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p><strong>Verify SSL configuration:</strong></p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-python hljs" data-lang="python">config = EventListenerConfig(
    host="ssl-broker",
    port=8883,  # SSL port
    cafile="/path/to/ca.crt",
    # or
    cadata="-----BEGIN CERTIFICATE-----..."
)</code></pre>
</div>
</div>
</li>
<li>
<p><strong>Check certificate validity:</strong></p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">openssl s_client -connect ssl-broker:8883 -servername ssl-broker
openssl x509 -in ca.crt -text -noout</code></pre>
</div>
</div>
</li>
<li>
<p><strong>Disable certificate verification (testing only):</strong></p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-python hljs" data-lang="python">import ssl
config = EventListenerConfig(
    host="ssl-broker",
    port=8883,
    tls_context=ssl.create_default_context()
)
config.tls_context.check_hostname = False
config.tls_context.verify_mode = ssl.CERT_NONE</code></pre>
</div>
</div>
</li>
</ol>
</div>
</div>
<div class="sect3">
<h4 id="_network_timeout_issues"><a class="anchor" href="#_network_timeout_issues"></a><a class="link" href="#_network_timeout_issues">14.2.3. Network Timeout Issues</a></h4>
<div class="paragraph">
<p><strong>Problem:</strong> Connection timeouts or intermittent disconnections.</p>
</div>
<div class="paragraph">
<p><strong>Solutions:</strong></p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p><strong>Adjust timeout settings:</strong></p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-python hljs" data-lang="python">config = EventListenerConfig(
    keep_alive=60,
    reconnect_retries=10,
    reconnect_max_interval=60,
    auto_reconnect=True
)</code></pre>
</div>
</div>
</li>
<li>
<p><strong>Check network stability:</strong></p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash"># Monitor network connectivity
ping -c 10 mqtt-broker-host

# Check for packet loss
mtr mqtt-broker-host</code></pre>
</div>
</div>
</li>
<li>
<p><strong>Use connection monitoring:</strong></p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-python hljs" data-lang="python">import asyncio

async def monitor_connection(listener):
    while True:
        if listener.client and listener.client.is_connected():
            print("✅ Connected")
        else:
            print("❌ Disconnected")
        await asyncio.sleep(30)</code></pre>
</div>
</div>
</li>
</ol>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_runtime_issues"><a class="anchor" href="#_runtime_issues"></a><a class="link" href="#_runtime_issues">14.3. Runtime Issues</a></h3>
<div class="sect3">
<h4 id="_memory_issues"><a class="anchor" href="#_memory_issues"></a><a class="link" href="#_memory_issues">14.3.1. Memory Issues</a></h4>
<div class="paragraph">
<p><strong>Problem:</strong> High memory usage or memory leaks.</p>
</div>
<div class="paragraph">
<p><strong>Symptoms:</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-text hljs" data-lang="text">MemoryError: Unable to allocate memory
Process killed (OOM killer)</code></pre>
</div>
</div>
<div class="paragraph">
<p><strong>Solutions:</strong></p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p><strong>Reduce job memory limit:</strong></p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-python hljs" data-lang="python">config = EventListenerConfig(
    max_jobs_in_memory=1000,  # Reduce from default 5000
    job_cleanup_interval=600  # More frequent cleanup
)</code></pre>
</div>
</div>
</li>
<li>
<p><strong>Monitor memory usage:</strong></p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-python hljs" data-lang="python">import psutil

def monitor_memory():
    process = psutil.Process()
    memory_mb = process.memory_info().rss / 1024 / 1024
    print(f"Memory usage: {memory_mb:.1f} MB")

# Call periodically
asyncio.create_task(periodic_memory_check())</code></pre>
</div>
</div>
</li>
<li>
<p><strong>Manual cleanup:</strong></p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-python hljs" data-lang="python"># Cleanup old jobs manually
await listener.cleanup_old_jobs()

# Force garbage collection
import gc
gc.collect()</code></pre>
</div>
</div>
</li>
</ol>
</div>
</div>
<div class="sect3">
<h4 id="_performance_issues"><a class="anchor" href="#_performance_issues"></a><a class="link" href="#_performance_issues">14.3.2. Performance Issues</a></h4>
<div class="paragraph">
<p><strong>Problem:</strong> Slow message processing or high latency.</p>
</div>
<div class="paragraph">
<p><strong>Solutions:</strong></p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p><strong>Profile message processing:</strong></p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-python hljs" data-lang="python">import time

def timed_processor(data, job_id):
    start_time = time.time()
    result = your_processing_logic(data, job_id)
    end_time = time.time()

    processing_time = end_time - start_time
    if processing_time &gt; 1.0:  # Log slow operations
        print(f"Slow processing for {job_id}: {processing_time:.2f}s")

    return result</code></pre>
</div>
</div>
</li>
<li>
<p><strong>Optimize configuration:</strong></p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-python hljs" data-lang="python">config = EventListenerConfig(
    qos=0,  # Faster delivery for non-critical messages
    duplicate_action="skip",  # Avoid reprocessing
    job_cleanup_interval=300  # More frequent cleanup
)</code></pre>
</div>
</div>
</li>
<li>
<p><strong>Use async operations:</strong></p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-python hljs" data-lang="python">async def async_processor(data, job_id):
    # Use async operations for I/O
    async with aiohttp.ClientSession() as session:
        result = await session.get(api_url)
    return create_return_type(result, "results", job_id)</code></pre>
</div>
</div>
</li>
</ol>
</div>
</div>
<div class="sect3">
<h4 id="_job_processing_errors"><a class="anchor" href="#_job_processing_errors"></a><a class="link" href="#_job_processing_errors">14.3.3. Job Processing Errors</a></h4>
<div class="paragraph">
<p><strong>Problem:</strong> Jobs fail or get stuck in processing.</p>
</div>
<div class="paragraph">
<p><strong>Solutions:</strong></p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p><strong>Add comprehensive error handling:</strong></p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-python hljs" data-lang="python">def robust_processor(data, job_id):
    try:
        return process_data(data, job_id)
    except ValueError as e:
        logger.error(f"Validation error for {job_id}: {e}")
        return create_error_response(job_id, "validation", str(e))
    except Exception as e:
        logger.exception(f"Unexpected error for {job_id}")
        return create_error_response(job_id, "processing", str(e))</code></pre>
</div>
</div>
</li>
<li>
<p><strong>Monitor job status:</strong></p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-python hljs" data-lang="python">async def monitor_jobs(listener):
    running_jobs = await listener.get_running_jobs()
    for job_id, job_info in running_jobs.items():
        age = datetime.now() - job_info.started_at
        if age.total_seconds() &gt; 300:  # 5 minutes
            print(f"⚠️ Long-running job: {job_id}")</code></pre>
</div>
</div>
</li>
<li>
<p><strong>Check job queue health:</strong></p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-python hljs" data-lang="python">all_jobs = await listener.get_all_jobs()
running = await listener.get_running_jobs()
completed = await listener.get_completed_jobs()
failed = len([j for j in all_jobs.values() if j.status == JobStatus.FAILED])

print(f"Jobs - Total: {len(all_jobs)}, Running: {len(running)}, "
      f"Completed: {len(completed)}, Failed: {failed}")</code></pre>
</div>
</div>
</li>
</ol>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_configuration_issues"><a class="anchor" href="#_configuration_issues"></a><a class="link" href="#_configuration_issues">14.4. Configuration Issues</a></h3>
<div class="sect3">
<h4 id="_invalid_configuration"><a class="anchor" href="#_invalid_configuration"></a><a class="link" href="#_invalid_configuration">14.4.1. Invalid Configuration</a></h4>
<div class="paragraph">
<p><strong>Problem:</strong> Configuration validation errors.</p>
</div>
<div class="paragraph">
<p><strong>Symptoms:</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-text hljs" data-lang="text">ValueError: Invalid port number: -1
ConfigError: Invalid QoS value: 5</code></pre>
</div>
</div>
<div class="paragraph">
<p><strong>Solutions:</strong></p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p><strong>Validate configuration values:</strong></p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-python hljs" data-lang="python"># Valid port range
config = EventListenerConfig(port=1883)  # 1-65535

# Valid QoS values
config = EventListenerConfig(qos=1)  # 0, 1, or 2

# Valid host format
config = EventListenerConfig(host="mqtt.example.com")</code></pre>
</div>
</div>
</li>
<li>
<p><strong>Check environment variables:</strong></p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-python hljs" data-lang="python">import os

def validate_env_config():
    required_vars = ["MQTT_HOST", "MQTT_USERNAME", "MQTT_PASSWORD"]
    missing = [var for var in required_vars if not os.getenv(var)]
    if missing:
        raise ValueError(f"Missing environment variables: {missing}")</code></pre>
</div>
</div>
</li>
</ol>
</div>
</div>
<div class="sect3">
<h4 id="_toml_parsing_errors"><a class="anchor" href="#_toml_parsing_errors"></a><a class="link" href="#_toml_parsing_errors">14.4.2. TOML Parsing Errors</a></h4>
<div class="paragraph">
<p><strong>Problem:</strong> Cannot parse TOML message content.</p>
</div>
<div class="paragraph">
<p><strong>Symptoms:</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-text hljs" data-lang="text">ConfigError: Invalid TOML syntax
TOMLDecodeError: Expected '=' after key</code></pre>
</div>
</div>
<div class="paragraph">
<p><strong>Solutions:</strong></p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p><strong>Validate TOML format:</strong></p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-python hljs" data-lang="python">import toml

def validate_toml_message(message_str):
    try:
        data = toml.loads(message_str)
        return data
    except toml.TomlDecodeError as e:
        print(f"TOML error: {e}")
        return None</code></pre>
</div>
</div>
</li>
<li>
<p><strong>Check message format:</strong></p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-toml hljs" data-lang="toml"># Correct TOML format
job_id = "task-001"
task_type = "processing"

[data]
input = "file.txt"
output = "result.txt"</code></pre>
</div>
</div>
</li>
<li>
<p><strong>Use SafeConfigParser:</strong></p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-python hljs" data-lang="python">from Listener import SafeConfigParser

parser = SafeConfigParser()
try:
    data = parser.parse_config_from_string(toml_string)
except ConfigError as e:
    print(f"Parse error: {e}")</code></pre>
</div>
</div>
</li>
</ol>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_debugging_tools"><a class="anchor" href="#_debugging_tools"></a><a class="link" href="#_debugging_tools">14.5. Debugging Tools</a></h3>
<div class="sect3">
<h4 id="_enable_debug_logging"><a class="anchor" href="#_enable_debug_logging"></a><a class="link" href="#_enable_debug_logging">14.5.1. Enable Debug Logging</a></h4>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-python hljs" data-lang="python">import logging

# Enable all debug logging
logging.basicConfig(
    level=logging.DEBUG,
    format='%(asctime)s - %(name)s - %(levelname)s - %(message)s'
)

# Specific logger levels
logging.getLogger('Listener').setLevel(logging.DEBUG)
logging.getLogger('amqtt.client').setLevel(logging.DEBUG)
logging.getLogger('amqtt.broker').setLevel(logging.INFO)</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_connection_testing"><a class="anchor" href="#_connection_testing"></a><a class="link" href="#_connection_testing">14.5.2. Connection Testing</a></h4>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-python hljs" data-lang="python">async def test_connection(config):
    """Test MQTT connection independently."""
    from amqtt.client import MQTTClient

    client = MQTTClient()
    try:
        await client.connect(config.uri)
        print("✅ Connection successful")
        await client.disconnect()
    except Exception as e:
        print(f"❌ Connection failed: {e}")</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_message_monitoring"><a class="anchor" href="#_message_monitoring"></a><a class="link" href="#_message_monitoring">14.5.3. Message Monitoring</a></h4>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-python hljs" data-lang="python">def debug_processor(data, job_id):
    """Processor with extensive debugging."""
    print(f"📨 Received job {job_id}")
    print(f"📋 Data: {data}")
    print(f"🔧 Processing...")

    try:
        result = your_processing_logic(data, job_id)
        print(f"✅ Job {job_id} completed")
        return result
    except Exception as e:
        print(f"❌ Job {job_id} failed: {e}")
        raise</code></pre>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_getting_help_3"><a class="anchor" href="#_getting_help_3"></a><a class="link" href="#_getting_help_3">14.6. Getting Help</a></h3>
<div class="sect3">
<h4 id="_before_seeking_help"><a class="anchor" href="#_before_seeking_help"></a><a class="link" href="#_before_seeking_help">14.6.1. Before Seeking Help</a></h4>
<div class="olist arabic">
<ol class="arabic">
<li>
<p><strong>Check logs</strong> for error messages and stack traces</p>
</li>
<li>
<p><strong>Verify configuration</strong> against documentation</p>
</li>
<li>
<p><strong>Test connectivity</strong> to MQTT broker</p>
</li>
<li>
<p><strong>Check system resources</strong> (memory, CPU, network)</p>
</li>
<li>
<p><strong>Review recent changes</strong> that might have caused issues</p>
</li>
</ol>
</div>
</div>
<div class="sect3">
<h4 id="_support_channels"><a class="anchor" href="#_support_channels"></a><a class="link" href="#_support_channels">14.6.2. Support Channels</a></h4>
<div class="olist arabic">
<ol class="arabic">
<li>
<p><strong>Repository Issues</strong>: Check <a href="https://github.com/ed-00/Mqtt-client/issues">GitHub issues</a> for known problems</p>
</li>
<li>
<p><strong>Internal Documentation</strong>: Review <a href="https://github.com/ed-00/Mqtt-client/blob/main/INTERNAL_DISTRIBUTION.md">Internal Distribution Guide</a></p>
</li>
<li>
<p><strong>Maintainer Contact</strong>: Email <a href="mailto:aahameed@kth.se">aahameed@kth.se</a> for direct support</p>
</li>
<li>
<p><strong>Team Resources</strong>: Contact your internal team or administrator</p>
</li>
</ol>
</div>
</div>
<div class="sect3">
<h4 id="_information_to_include"><a class="anchor" href="#_information_to_include"></a><a class="link" href="#_information_to_include">14.6.3. Information to Include</a></h4>
<div class="paragraph">
<p>When reporting issues, include:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>Version information</strong> (library version, Python version)</p>
</li>
<li>
<p><strong>Configuration</strong> (sanitized, remove credentials)</p>
</li>
<li>
<p><strong>Error messages</strong> (full stack trace)</p>
</li>
<li>
<p><strong>Environment details</strong> (OS, network setup)</p>
</li>
<li>
<p><strong>Steps to reproduce</strong> the issue</p>
</li>
<li>
<p><strong>Expected vs actual behavior</strong></p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash"># Gather system information
python --version
pip show mqtt-event-listener
uname -a
netstat -an | grep :1883</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="changelog"><a class="anchor" href="#changelog"></a><a class="link" href="#changelog">15. Changelog</a></h2>
<div class="sectionbody">
<div class="paragraph">
<p>Version history and changes for the MQTT Event Listener.</p>
</div>
<div class="sect2">
<h3 id="_version_1_0_0_2025_01_09"><a class="anchor" href="#_version_1_0_0_2025_01_09"></a><a class="link" href="#_version_1_0_0_2025_01_09">15.1. Version 1.0.0 (2025-01-09)</a></h3>
<div class="paragraph">
<p><strong>🎉 Initial Internal Release</strong></p>
</div>
<div class="sect3">
<h4 id="_features"><a class="anchor" href="#_features"></a><a class="link" href="#_features">15.1.1. Features</a></h4>
<div class="ulist">
<ul>
<li>
<p><strong>MQTT Event Listener</strong> - Asynchronous MQTT client with comprehensive job tracking</p>
</li>
<li>
<p><strong>TOML Message Processing</strong> - Automatic parsing and validation of TOML message content</p>
</li>
<li>
<p><strong>Job Management System</strong> - In-memory job tracking with status monitoring</p>
</li>
<li>
<p><strong>Configuration Management</strong> - Unified configuration system with validation</p>
</li>
<li>
<p><strong>Safe Configuration Parser</strong> - Robust TOML parsing with error handling</p>
</li>
<li>
<p><strong>Duplicate Detection</strong> - Configurable duplicate job handling</p>
</li>
<li>
<p><strong>Error Handling</strong> - Comprehensive error management and reporting</p>
</li>
<li>
<p><strong>Type Safety</strong> - Full type hints for better IDE support</p>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="_core_components"><a class="anchor" href="#_core_components"></a><a class="link" href="#_core_components">15.1.2. Core Components</a></h4>
<div class="ulist">
<ul>
<li>
<p><code>EventListener</code> - Main listener class with job tracking capabilities</p>
</li>
<li>
<p><code>EventListenerConfig</code> - Configuration dataclass with validation</p>
</li>
<li>
<p><code>SafeConfigParser</code> - TOML parser with safe error handling</p>
</li>
<li>
<p><code>JobInfo</code> - Job information tracking with status and metadata</p>
</li>
<li>
<p><code>ReturnType</code> - Structured return type for processed messages</p>
</li>
<li>
<p><code>JobStatus</code> - Enumeration for job execution states</p>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="_job_tracking_features"><a class="anchor" href="#_job_tracking_features"></a><a class="link" href="#_job_tracking_features">15.1.3. Job Tracking Features</a></h4>
<div class="ulist">
<ul>
<li>
<p><strong>In-memory job management</strong> with configurable limits</p>
</li>
<li>
<p><strong>Job status tracking</strong> (pending, running, completed, failed, duplicate)</p>
</li>
<li>
<p><strong>Automatic cleanup</strong> of old jobs based on configurable intervals</p>
</li>
<li>
<p><strong>Job querying</strong> by status and job ID</p>
</li>
<li>
<p><strong>Duplicate handling</strong> with configurable actions (skip, reprocess, error)</p>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="_mqtt_features"><a class="anchor" href="#_mqtt_features"></a><a class="link" href="#_mqtt_features">15.1.4. MQTT Features</a></h4>
<div class="ulist">
<ul>
<li>
<p><strong>Auto-reconnection</strong> with exponential backoff</p>
</li>
<li>
<p><strong>SSL/TLS support</strong> with certificate validation</p>
</li>
<li>
<p><strong>QoS levels</strong> 0, 1, and 2 support</p>
</li>
<li>
<p><strong>Topic wildcards</strong> support (<code>+</code> and <code>#</code>)</p>
</li>
<li>
<p><strong>Will messages</strong> for connection status monitoring</p>
</li>
<li>
<p><strong>Custom topic configurations</strong> with individual settings</p>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="_configuration_features"><a class="anchor" href="#_configuration_features"></a><a class="link" href="#_configuration_features">15.1.5. Configuration Features</a></h4>
<div class="ulist">
<ul>
<li>
<p><strong>Environment variable</strong> integration</p>
</li>
<li>
<p><strong>File-based configuration</strong> support</p>
</li>
<li>
<p><strong>Validation</strong> with meaningful error messages</p>
</li>
<li>
<p><strong>SSL/TLS configuration</strong> options</p>
</li>
<li>
<p><strong>Connection reliability</strong> settings</p>
</li>
<li>
<p><strong>Job management</strong> parameters</p>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="_development_features"><a class="anchor" href="#_development_features"></a><a class="link" href="#_development_features">15.1.6. Development Features</a></h4>
<div class="ulist">
<ul>
<li>
<p><strong>Comprehensive testing</strong> with 45+ unit tests and 12+ integration tests</p>
</li>
<li>
<p><strong>85% code coverage</strong> exceeding 80% target</p>
</li>
<li>
<p><strong>Type hints</strong> for all public APIs</p>
</li>
<li>
<p><strong>Documentation</strong> with usage examples</p>
</li>
<li>
<p><strong>Code quality</strong> tools (flake8, bandit, safety)</p>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="_distribution_features"><a class="anchor" href="#_distribution_features"></a><a class="link" href="#_distribution_features">15.1.7. Distribution Features</a></h4>
<div class="ulist">
<ul>
<li>
<p><strong>Modern Python packaging</strong> with <code>pyproject.toml</code></p>
</li>
<li>
<p><strong>Git-based installation</strong> for internal use</p>
</li>
<li>
<p><strong>Wheel distribution</strong> support</p>
</li>
<li>
<p><strong>Development dependencies</strong> for contributors</p>
</li>
<li>
<p><strong>Build automation</strong> with scripts</p>
</li>
<li>
<p><strong>Internal distribution</strong> guide</p>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="_documentation"><a class="anchor" href="#_documentation"></a><a class="link" href="#_documentation">15.1.8. Documentation</a></h4>
<div class="ulist">
<ul>
<li>
<p><strong>Comprehensive README</strong> with installation and usage</p>
</li>
<li>
<p><strong>API reference</strong> with complete method documentation</p>
</li>
<li>
<p><strong>Configuration guide</strong> with all options explained</p>
</li>
<li>
<p><strong>Usage examples</strong> for common scenarios</p>
</li>
<li>
<p><strong>Development guide</strong> for contributors</p>
</li>
<li>
<p><strong>Testing framework</strong> documentation</p>
</li>
<li>
<p><strong>Troubleshooting guide</strong> for common issues</p>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="_technical_details"><a class="anchor" href="#_technical_details"></a><a class="link" href="#_technical_details">15.1.9. Technical Details</a></h4>
<div class="ulist">
<ul>
<li>
<p><strong>Python 3.8+</strong> compatibility</p>
</li>
<li>
<p><strong>Asyncio-based</strong> for high performance</p>
</li>
<li>
<p><strong>Memory efficient</strong> with configurable job limits</p>
</li>
<li>
<p><strong>Thread-safe</strong> job management</p>
</li>
<li>
<p><strong>Graceful shutdown</strong> handling</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_upcoming_features"><a class="anchor" href="#_upcoming_features"></a><a class="link" href="#_upcoming_features">15.2. Upcoming Features</a></h3>
<div class="sect3">
<h4 id="_version_1_1_0_planned"><a class="anchor" href="#_version_1_1_0_planned"></a><a class="link" href="#_version_1_1_0_planned">15.2.1. Version 1.1.0 (Planned)</a></h4>
<div class="paragraph">
<p><strong>Planned features for the next release:</strong></p>
</div>
<div class="sect4">
<h5 id="_enhanced_job_management"><a class="anchor" href="#_enhanced_job_management"></a><a class="link" href="#_enhanced_job_management">Enhanced Job Management</a></h5>
<div class="ulist">
<ul>
<li>
<p><strong>Persistent job storage</strong> option for reliability</p>
</li>
<li>
<p><strong>Job priority queues</strong> for different processing priorities</p>
</li>
<li>
<p><strong>Job scheduling</strong> with delayed execution</p>
</li>
<li>
<p><strong>Batch processing</strong> capabilities for improved throughput</p>
</li>
<li>
<p><strong>Job retry mechanisms</strong> with exponential backoff</p>
</li>
</ul>
</div>
</div>
<div class="sect4">
<h5 id="_monitoring_and_observability_2"><a class="anchor" href="#_monitoring_and_observability_2"></a><a class="link" href="#_monitoring_and_observability_2">Monitoring and Observability</a></h5>
<div class="ulist">
<ul>
<li>
<p><strong>Metrics collection</strong> (Prometheus/StatsD support)</p>
</li>
<li>
<p><strong>Health check endpoints</strong> for monitoring</p>
</li>
<li>
<p><strong>Performance dashboards</strong> integration</p>
</li>
<li>
<p><strong>Distributed tracing</strong> support</p>
</li>
<li>
<p><strong>Custom alerting</strong> based on job failures</p>
</li>
</ul>
</div>
</div>
<div class="sect4">
<h5 id="_advanced_configuration_2"><a class="anchor" href="#_advanced_configuration_2"></a><a class="link" href="#_advanced_configuration_2">Advanced Configuration</a></h5>
<div class="ulist">
<ul>
<li>
<p><strong>Dynamic configuration</strong> reload without restart</p>
</li>
<li>
<p><strong>Configuration profiles</strong> for different environments</p>
</li>
<li>
<p><strong>Secret management</strong> integration</p>
</li>
<li>
<p><strong>Configuration validation</strong> schemas</p>
</li>
<li>
<p><strong>Hot-swappable processors</strong> for A/B testing</p>
</li>
</ul>
</div>
</div>
<div class="sect4">
<h5 id="_scalability_improvements"><a class="anchor" href="#_scalability_improvements"></a><a class="link" href="#_scalability_improvements">Scalability Improvements</a></h5>
<div class="ulist">
<ul>
<li>
<p><strong>Horizontal scaling</strong> support</p>
</li>
<li>
<p><strong>Load balancing</strong> across multiple instances</p>
</li>
<li>
<p><strong>Cluster coordination</strong> for distributed processing</p>
</li>
<li>
<p><strong>Message partitioning</strong> strategies</p>
</li>
<li>
<p><strong>Automatic scaling</strong> based on queue depth</p>
</li>
</ul>
</div>
</div>
<div class="sect4">
<h5 id="_developer_experience"><a class="anchor" href="#_developer_experience"></a><a class="link" href="#_developer_experience">Developer Experience</a></h5>
<div class="ulist">
<ul>
<li>
<p><strong>Plugin system</strong> for extensibility</p>
</li>
<li>
<p><strong>Custom serializers</strong> beyond TOML</p>
</li>
<li>
<p><strong>Message transformation</strong> pipelines</p>
</li>
<li>
<p><strong>Development mode</strong> with enhanced debugging</p>
</li>
<li>
<p><strong>Configuration wizard</strong> for easy setup</p>
</li>
</ul>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_version_history_guidelines"><a class="anchor" href="#_version_history_guidelines"></a><a class="link" href="#_version_history_guidelines">15.3. Version History Guidelines</a></h3>
<div class="sect3">
<h4 id="_semantic_versioning"><a class="anchor" href="#_semantic_versioning"></a><a class="link" href="#_semantic_versioning">15.3.1. Semantic Versioning</a></h4>
<div class="paragraph">
<p>The project follows semantic versioning (SemVer):</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>MAJOR</strong> version for incompatible API changes</p>
</li>
<li>
<p><strong>MINOR</strong> version for backwards-compatible functionality additions</p>
</li>
<li>
<p><strong>PATCH</strong> version for backwards-compatible bug fixes</p>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="_release_types"><a class="anchor" href="#_release_types"></a><a class="link" href="#_release_types">15.3.2. Release Types</a></h4>
<div class="sect4">
<h5 id="_major_releases_x_0_0"><a class="anchor" href="#_major_releases_x_0_0"></a><a class="link" href="#_major_releases_x_0_0">Major Releases (x.0.0)</a></h5>
<div class="ulist">
<ul>
<li>
<p>Breaking API changes</p>
</li>
<li>
<p>Major architecture updates</p>
</li>
<li>
<p>Significant new features</p>
</li>
<li>
<p>Migration guides provided</p>
</li>
</ul>
</div>
</div>
<div class="sect4">
<h5 id="_minor_releases_x_y_0"><a class="anchor" href="#_minor_releases_x_y_0"></a><a class="link" href="#_minor_releases_x_y_0">Minor Releases (x.y.0)</a></h5>
<div class="ulist">
<ul>
<li>
<p>New features and capabilities</p>
</li>
<li>
<p>Performance improvements</p>
</li>
<li>
<p>New configuration options</p>
</li>
<li>
<p>Backwards compatibility maintained</p>
</li>
</ul>
</div>
</div>
<div class="sect4">
<h5 id="_patch_releases_x_y_z"><a class="anchor" href="#_patch_releases_x_y_z"></a><a class="link" href="#_patch_releases_x_y_z">Patch Releases (x.y.z)</a></h5>
<div class="ulist">
<ul>
<li>
<p>Bug fixes</p>
</li>
<li>
<p>Security updates</p>
</li>
<li>
<p>Documentation improvements</p>
</li>
<li>
<p>Performance optimizations</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_change_categories"><a class="anchor" href="#_change_categories"></a><a class="link" href="#_change_categories">15.3.3. Change Categories</a></h4>
<div class="paragraph">
<p>Changes are categorized as:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>Features</strong> - New functionality and capabilities</p>
</li>
<li>
<p><strong>Improvements</strong> - Enhancements to existing features</p>
</li>
<li>
<p><strong>Bug Fixes</strong> - Resolution of reported issues</p>
</li>
<li>
<p><strong>Security</strong> - Security-related updates</p>
</li>
<li>
<p><strong>Documentation</strong> - Documentation updates and improvements</p>
</li>
<li>
<p><strong>Development</strong> - Changes affecting developers and contributors</p>
</li>
<li>
<p><strong>Infrastructure</strong> - Build, CI/CD, and deployment changes</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_migration_guidelines"><a class="anchor" href="#_migration_guidelines"></a><a class="link" href="#_migration_guidelines">15.4. Migration Guidelines</a></h3>
<div class="sect3">
<h4 id="_future_api_changes"><a class="anchor" href="#_future_api_changes"></a><a class="link" href="#_future_api_changes">15.4.1. Future API Changes</a></h4>
<div class="paragraph">
<p><strong>Guidelines for handling future breaking changes:</strong></p>
</div>
<div class="sect4">
<h5 id="_deprecation_policy"><a class="anchor" href="#_deprecation_policy"></a><a class="link" href="#_deprecation_policy">Deprecation Policy</a></h5>
<div class="olist arabic">
<ol class="arabic">
<li>
<p><strong>Advance notice</strong> - Deprecated features announced in minor releases</p>
</li>
<li>
<p><strong>Deprecation period</strong> - Minimum 2 minor versions before removal</p>
</li>
<li>
<p><strong>Migration guides</strong> - Detailed guides for breaking changes</p>
</li>
<li>
<p><strong>Backwards compatibility</strong> - Maintained during deprecation period</p>
</li>
</ol>
</div>
</div>
<div class="sect4">
<h5 id="_migration_support"><a class="anchor" href="#_migration_support"></a><a class="link" href="#_migration_support">Migration Support</a></h5>
<div class="olist arabic">
<ol class="arabic">
<li>
<p><strong>Automated migration tools</strong> when possible</p>
</li>
<li>
<p><strong>Step-by-step guides</strong> for manual migration</p>
</li>
<li>
<p><strong>Example code</strong> showing old vs new approaches</p>
</li>
<li>
<p><strong>Testing strategies</strong> for validation</p>
</li>
<li>
<p><strong>Support channels</strong> for migration assistance</p>
</li>
</ol>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_contributing_to_changelog"><a class="anchor" href="#_contributing_to_changelog"></a><a class="link" href="#_contributing_to_changelog">15.5. Contributing to Changelog</a></h3>
<div class="sect3">
<h4 id="_for_maintainers"><a class="anchor" href="#_for_maintainers"></a><a class="link" href="#_for_maintainers">15.5.1. For Maintainers</a></h4>
<div class="paragraph">
<p>When releasing new versions:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p><strong>Update version numbers</strong> in all relevant files</p>
</li>
<li>
<p><strong>Document all changes</strong> in this changelog</p>
</li>
<li>
<p><strong>Create git tags</strong> for releases</p>
</li>
<li>
<p><strong>Update internal distribution</strong> documentation</p>
</li>
<li>
<p><strong>Notify team</strong> of new releases</p>
</li>
</ol>
</div>
</div>
<div class="sect3">
<h4 id="_change_documentation_format"><a class="anchor" href="#_change_documentation_format"></a><a class="link" href="#_change_documentation_format">15.5.2. Change Documentation Format</a></h4>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-markdown hljs" data-lang="markdown">=== Version X.Y.Z (YYYY-MM-DD)

*Brief description*

==== Features
* New feature description
* Another new feature

==== Improvements
* Enhancement description
* Performance improvement

==== Bug Fixes
* Bug fix description
* Security fix description

==== Breaking Changes
* Breaking change with migration guide</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_internal_release_notes"><a class="anchor" href="#_internal_release_notes"></a><a class="link" href="#_internal_release_notes">15.5.3. Internal Release Notes</a></h4>
<div class="paragraph">
<p>For each release, maintain internal notes including:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>Performance benchmarks</strong> and comparisons</p>
</li>
<li>
<p><strong>Known issues</strong> and workarounds</p>
</li>
<li>
<p><strong>Deployment considerations</strong> for internal systems</p>
</li>
<li>
<p><strong>Testing coverage</strong> reports</p>
</li>
<li>
<p><strong>Security assessment</strong> results</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_support_information"><a class="anchor" href="#_support_information"></a><a class="link" href="#_support_information">15.6. Support Information</a></h3>
<div class="sect3">
<h4 id="_version_support"><a class="anchor" href="#_version_support"></a><a class="link" href="#_version_support">15.6.1. Version Support</a></h4>
<div class="ulist">
<ul>
<li>
<p><strong>Current version</strong> (1.0.0) - Full support</p>
</li>
<li>
<p><strong>Previous minor</strong> (when available) - Security fixes only</p>
</li>
<li>
<p><strong>Older versions</strong> - Community support through issues</p>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="_end_of_life_policy"><a class="anchor" href="#_end_of_life_policy"></a><a class="link" href="#_end_of_life_policy">15.6.2. End of Life Policy</a></h4>
<div class="ulist">
<ul>
<li>
<p><strong>Major versions</strong> - Supported for 2 years after release</p>
</li>
<li>
<p><strong>Minor versions</strong> - Supported until next major release</p>
</li>
<li>
<p><strong>Security fixes</strong> - Backported to supported versions only</p>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="_upgrade_recommendations"><a class="anchor" href="#_upgrade_recommendations"></a><a class="link" href="#_upgrade_recommendations">15.6.3. Upgrade Recommendations</a></h4>
<div class="ulist">
<ul>
<li>
<p><strong>Stay current</strong> with latest minor version for new features</p>
</li>
<li>
<p><strong>Plan upgrades</strong> around major releases for breaking changes</p>
</li>
<li>
<p><strong>Test thoroughly</strong> before upgrading production systems</p>
</li>
<li>
<p><strong>Review changelogs</strong> before upgrading</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>For questions about specific versions or upgrade paths, contact <a href="mailto:aahameed@kth.se">aahameed@kth.se</a>.</p>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_additional_resources"><a class="anchor" href="#_additional_resources"></a><a class="link" href="#_additional_resources">16. Additional Resources</a></h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_internal_resources"><a class="anchor" href="#_internal_resources"></a><a class="link" href="#_internal_resources">16.1. Internal Resources</a></h3>
<div class="ulist">
<ul>
<li>
<p><a href="https://github.com/ed-00/Mqtt-client/blob/main/INTERNAL_DISTRIBUTION.md">Internal Distribution Guide</a></p>
</li>
<li>
<p><a href="https://github.com/ed-00/Mqtt-client">Project Repository</a></p>
</li>
<li>
<p><a href="https://github.com/ed-00/Mqtt-client/issues">Issue Tracker</a></p>
</li>
<li>
<p><a href="https://github.com/ed-00/Mqtt-client/blob/main/LICENSE">License</a></p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_external_resources"><a class="anchor" href="#_external_resources"></a><a class="link" href="#_external_resources">16.2. External Resources</a></h3>
<div class="ulist">
<ul>
<li>
<p><a href="https://mqtt.org/">MQTT Protocol</a></p>
</li>
<li>
<p><a href="https://toml.io/">TOML Format</a></p>
</li>
<li>
<p><a href="https://docs.python.org/3/library/asyncio.html">Python asyncio</a></p>
</li>
<li>
<p><a href="https://docs.pytest.org/">pytest Testing Framework</a></p>
</li>
</ul>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_support_and_contact"><a class="anchor" href="#_support_and_contact"></a><a class="link" href="#_support_and_contact">17. Support and Contact</a></h2>
<div class="sectionbody">
<div class="paragraph">
<p>For questions, issues, or contributions:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>Email</strong>: <a href="mailto:aahameed@kth.se">aahameed@kth.se</a></p>
</li>
<li>
<p><strong>Issues</strong>: <a href="https://github.com/ed-00/Mqtt-client/issues" class="bare">https://github.com/ed-00/Mqtt-client/issues</a></p>
</li>
<li>
<p><strong>Internal Team</strong>: Contact your administrator</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_license"><a class="anchor" href="#_license"></a><a class="link" href="#_license">18. License</a></h2>
<div class="sectionbody">
<div class="paragraph">
<p>This project is licensed under the Apache 2.0 License - see the <a href="https://github.com/ed-00/Mqtt-client/blob/main/LICENSE">LICENSE</a> file for details.</p>
</div>
<hr>
<div class="paragraph">
<p><em>Generated on 2025-06-30 for version 1.0.0</em></p>
</div>
</div>
</div>
</div>
<div id="footer">
<div id="footer-text">
Version 1.0.0<br>
Last updated 2025-06-30 20:50:50 UTC
</div>
</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.18.3/highlight.min.js"></script>
<script>
if (!hljs.initHighlighting.called) {
  hljs.initHighlighting.called = true
  ;[].slice.call(document.querySelectorAll('pre.highlight > code[data-lang]')).forEach(function (el) { hljs.highlightBlock(el) })
}
</script>
<script type="text/x-mathjax-config">
MathJax.Hub.Config({
  messageStyle: "none",
  tex2jax: {
    inlineMath: [["\\(", "\\)"]],
    displayMath: [["\\[", "\\]"]],
    ignoreClass: "nostem|nolatexmath"
  },
  asciimath2jax: {
    delimiters: [["\\$", "\\$"]],
    ignoreClass: "nostem|noasciimath"
  },
  TeX: { equationNumbers: { autoNumber: "none" } }
})
MathJax.Hub.Register.StartupHook("AsciiMath Jax Ready", function () {
  MathJax.InputJax.AsciiMath.postfilterHooks.Add(function (data, node) {
    if ((node = data.script.parentNode) && (node = node.parentNode) && node.classList.contains("stemblock")) {
      data.math.root.display = "block"
    }
    return data
  })
})
</script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/MathJax.js?config=TeX-MML-AM_HTMLorMML"></script>
</body>
</html>